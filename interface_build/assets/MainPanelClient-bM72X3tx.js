import{j as t,B as I,b as H,A as G,r as N,C as M,M as T,F as ut,c as mt,d as ft,P as L,T as P,e as pt,f as ht,u as ue,g as xt,h as C,i as ze,t as gt,k as _t,l as $e,m as Nt,n as Re,o as jt,p as yt,q as wt,s as bt,v as me,w as Ct,x as vt,y as Et,z as ae,D as St,R as g,E as At,G as Z,H as Be,J as fe,K as Tt,L as It,N as Mt,O as kt,Q as Dt,S as Pt,U as Rt,V as Bt,W as Lt,X as Ft,Y as Ot,Z as Ut,$ as zt,a0 as $t,a1 as qt,a2 as Vt,a3 as qe,a4 as Ht,a5 as Gt,a6 as Jt,a7 as Kt,a8 as Qt,a9 as Yt,aa as Wt,ab as Zt,ac as Xt,ad as ea,ae as ta,af as aa,ag as sa,ah as na,ai as oa,aj as ra,ak as ia,al as la,am as ca,an as da,ao as ua,ap as ve,aq as Ve,ar as ma,as as ee,at as fa,au as pa,av as ha,aw as xa}from"./index-XdC7AIKK.js";import{m as ga}from"./messagesEventManager-nP9Q9w4t.js";const _a=[{short:"Jan",complete:"Janeiro"},{short:"Fev",complete:"Fevereiro"},{short:"Mar",complete:"Março"},{short:"Abr",complete:"Abril"},{short:"Mai",complete:"Maio"},{short:"Jun",complete:"Junho"},{short:"Jul",complete:"Julho"},{short:"Ago",complete:"Agosto"},{short:"Set",complete:"Setembro"},{short:"Out",complete:"Outubro"},{short:"Nov",complete:"Novembro"},{short:"Dez",complete:"Dezembro"}];function J(e){const a=new Date(e);a.toLocaleTimeString("pt-BR",{hour12:!1});const s=a.getTimezoneOffset(),n=a.getMonth(),o=a.getUTCHours()-s/60,r=a.toLocaleDateString(),i=`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`,c=`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`,l=`${a.getDay()} de ${_a[n].short} - ${c}`;return{currentHour:o,fullDate:r,fullHour:i,shortHour:c,dateFormat_A:l,fullDateWithHour:`${r} - ${i}`}}function Na({notification:e}){return t.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 min-w-[500px]",children:[t.jsx("h2",{className:"w-full text-2xl text-center font-bold",children:e.notification.title}),t.jsx("p",{dangerouslySetInnerHTML:{__html:e.notification.describe}}),t.jsx("div",{className:"flex p-4",children:!!Object.keys(e.notification.call_to_action).length&&t.jsx(I,{onClick:()=>window.open(e.notification.call_to_action.link),children:e.notification.call_to_action.text})})]})}async function ja(e){return await H.post(`${G}/notification/${e}/read`).catch(s=>console.log(s))}function ya(){const{client:e}=N.useContext(M),{setModalContent:a}=N.useContext(T),[s,n]=N.useState(),[o,r]=N.useState(),i=o==null?void 0:o.filter(l=>!l.read);N.useEffect(()=>{var d;const l=(d=e==null?void 0:e.notification_client)==null?void 0:d.sort((u,p)=>!u.read&&p.read?-1:u.read&&!p.read?1:0);r(l)},[]);const c=async l=>{const d=await ja(l.id);(d==null?void 0:d.status)===200&&(r(u=>{if(u){const p=u.filter(f=>f.id!==l.id),m=u.find(f=>f.id===l.id);if(m)return m.read=!0,p.push(m),p}}),a({componentName:"modal_display_notification",components:t.jsx(L,{children:t.jsx(Na,{notification:l})})}))};return t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"bg-primary-100 rounded-full p-1",onClick:()=>n(l=>!l),children:[t.jsx("span",{"data-isnotification":!!(i!=null&&i.length),className:"w-[20px] h-[20px] data-[isnotification=false]:hidden flex justify-center items-center text-xs bg-red-800 border border-primary-300 rounded-full absolute -top-[10px] -right-[10px]",children:i==null?void 0:i.length}),t.jsx(ut,{className:"text-2xl fill-light cursor-pointer"})]}),t.jsxs("div",{"data-display":!!s,className:"data-[display=false]:hidden flex flex-col absolute z-50 rounded-md bg-primary-100 p-4 right-0 translate-x-[122px] my-2 min-w-[400px]",children:[t.jsxs("div",{className:"w-full flex justify-between items-center border-b border-white/30",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Notificações"}),t.jsx(I,{children:"Marcar todas como lida"})]}),t.jsx("div",{className:"w-full flex flex-col",children:o==null?void 0:o.map(l=>t.jsxs("div",{className:"flex gap-4 items-center min-h-[60px] border-b border-white/30 hover:bg-primary-200/50 transition-colors cursor-pointer",onClick:()=>c(l),children:[t.jsx("div",{className:"min-w-1/3",children:l.read?t.jsx(mt,{className:"text-2xl fill-zinc-300"}):t.jsx(ft,{className:"text-2xl fill-orange-400"})}),t.jsxs("div",{"data-isread":!!l.read,className:"flex flex-col data-[isread=true]:opacity-60",children:[t.jsx("h2",{className:"font-medium text-lg",children:l.notification.title}),t.jsxs("div",{className:"flex gap-2 items-end px-2",children:[t.jsx("p",{className:"w-2/3 line-clamp-1 opacity-90",children:l.notification.describe}),t.jsx("span",{className:"text-xs opacity-70",children:J(l.notification.created_at).dateFormat_A})]})]})]},l.id))})]})]})}function wa(){N.useEffect(()=>{const a=localStorage.theme==="dark";document.documentElement.classList.toggle("dark",a)},[]);const e=()=>{const a=localStorage.theme==="dark";document.documentElement.classList.toggle("dark",!a);const s=a?"light":"dark";localStorage.theme=s};return t.jsxs("div",{className:"flex gap-3 px-8",children:[t.jsx(P,{tip:"Notificações",position:"BOTTOM",children:t.jsx(ya,{})}),t.jsx(P,{tip:"Escolha entre thema light ou dark",position:"BOTTOM",children:t.jsxs("div",{className:"bg-primary-100 rounded-full p-1",onClick:e,children:[t.jsx(pt,{className:"text-2xl fill-light cursor-pointer hidden dark:block"}),t.jsx(ht,{className:"text-2xl fill-light cursor-pointer block dark:hidden"})]})})]})}function ba(){return t.jsx("header",{className:"w-full h-[8%] px-20 min-h-[70px] col-span-8 row-span-1 flex justify-end items-center",children:t.jsx(wa,{})})}function Ca({plan_management_id:e}){const{client:a}=N.useContext(M),{setModalContent:s,clearModal:n}=N.useContext(T),o=ue(),r=()=>{if(a!=null&&a.plan_management)if(a!=null&&a.plan_management.prompt.length){const i=Number(a.plan_management.plan.max_projects.default),c=a.plan_management.project.length;a.plan_management.status!=="DISABLED"?i>c?o(`/create-chat/${e}`):s({componentName:"modal_reached_max_plan",components:t.jsx(C,{message:"Você atingiu o número maximo de chats por plano.",componentName:"modal_reached_max_plan"})}):s({componentName:"modal_plan_is_desabled",components:t.jsx(C,{message:"O plano da sua conta está desabilitado.",componentName:"modal_plan_is_desabled",functionAfterComplete:()=>o("/panel?tab=4")})})}else s({componentName:"modal_create_database",components:t.jsx(L,{children:t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[t.jsxs("h2",{className:"text-xl text-center",children:["Para criar um novo chat, antes é necessário ",t.jsx("br",{}),"  criar uma fonte de dados."]}),t.jsxs("h2",{className:"text-lg text-center opacity-80",children:["Nossa inteligência artifical vai analisar seus dados e ",t.jsx("br",{})," responder as dúvidas do usuário ",t.jsx("br",{}),"conforme as informações passadas na fonte de dados."]}),t.jsxs(I,{customClass:"my-4",onClick:()=>{o("/panel?tab=2"),n("modal_create_database")},children:[t.jsx(ze,{}),"Criar fonte de dados"]})]})})});else s({componentName:"modal_without_plan",components:t.jsx(C,{message:"Nenhum plano foi vinculado a sua conta",componentName:"modal_without_plan",functionAfterComplete:()=>o("/panel?tab=4")})})};return t.jsx(P,{tip:"Crie um novo chat",children:t.jsx("div",{onClick:r,className:"border border-primary-100 rounded-full cursor-pointer",children:t.jsx(xt,{className:"text-4xl text-primary-100"})})})}function X({children:e,title:a,className:s}){return t.jsxs("div",{className:gt("w-full min-h-[70vh] flex flex-col gap-4 justify-start items-start bg-light dark:bg-dark rounded-xl border border-primary-100 dark:border-primary-300 relative hidden-scrollbar",s),children:[t.jsx("h2",{className:"w-full text-primary-100 dark:text-light text-2xl font-semibold uppercase p-4 px-8",children:a}),e]})}function se({children:e,title:a,text:s,position:n="BOTTOM",hidden:o}){const r=N.useRef(null),{client:i,setClient:c}=N.useContext(M),l=async()=>{if(i){const d=await $e(i.id,!1);c(d)}};return i&&t.jsxs("div",{className:"flex items-center relative group",children:[t.jsx("div",{"data-active":i.tutorial,"data-hidden":o,className:"data-[hidden=true]:hidden data-[active=false]:hidden w-screen h-screen backdrop-blur-sm fixed top-0 left-0 z-50"}),t.jsxs("div",{"data-active":i.tutorial,ref:r,"data-position":n,"data-hidden":o,className:`border border-light/40 bg-primary-100 p-1 rounded-xl absolute z-50 left-1/2 -translate-x-1/2 
                    data-[position=TOP]:-top-full data-[position=TOP]:-translate-y-full data-[position=BOTTOM]:-bottom-full data-[position=BOTTOM]:translate-y-full
                    text-center transition-opacity  data-[hidden=true]:hidden data-[active=false]:hidden`,children:[t.jsxs("div",{className:" bg-primary-100 rounded-md flex flex-col justify-center items-center px-4",children:[t.jsx("h2",{className:"text-center py-2 font-bold text-xl text-light",children:a}),t.jsx("p",{className:"w-[400px] px-4 text-center text-light text-lg",dangerouslySetInnerHTML:{__html:s}}),t.jsx("div",{className:"w-full flex justify-center mt-8 text-light text-base",children:t.jsx("span",{className:"underline opacity-70 cursor-pointer",onClick:l,children:"Pular tutorial"})})]}),t.jsx(_t,{"data-position":n,className:"border-light/40 fill-primary-100 absolute left-1/2 -translate-x-1/2 data-[position='BOTTOM']:top-0 data-[position='BOTTOM']:-translate-y-[78%] data-[position='BOTTOM']:rotate-180"})]}),t.jsx("div",{"data-hidden":o,className:"z-50 data-[hidden=true]:z-0",children:e})]})}var oe={},va=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},He={},R={};let Ie;const Ea=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];R.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17};R.getSymbolTotalCodewords=function(a){return Ea[a]};R.getBCHDigit=function(e){let a=0;for(;e!==0;)a++,e>>>=1;return a};R.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');Ie=a};R.isKanjiModeEnabled=function(){return typeof Ie<"u"};R.toSJIS=function(a){return Ie(a)};var pe={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function a(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,o){if(e.isValid(n))return n;try{return a(n)}catch{return o}}})(pe);function Ge(){this.buffer=[],this.length=0}Ge.prototype={get:function(e){const a=Math.floor(e/8);return(this.buffer[a]>>>7-e%8&1)===1},put:function(e,a){for(let s=0;s<a;s++)this.putBit((e>>>a-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),e&&(this.buffer[a]|=128>>>this.length%8),this.length++}};var Sa=Ge;function re(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}re.prototype.set=function(e,a,s,n){const o=e*this.size+a;this.data[o]=s,n&&(this.reservedBit[o]=!0)};re.prototype.get=function(e,a){return this.data[e*this.size+a]};re.prototype.xor=function(e,a,s){this.data[e*this.size+a]^=s};re.prototype.isReserved=function(e,a){return this.reservedBit[e*this.size+a]};var Aa=re,Je={};(function(e){const a=R.getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,r=a(n),i=r===145?26:Math.ceil((r-13)/(2*o-2))*2,c=[r-7];for(let l=1;l<o-1;l++)c[l]=c[l-1]-i;return c.push(6),c.reverse()},e.getPositions=function(n){const o=[],r=e.getRowColCoords(n),i=r.length;for(let c=0;c<i;c++)for(let l=0;l<i;l++)c===0&&l===0||c===0&&l===i-1||c===i-1&&l===0||o.push([r[c],r[l]]);return o}})(Je);var Ke={};const Ta=R.getSymbolSize,Le=7;Ke.getPositions=function(a){const s=Ta(a);return[[0,0],[s-Le,0],[0,s-Le]]};var Qe={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};e.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},e.from=function(o){return e.isValid(o)?parseInt(o,10):void 0},e.getPenaltyN1=function(o){const r=o.size;let i=0,c=0,l=0,d=null,u=null;for(let p=0;p<r;p++){c=l=0,d=u=null;for(let m=0;m<r;m++){let f=o.get(p,m);f===d?c++:(c>=5&&(i+=a.N1+(c-5)),d=f,c=1),f=o.get(m,p),f===u?l++:(l>=5&&(i+=a.N1+(l-5)),u=f,l=1)}c>=5&&(i+=a.N1+(c-5)),l>=5&&(i+=a.N1+(l-5))}return i},e.getPenaltyN2=function(o){const r=o.size;let i=0;for(let c=0;c<r-1;c++)for(let l=0;l<r-1;l++){const d=o.get(c,l)+o.get(c,l+1)+o.get(c+1,l)+o.get(c+1,l+1);(d===4||d===0)&&i++}return i*a.N2},e.getPenaltyN3=function(o){const r=o.size;let i=0,c=0,l=0;for(let d=0;d<r;d++){c=l=0;for(let u=0;u<r;u++)c=c<<1&2047|o.get(d,u),u>=10&&(c===1488||c===93)&&i++,l=l<<1&2047|o.get(u,d),u>=10&&(l===1488||l===93)&&i++}return i*a.N3},e.getPenaltyN4=function(o){let r=0;const i=o.data.length;for(let l=0;l<i;l++)r+=o.data[l];return Math.abs(Math.ceil(r*100/i/5)-10)*a.N4};function s(n,o,r){switch(n){case e.Patterns.PATTERN000:return(o+r)%2===0;case e.Patterns.PATTERN001:return o%2===0;case e.Patterns.PATTERN010:return r%3===0;case e.Patterns.PATTERN011:return(o+r)%3===0;case e.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(r/3))%2===0;case e.Patterns.PATTERN101:return o*r%2+o*r%3===0;case e.Patterns.PATTERN110:return(o*r%2+o*r%3)%2===0;case e.Patterns.PATTERN111:return(o*r%3+(o+r)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(o,r){const i=r.size;for(let c=0;c<i;c++)for(let l=0;l<i;l++)r.isReserved(l,c)||r.xor(l,c,s(o,l,c))},e.getBestMask=function(o,r){const i=Object.keys(e.Patterns).length;let c=0,l=1/0;for(let d=0;d<i;d++){r(d),e.applyMask(d,o);const u=e.getPenaltyN1(o)+e.getPenaltyN2(o)+e.getPenaltyN3(o)+e.getPenaltyN4(o);e.applyMask(d,o),u<l&&(l=u,c=d)}return c}})(Qe);var he={};const $=pe,ie=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],le=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];he.getBlocksCount=function(a,s){switch(s){case $.L:return ie[(a-1)*4+0];case $.M:return ie[(a-1)*4+1];case $.Q:return ie[(a-1)*4+2];case $.H:return ie[(a-1)*4+3];default:return}};he.getTotalCodewordsCount=function(a,s){switch(s){case $.L:return le[(a-1)*4+0];case $.M:return le[(a-1)*4+1];case $.Q:return le[(a-1)*4+2];case $.H:return le[(a-1)*4+3];default:return}};var Ye={},xe={};const te=new Uint8Array(512),ce=new Uint8Array(256);(function(){let a=1;for(let s=0;s<255;s++)te[s]=a,ce[a]=s,a<<=1,a&256&&(a^=285);for(let s=255;s<512;s++)te[s]=te[s-255]})();xe.log=function(a){if(a<1)throw new Error("log("+a+")");return ce[a]};xe.exp=function(a){return te[a]};xe.mul=function(a,s){return a===0||s===0?0:te[ce[a]+ce[s]]};(function(e){const a=xe;e.mul=function(n,o){const r=new Uint8Array(n.length+o.length-1);for(let i=0;i<n.length;i++)for(let c=0;c<o.length;c++)r[i+c]^=a.mul(n[i],o[c]);return r},e.mod=function(n,o){let r=new Uint8Array(n);for(;r.length-o.length>=0;){const i=r[0];for(let l=0;l<o.length;l++)r[l]^=a.mul(o[l],i);let c=0;for(;c<r.length&&r[c]===0;)c++;r=r.slice(c)}return r},e.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let r=0;r<n;r++)o=e.mul(o,new Uint8Array([1,a.exp(r)]));return o}})(Ye);const We=Ye;function Me(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Me.prototype.initialize=function(a){this.degree=a,this.genPoly=We.generateECPolynomial(this.degree)};Me.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(a.length+this.degree);s.set(a);const n=We.mod(s,this.genPoly),o=this.degree-n.length;if(o>0){const r=new Uint8Array(this.degree);return r.set(n,o),r}return n};var Ia=Me,Ze={},q={},ke={};ke.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40};var F={};const Xe="[0-9]+",Ma="[A-Z $%*+\\-./:]+";let ne="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ne=ne.replace(/u/g,"\\u");const ka="(?:(?![A-Z0-9 $%*+\\-./:]|"+ne+`)(?:.|[\r
]))+`;F.KANJI=new RegExp(ne,"g");F.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");F.BYTE=new RegExp(ka,"g");F.NUMERIC=new RegExp(Xe,"g");F.ALPHANUMERIC=new RegExp(Ma,"g");const Da=new RegExp("^"+ne+"$"),Pa=new RegExp("^"+Xe+"$"),Ra=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");F.testKanji=function(a){return Da.test(a)};F.testNumeric=function(a){return Pa.test(a)};F.testAlphanumeric=function(a){return Ra.test(a)};(function(e){const a=ke,s=F;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(r,i){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!a.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?r.ccBits[0]:i<27?r.ccBits[1]:r.ccBits[2]},e.getBestModeForData=function(r){return s.testNumeric(r)?e.NUMERIC:s.testAlphanumeric(r)?e.ALPHANUMERIC:s.testKanji(r)?e.KANJI:e.BYTE},e.toString=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")},e.isValid=function(r){return r&&r.bit&&r.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+o)}}e.from=function(r,i){if(e.isValid(r))return r;try{return n(r)}catch{return i}}})(q);(function(e){const a=R,s=he,n=pe,o=q,r=ke,i=7973,c=a.getBCHDigit(i);function l(m,f,x){for(let _=1;_<=40;_++)if(f<=e.getCapacity(_,x,m))return _}function d(m,f){return o.getCharCountIndicator(m,f)+4}function u(m,f){let x=0;return m.forEach(function(_){const v=d(_.mode,f);x+=v+_.getBitsLength()}),x}function p(m,f){for(let x=1;x<=40;x++)if(u(m,x)<=e.getCapacity(x,f,o.MIXED))return x}e.from=function(f,x){return r.isValid(f)?parseInt(f,10):x},e.getCapacity=function(f,x,_){if(!r.isValid(f))throw new Error("Invalid QR Code version");typeof _>"u"&&(_=o.BYTE);const v=a.getSymbolTotalCodewords(f),j=s.getTotalCodewordsCount(f,x),b=(v-j)*8;if(_===o.MIXED)return b;const y=b-d(_,f);switch(_){case o.NUMERIC:return Math.floor(y/10*3);case o.ALPHANUMERIC:return Math.floor(y/11*2);case o.KANJI:return Math.floor(y/13);case o.BYTE:default:return Math.floor(y/8)}},e.getBestVersionForData=function(f,x){let _;const v=n.from(x,n.M);if(Array.isArray(f)){if(f.length>1)return p(f,v);if(f.length===0)return 1;_=f[0]}else _=f;return l(_.mode,_.getLength(),v)},e.getEncodedBits=function(f){if(!r.isValid(f)||f<7)throw new Error("Invalid QR Code version");let x=f<<12;for(;a.getBCHDigit(x)-c>=0;)x^=i<<a.getBCHDigit(x)-c;return f<<12|x}})(Ze);var et={};const Ee=R,tt=1335,Ba=21522,Fe=Ee.getBCHDigit(tt);et.getEncodedBits=function(a,s){const n=a.bit<<3|s;let o=n<<10;for(;Ee.getBCHDigit(o)-Fe>=0;)o^=tt<<Ee.getBCHDigit(o)-Fe;return(n<<10|o)^Ba};var at={};const La=q;function K(e){this.mode=La.NUMERIC,this.data=e.toString()}K.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)};K.prototype.getLength=function(){return this.data.length};K.prototype.getBitsLength=function(){return K.getBitsLength(this.data.length)};K.prototype.write=function(a){let s,n,o;for(s=0;s+3<=this.data.length;s+=3)n=this.data.substr(s,3),o=parseInt(n,10),a.put(o,10);const r=this.data.length-s;r>0&&(n=this.data.substr(s),o=parseInt(n,10),a.put(o,r*3+1))};var Fa=K;const Oa=q,_e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Q(e){this.mode=Oa.ALPHANUMERIC,this.data=e}Q.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)};Q.prototype.getLength=function(){return this.data.length};Q.prototype.getBitsLength=function(){return Q.getBitsLength(this.data.length)};Q.prototype.write=function(a){let s;for(s=0;s+2<=this.data.length;s+=2){let n=_e.indexOf(this.data[s])*45;n+=_e.indexOf(this.data[s+1]),a.put(n,11)}this.data.length%2&&a.put(_e.indexOf(this.data[s]),6)};var Ua=Q,za=function(a){for(var s=[],n=a.length,o=0;o<n;o++){var r=a.charCodeAt(o);if(r>=55296&&r<=56319&&n>o+1){var i=a.charCodeAt(o+1);i>=56320&&i<=57343&&(r=(r-55296)*1024+i-56320+65536,o+=1)}if(r<128){s.push(r);continue}if(r<2048){s.push(r>>6|192),s.push(r&63|128);continue}if(r<55296||r>=57344&&r<65536){s.push(r>>12|224),s.push(r>>6&63|128),s.push(r&63|128);continue}if(r>=65536&&r<=1114111){s.push(r>>18|240),s.push(r>>12&63|128),s.push(r>>6&63|128),s.push(r&63|128);continue}s.push(239,191,189)}return new Uint8Array(s).buffer};const $a=za,qa=q;function Y(e){this.mode=qa.BYTE,typeof e=="string"&&(e=$a(e)),this.data=new Uint8Array(e)}Y.getBitsLength=function(a){return a*8};Y.prototype.getLength=function(){return this.data.length};Y.prototype.getBitsLength=function(){return Y.getBitsLength(this.data.length)};Y.prototype.write=function(e){for(let a=0,s=this.data.length;a<s;a++)e.put(this.data[a],8)};var Va=Y;const Ha=q,Ga=R;function W(e){this.mode=Ha.KANJI,this.data=e}W.getBitsLength=function(a){return a*13};W.prototype.getLength=function(){return this.data.length};W.prototype.getBitsLength=function(){return W.getBitsLength(this.data.length)};W.prototype.write=function(e){let a;for(a=0;a<this.data.length;a++){let s=Ga.toSJIS(this.data[a]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),e.put(s,13)}};var Ja=W,st={exports:{}};(function(e){var a={single_source_shortest_paths:function(s,n,o){var r={},i={};i[n]=0;var c=a.PriorityQueue.make();c.push(n,0);for(var l,d,u,p,m,f,x,_,v;!c.empty();){l=c.pop(),d=l.value,p=l.cost,m=s[d]||{};for(u in m)m.hasOwnProperty(u)&&(f=m[u],x=p+f,_=i[u],v=typeof i[u]>"u",(v||_>x)&&(i[u]=x,c.push(u,x),r[u]=d))}if(typeof o<"u"&&typeof i[o]>"u"){var j=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(j)}return r},extract_shortest_path_from_predecessor_list:function(s,n){for(var o=[],r=n;r;)o.push(r),s[r],r=s[r];return o.reverse(),o},find_path:function(s,n,o){var r=a.single_source_shortest_paths(s,n,o);return a.extract_shortest_path_from_predecessor_list(r,o)},PriorityQueue:{make:function(s){var n=a.PriorityQueue,o={},r;s=s||{};for(r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);return o.queue=[],o.sorter=s.sorter||n.default_sorter,o},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var o={value:s,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=a})(st);var Ka=st.exports;(function(e){const a=q,s=Fa,n=Ua,o=Va,r=Ja,i=F,c=R,l=Ka;function d(j){return unescape(encodeURIComponent(j)).length}function u(j,b,y){const h=[];let w;for(;(w=j.exec(y))!==null;)h.push({data:w[0],index:w.index,mode:b,length:w[0].length});return h}function p(j){const b=u(i.NUMERIC,a.NUMERIC,j),y=u(i.ALPHANUMERIC,a.ALPHANUMERIC,j);let h,w;return c.isKanjiModeEnabled()?(h=u(i.BYTE,a.BYTE,j),w=u(i.KANJI,a.KANJI,j)):(h=u(i.BYTE_KANJI,a.BYTE,j),w=[]),b.concat(y,h,w).sort(function(S,A){return S.index-A.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function m(j,b){switch(b){case a.NUMERIC:return s.getBitsLength(j);case a.ALPHANUMERIC:return n.getBitsLength(j);case a.KANJI:return r.getBitsLength(j);case a.BYTE:return o.getBitsLength(j)}}function f(j){return j.reduce(function(b,y){const h=b.length-1>=0?b[b.length-1]:null;return h&&h.mode===y.mode?(b[b.length-1].data+=y.data,b):(b.push(y),b)},[])}function x(j){const b=[];for(let y=0;y<j.length;y++){const h=j[y];switch(h.mode){case a.NUMERIC:b.push([h,{data:h.data,mode:a.ALPHANUMERIC,length:h.length},{data:h.data,mode:a.BYTE,length:h.length}]);break;case a.ALPHANUMERIC:b.push([h,{data:h.data,mode:a.BYTE,length:h.length}]);break;case a.KANJI:b.push([h,{data:h.data,mode:a.BYTE,length:d(h.data)}]);break;case a.BYTE:b.push([{data:h.data,mode:a.BYTE,length:d(h.data)}])}}return b}function _(j,b){const y={},h={start:{}};let w=["start"];for(let E=0;E<j.length;E++){const S=j[E],A=[];for(let D=0;D<S.length;D++){const k=S[D],U=""+E+D;A.push(U),y[U]={node:k,lastCount:0},h[U]={};for(let V=0;V<w.length;V++){const O=w[V];y[O]&&y[O].node.mode===k.mode?(h[O][U]=m(y[O].lastCount+k.length,k.mode)-m(y[O].lastCount,k.mode),y[O].lastCount+=k.length):(y[O]&&(y[O].lastCount=k.length),h[O][U]=m(k.length,k.mode)+4+a.getCharCountIndicator(k.mode,b))}}w=A}for(let E=0;E<w.length;E++)h[w[E]].end=0;return{map:h,table:y}}function v(j,b){let y;const h=a.getBestModeForData(j);if(y=a.from(b,h),y!==a.BYTE&&y.bit<h.bit)throw new Error('"'+j+'" cannot be encoded with mode '+a.toString(y)+`.
 Suggested mode is: `+a.toString(h));switch(y===a.KANJI&&!c.isKanjiModeEnabled()&&(y=a.BYTE),y){case a.NUMERIC:return new s(j);case a.ALPHANUMERIC:return new n(j);case a.KANJI:return new r(j);case a.BYTE:return new o(j)}}e.fromArray=function(b){return b.reduce(function(y,h){return typeof h=="string"?y.push(v(h,null)):h.data&&y.push(v(h.data,h.mode)),y},[])},e.fromString=function(b,y){const h=p(b,c.isKanjiModeEnabled()),w=x(h),E=_(w,y),S=l.find_path(E.map,"start","end"),A=[];for(let D=1;D<S.length-1;D++)A.push(E.table[S[D]].node);return e.fromArray(f(A))},e.rawSplit=function(b){return e.fromArray(p(b,c.isKanjiModeEnabled()))}})(at);const ge=R,Ne=pe,Qa=Sa,Ya=Aa,Wa=Je,Za=Ke,Se=Qe,Ae=he,Xa=Ia,de=Ze,es=et,ts=q,je=at;function as(e,a){const s=e.size,n=Za.getPositions(a);for(let o=0;o<n.length;o++){const r=n[o][0],i=n[o][1];for(let c=-1;c<=7;c++)if(!(r+c<=-1||s<=r+c))for(let l=-1;l<=7;l++)i+l<=-1||s<=i+l||(c>=0&&c<=6&&(l===0||l===6)||l>=0&&l<=6&&(c===0||c===6)||c>=2&&c<=4&&l>=2&&l<=4?e.set(r+c,i+l,!0,!0):e.set(r+c,i+l,!1,!0))}}function ss(e){const a=e.size;for(let s=8;s<a-8;s++){const n=s%2===0;e.set(s,6,n,!0),e.set(6,s,n,!0)}}function ns(e,a){const s=Wa.getPositions(a);for(let n=0;n<s.length;n++){const o=s[n][0],r=s[n][1];for(let i=-2;i<=2;i++)for(let c=-2;c<=2;c++)i===-2||i===2||c===-2||c===2||i===0&&c===0?e.set(o+i,r+c,!0,!0):e.set(o+i,r+c,!1,!0)}}function os(e,a){const s=e.size,n=de.getEncodedBits(a);let o,r,i;for(let c=0;c<18;c++)o=Math.floor(c/3),r=c%3+s-8-3,i=(n>>c&1)===1,e.set(o,r,i,!0),e.set(r,o,i,!0)}function ye(e,a,s){const n=e.size,o=es.getEncodedBits(a,s);let r,i;for(r=0;r<15;r++)i=(o>>r&1)===1,r<6?e.set(r,8,i,!0):r<8?e.set(r+1,8,i,!0):e.set(n-15+r,8,i,!0),r<8?e.set(8,n-r-1,i,!0):r<9?e.set(8,15-r-1+1,i,!0):e.set(8,15-r-1,i,!0);e.set(n-8,8,1,!0)}function rs(e,a){const s=e.size;let n=-1,o=s-1,r=7,i=0;for(let c=s-1;c>0;c-=2)for(c===6&&c--;;){for(let l=0;l<2;l++)if(!e.isReserved(o,c-l)){let d=!1;i<a.length&&(d=(a[i]>>>r&1)===1),e.set(o,c-l,d),r--,r===-1&&(i++,r=7)}if(o+=n,o<0||s<=o){o-=n,n=-n;break}}}function is(e,a,s){const n=new Qa;s.forEach(function(l){n.put(l.mode.bit,4),n.put(l.getLength(),ts.getCharCountIndicator(l.mode,e)),l.write(n)});const o=ge.getSymbolTotalCodewords(e),r=Ae.getTotalCodewordsCount(e,a),i=(o-r)*8;for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const c=(i-n.getLengthInBits())/8;for(let l=0;l<c;l++)n.put(l%2?17:236,8);return ls(n,e,a)}function ls(e,a,s){const n=ge.getSymbolTotalCodewords(a),o=Ae.getTotalCodewordsCount(a,s),r=n-o,i=Ae.getBlocksCount(a,s),c=n%i,l=i-c,d=Math.floor(n/i),u=Math.floor(r/i),p=u+1,m=d-u,f=new Xa(m);let x=0;const _=new Array(i),v=new Array(i);let j=0;const b=new Uint8Array(e.buffer);for(let S=0;S<i;S++){const A=S<l?u:p;_[S]=b.slice(x,x+A),v[S]=f.encode(_[S]),x+=A,j=Math.max(j,A)}const y=new Uint8Array(n);let h=0,w,E;for(w=0;w<j;w++)for(E=0;E<i;E++)w<_[E].length&&(y[h++]=_[E][w]);for(w=0;w<m;w++)for(E=0;E<i;E++)y[h++]=v[E][w];return y}function cs(e,a,s,n){let o;if(Array.isArray(e))o=je.fromArray(e);else if(typeof e=="string"){let d=a;if(!d){const u=je.rawSplit(e);d=de.getBestVersionForData(u,s)}o=je.fromString(e,d||40)}else throw new Error("Invalid data");const r=de.getBestVersionForData(o,s);if(!r)throw new Error("The amount of data is too big to be stored in a QR Code");if(!a)a=r;else if(a<r)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+r+`.
`);const i=is(a,s,o),c=ge.getSymbolSize(a),l=new Ya(c);return as(l,a),ss(l),ns(l,a),ye(l,s,0),a>=7&&os(l,a),rs(l,i),isNaN(n)&&(n=Se.getBestMask(l,ye.bind(null,l,s))),Se.applyMask(n,l),ye(l,s,n),{modules:l,version:a,errorCorrectionLevel:s,maskPattern:n,segments:o}}He.create=function(a,s){if(typeof a>"u"||a==="")throw new Error("No input text");let n=Ne.M,o,r;return typeof s<"u"&&(n=Ne.from(s.errorCorrectionLevel,Ne.M),o=de.from(s.version),r=Se.from(s.maskPattern),s.toSJISFunc&&ge.setToSJISFunction(s.toSJISFunc)),cs(a,o,n,r)};var nt={},De={};(function(e){function a(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(r){return[r,r]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,r=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:r,scale:r?4:i,margin:o,color:{dark:a(n.color.dark||"#000000ff"),light:a(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},e.getImageWidth=function(n,o){const r=e.getScale(n,o);return Math.floor((n+o.margin*2)*r)},e.qrToImageData=function(n,o,r){const i=o.modules.size,c=o.modules.data,l=e.getScale(i,r),d=Math.floor((i+r.margin*2)*l),u=r.margin*l,p=[r.color.light,r.color.dark];for(let m=0;m<d;m++)for(let f=0;f<d;f++){let x=(m*d+f)*4,_=r.color.light;if(m>=u&&f>=u&&m<d-u&&f<d-u){const v=Math.floor((m-u)/l),j=Math.floor((f-u)/l);_=p[c[v*i+j]?1:0]}n[x++]=_.r,n[x++]=_.g,n[x++]=_.b,n[x]=_.a}}})(De);(function(e){const a=De;function s(o,r,i){o.clearRect(0,0,r.width,r.height),r.style||(r.style={}),r.height=i,r.width=i,r.style.height=i+"px",r.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(r,i,c){let l=c,d=i;typeof l>"u"&&(!i||!i.getContext)&&(l=i,i=void 0),i||(d=n()),l=a.getOptions(l);const u=a.getImageWidth(r.modules.size,l),p=d.getContext("2d"),m=p.createImageData(u,u);return a.qrToImageData(m.data,r,l),s(p,d,u),p.putImageData(m,0,0),d},e.renderToDataURL=function(r,i,c){let l=c;typeof l>"u"&&(!i||!i.getContext)&&(l=i,i=void 0),l||(l={});const d=e.render(r,i,l),u=l.type||"image/png",p=l.rendererOpts||{};return d.toDataURL(u,p.quality)}})(nt);var ot={};const ds=De;function Oe(e,a){const s=e.a/255,n=a+'="'+e.hex+'"';return s<1?n+" "+a+'-opacity="'+s.toFixed(2).slice(1)+'"':n}function we(e,a,s){let n=e+a;return typeof s<"u"&&(n+=" "+s),n}function us(e,a,s){let n="",o=0,r=!1,i=0;for(let c=0;c<e.length;c++){const l=Math.floor(c%a),d=Math.floor(c/a);!l&&!r&&(r=!0),e[c]?(i++,c>0&&l>0&&e[c-1]||(n+=r?we("M",l+s,.5+d+s):we("m",o,0),o=0,r=!1),l+1<a&&e[c+1]||(n+=we("h",i),i=0)):o++}return n}ot.render=function(a,s,n){const o=ds.getOptions(s),r=a.modules.size,i=a.modules.data,c=r+o.margin*2,l=o.color.light.a?"<path "+Oe(o.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",d="<path "+Oe(o.color.dark,"stroke")+' d="'+us(i,r,o.margin)+'"/>',u='viewBox="0 0 '+c+" "+c+'"',m='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+u+' shape-rendering="crispEdges">'+l+d+`</svg>
`;return typeof n=="function"&&n(null,m),m};const ms=va,Te=He,rt=nt,fs=ot;function Pe(e,a,s,n,o){const r=[].slice.call(arguments,1),i=r.length,c=typeof r[i-1]=="function";if(!c&&!ms())throw new Error("Callback required as last argument");if(c){if(i<2)throw new Error("Too few arguments provided");i===2?(o=s,s=a,a=n=void 0):i===3&&(a.getContext&&typeof o>"u"?(o=n,n=void 0):(o=n,n=s,s=a,a=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=a,a=n=void 0):i===2&&!a.getContext&&(n=s,s=a,a=void 0),new Promise(function(l,d){try{const u=Te.create(s,n);l(e(u,a,n))}catch(u){d(u)}})}try{const l=Te.create(s,n);o(null,e(l,a,n))}catch(l){o(l)}}oe.create=Te.create;oe.toCanvas=Pe.bind(null,rt.render);oe.toDataURL=Pe.bind(null,rt.renderToDataURL);oe.toString=Pe.bind(null,function(e,a,s){return fs.render(e,s)});function ps({text:e,width:a}){const s=N.useRef(null),n=localStorage.theme==="dark"?"#000":"#7672f2",o=localStorage.theme==="dark"?"#7672f2":"#fff";N.useEffect(()=>{s.current&&oe.toCanvas(s.current,e,{width:a,margin:1,color:{dark:n,light:o}},function(i){i&&console.error(i)})},[e,a]);const r=()=>{if(s.current){const i=s.current.toDataURL("image/png").replace("image/png","image/octet-stream"),c=document.createElement("a");c.download="qrcode.png",c.href=i,c.click()}};return t.jsxs("div",{className:"w-full flex justify-center",children:[t.jsx("div",{className:"w-4/5 flex justify-center",children:t.jsx("canvas",{ref:s})}),t.jsx("div",{className:"w-1/5 flex justify-center items-center gap-4",children:t.jsx(P,{tip:"Baixar imagem",children:t.jsx(Nt,{onClick:r,className:" text-2xl cursor-pointer"})})})]})}function hs({slug:e}){const{setModalContent:a,clearModal:s}=N.useContext(T),n=N.useRef(null),o=N.useRef(null),r=()=>{s(null,{clearAll:!0}),window.open(`https://chat.wipzee.com/${e}`)},i=()=>{try{const d=n.current;if(d){d.classList.toggle("disabled"),d.disabled=!1,d.select();var l=document.execCommand("copy");l&&a({componentName:"modal_copy_link",components:t.jsx(C,{message:"Link Copiado!",type:"INFORMATION",componentName:"modal_copy_link"})}),d.classList.toggle("disabled"),d.disabled=!0}}catch{a({componentName:"modal_failed_copy_link",components:t.jsx(C,{message:"Falha ao copiar o link!",type:"ERROR",componentName:"modal_failed_copy_link"})})}},c=()=>{try{const d=o.current;if(d){d.classList.toggle("disabled"),d.disabled=!1,d.select();var l=document.execCommand("copy");l&&a({componentName:"modal_copy_widget",components:t.jsx(C,{message:"Widget Copiado!",type:"INFORMATION",componentName:"modal_copy_widget"})}),d.classList.toggle("disabled"),d.disabled=!0}}catch{a({componentName:"modal_failed_copy_widget",components:t.jsx(C,{message:"Falha ao copiar o link!",type:"ERROR",componentName:"modal_failed_copy_widget"})})}};return t.jsxs("div",{className:"w-full flex flex-col gap-8",children:[t.jsxs("div",{className:"w-full flex flex-col gap-2",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"Link do seu chat"}),t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx("input",{ref:n,className:"w-4/5 border border-light/20 p-2 rounded-xl disabled",disabled:!0,defaultValue:`https://chat.wipzee.com/${e}`}),t.jsxs("div",{className:"flex justify-center items-center gap-4",children:[t.jsx(P,{tip:"Copie seu link",children:t.jsx(Re,{onClick:i,className:" text-2xl cursor-pointer"})}),t.jsx(se,{title:"Vamos abrir seu chat",text:"Clique no icone acima para abrir seu chat em uma nova guia para testa-lo",children:t.jsx(P,{tip:"Abra seu chat",children:t.jsx(jt,{onClick:r,className:" text-xl cursor-pointer"})})})]})]}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Esse será o link que você enviará aos usuários que irão acessar seu chat."})]}),t.jsxs("div",{className:"w-full flex flex-col gap-2",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"Código do Widget"}),t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx("input",{ref:o,className:"w-4/5 border border-light/20 p-2 rounded-xl disabled",disabled:!0,defaultValue:`<script src="https://widget.wipzee.com/${e}" defer><\/script>`}),t.jsx("div",{className:"w-1/5 flex justify-center items-center gap-4",children:t.jsx(Re,{onClick:c,className:" text-2xl cursor-pointer"})})]}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Copie e cole esse código no head do html do seu site."})]}),t.jsxs("div",{className:"w-full flex flex-col gap-2",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"QR CODE"}),t.jsx(ps,{width:200,text:`https://chat.wipzee.com/${e}`}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Use esse QR CODE para acessar seu site facilmente"})]})]})}const xs=e=>e.errors!=null,gs=(e,a)=>{const s={};for(;e.length;){const n=e[0],{code:o,message:r,path:i}=n,c=i.join(".");if(!s[c])if("unionErrors"in n){const l=n.unionErrors[0].errors[0];s[c]={message:l.message,type:l.code}}else s[c]={message:r,type:o};if("unionErrors"in n&&n.unionErrors.forEach(l=>l.errors.forEach(d=>e.push(d))),a){const l=s[c].types,d=l&&l[n.code];s[c]=bt(c,a,s,o,d?[].concat(d,n.message):n.message)}e.shift()}return s},it=(e,a,s={})=>async(n,o,r)=>{try{const i=await e[s.mode==="sync"?"parse":"parseAsync"](n,a);return r.shouldUseNativeValidation&&yt({},r),{errors:{},values:s.raw?n:i}}catch(i){if(xs(i))return{values:{},errors:wt(gs(i.errors,!r.shouldUseNativeValidation&&r.criteriaMode==="all"),r)};throw i}};function _s(){const{watch:e}=me(),[a,s]=N.useState();return N.useEffect(()=>{const n=e("step_4.slug");s(n.replaceAll(" ","-"))},[e()]),t.jsxs("div",{className:"w-full flex gap-2 items-center bg-white p-2 my-4 rounded-md",children:[t.jsx(Ct,{className:"fill-zinc-600"}),t.jsx(vt,{className:"fill-zinc-600"}),t.jsx(Et,{className:"fill-zinc-600"}),t.jsxs("div",{className:"w-full bg-zinc-600 rounded-xl p-3 flex gap-2 items-center",children:[t.jsx(ae,{className:"fill-green-600"}),t.jsxs("h2",{className:"opacity-80",children:["https://chat.wipzee.com/",a]})]})]})}function Ns(){const{control:e}=me(),{fields:a,remove:s,append:n}=St({control:e,name:"step_0.social_proof"});return t.jsxs(g.Container,{className:"overflow-auto h-[400px]",children:[t.jsxs(g.Container,{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex flex-col text-center",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Adicione avaliações dos seus clientes:"}),t.jsx("span",{className:"text-sm opacity-70",children:"(Essas avaliações estarão visível na bio do chat)"})]}),t.jsxs(I,{type:"button",onClick:()=>n({}),children:["Adicionar ",t.jsx(ze,{})]})]}),t.jsx(g.Container,{className:"px-4 overflow-auto h-[300px] my-2",children:a.map((o,r)=>t.jsxs(g.Container,{className:"w-full flex flex-col gap-4 my-2 p-2 rounded-lg border border-primary-100 relative",children:[t.jsx(At,{className:"absolute -top-3 -right-3 bg-red-800/50 fill-red-500 cursor-pointer rounded-full p-1 text-2xl",onClick:()=>s(r)}),t.jsxs(g.Container,{className:"w-full flex justify-start items-center gap-4",children:[t.jsx(g.File,{name:`step_0.social_proof.${r}.avatar`,sizeContainer:"50px"}),t.jsx(g.Input,{title:"Nome do cliente",name:`step_0.social_proof.${r}.person_name`}),t.jsx(g.Input,{type:"number",title:"Nota da avaliação",name:`step_0.social_proof.${r}.rating`,min:0,max:5})]}),t.jsx(g.TextArea,{name:`step_0.social_proof.${r}.text`,title:"Oque o cliente achou do produto?"}),t.jsxs(g.Container,{className:"flex gap-4 justify-start",children:[t.jsx(g.File,{name:`step_0.social_proof.${r}.images.0`,sizeContainer:"50px"}),t.jsx(g.File,{name:`step_0.social_proof.${r}.images.1`,sizeContainer:"50px"}),t.jsx(g.File,{name:`step_0.social_proof.${r}.images.2`,sizeContainer:"50px"})]})]},o.id))})]})}function js({project:e,setProjects:a}){var _,v,j,b,y;const{setModalContent:s,clearModal:n}=N.useContext(T),{setClient:o,client:r}=N.useContext(M),[i,c]=N.useState(),[l,d]=Z(),u=Number(l.get(Be))||0,p=fe({resolver:it(Tt),defaultValues:{step_0:{project_name:e.project_name,logo:e.logo,bio:e.bio,social_proof:e.social_proof},step_1:{prompt_id:e.prompt.id,chat_input_message:e.chat_input_message,call_to_action:e.call_to_action},step_2:{facebook_pixel:e.pixel_facebook},step_3:{chat_appearance:{chat_icon:(_=e.chat_appearance)==null?void 0:_.chat_icon,icon_text:(v=e.chat_appearance)==null?void 0:v.icon_text,primary_color:(j=e.chat_appearance)==null?void 0:j.primary_color,second_color:(b=e.chat_appearance)==null?void 0:b.second_color,background:(y=e.chat_appearance)==null?void 0:y.background}},step_4:{slug:e.slug}}});N.useEffect(()=>{(async()=>{l.set(It,(e.call_to_action.length-1).toString()),d(l);const h=await Mt(e.plan_management_id);(h==null?void 0:h.status)===200&&c(h.data.prompt)})()},[]);const m=async h=>{var E,S;let w={};if(Object.keys(h).forEach(A=>{const D=h[A];Object.keys(D).forEach(k=>{w[k]=h[A][k]})}),w&&e.slug){if((E=h.step_4)!=null&&E.slug&&((S=h.step_4)==null?void 0:S.slug)!==e.slug&&!await Pt(h.step_4.slug)){s({componentName:"modal_error_slug",components:t.jsx(C,{componentName:"modal_error_slug",message:"A slug escolhida não está disponível!",type:"WARNING"})});return}w.chat_appearance.can_update=e.chat_appearance.can_update,w.chat_appearance.id=e.chat_appearance.id;const A=await Rt(w,e.slug);A&&A.status===200&&(a(D=>{const k=D.findIndex(V=>V.id===e.id),U=D.filter(V=>V.id!==e.id);return w.is_online=A.data.is_online,w.plan_management_id=A.data.plan_management_id,w.id=A.data.id,w.prompt=A.data.prompt,w.chat_appearance=A.data.chat_appearance,U.splice(k,0,w),U}),s({componentName:"modal_chat_updated",components:t.jsx(C,{message:"Chat atualizado com sucesso",componentName:"modal_chat_updated",functionAfterComplete:()=>n("modal_edit_project")})}))}};async function f(){const h=async()=>{if(e.id){const w=await Lt(e.id);if(w&&w.status===200){a(S=>S.filter(A=>A.id!==e.id));const E=r==null?void 0:r.plan_management.project.findIndex(S=>S.id===e.id);r&&E&&(r.plan_management.project.splice(E,1),o(r)),s({componentName:"modal_delete_success",components:t.jsx(C,{message:"Chat excluido com sucesso!",componentName:"modal_delete_success",functionAfterComplete:()=>n(null,{clearAll:!0})})})}}};s({componentName:"modal_confirm_delete_chat",components:t.jsx(L,{children:t.jsx(Bt,{title:"Tem certeza que deseja deletar esse chat?",subTitle:"Uma vez removido, não pode ser revertido.",confirmFunction:h,cancelFuntion:()=>n("modal_confirm_delete_chat")})})})}const x=h=>{l.set(Be,h.toString()),d(l),p.unregister("step_3.chat_appearance.chat_icon"),p.register("step_3.chat_appearance.chat_icon",{value:h})};return!!(i!=null&&i.length)&&t.jsx("div",{className:"w-[90vw] h-[80vh] min-h-[450px] min-w-[700px] flex overflow-hidden",children:t.jsxs(g.EditForm,{form:p,onDelete:f,onSubmit:m,activeSimulator:!0,children:[t.jsxs(g.EditStep,{index:0,titleStep:"Informações do chat",children:[t.jsxs(g.Container,{className:"flex justify-start items-center gap-6",children:[t.jsx(g.File,{name:"step_0.logo",sizeContainer:"80px"}),t.jsx(g.Input,{name:"step_0.project_name",title:"Escreva o nome do seu chat"})]}),t.jsx(g.TextArea,{name:"step_0.bio",title:"Escreva uma descrição para seu chat"}),t.jsx(Ns,{})]}),t.jsxs(g.EditStep,{index:1,titleStep:"Configurações do chat",children:[t.jsx(g.Select,{name:"step_1.prompt_id",options:i.map(h=>Object({value:h.id,text:h.prompt_name})),title:"Selecione sua fonte de dados"}),t.jsx(g.TextArea,{name:"step_1.chat_input_message.0",title:"Digite a primeira mensagem do seu chat"}),t.jsx(kt,{})]}),t.jsx(g.EditStep,{index:2,titleStep:"Aparência do chat",children:t.jsxs(g.Container,{className:"flex flex-col gap-8",children:[t.jsxs("div",{className:"flex flex-col justify-center gap-4",children:[t.jsx("h2",{className:"text-center text-xl",children:"Escolha um icone para seu chat"}),t.jsx("div",{className:"flex justify-center gap-8 text-5xl",children:Dt.map(({Icon:h,id:w},E)=>t.jsx(h,{"data-iscurrent":u-1===E,className:"hover:bg-primary-100 data-[iscurrent=true]:bg-primary-100 cursor-pointer rounded-full p-2",onClick:()=>x(w)},w))})]}),t.jsx(g.Input,{name:"step_3.chat_appearance.icon_text",title:"Digite o texto que será exibido ao lado do icon"}),t.jsxs(g.Container,{className:"flex",children:[t.jsx(g.Color,{name:"step_3.chat_appearance.primary_color",title:"Escolha a cor primária do seu chat"}),t.jsx(g.Color,{name:"step_3.chat_appearance.second_color",title:"Escolha a cor secundária do seu chat"})]}),t.jsx(g.Color,{name:"step_3.chat_appearance.background",title:"Escolha a cor do background do seu chat"})]})}),t.jsx(g.EditStep,{index:3,titleStep:"Configuração avançadas",children:t.jsxs(g.Container,{className:"flex flex-col",children:[t.jsx(g.Input,{name:"step_4.slug",title:"Altere a slug do seu chat"}),t.jsx(_s,{}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"font-medium uppercase",children:"Lembre-se"}),t.jsx("span",{className:"opacity-70",children:"Ao trocar a slug do seu chat, todos seus clientes que possuirem a URL antiga, podem perder acesso ao seu site utilizando a antiga URL."})]})]})})]})})}function ys({project:e,setNewProject:a,prompts:s}){const{client:n}=N.useContext(M),{setModalContent:o}=N.useContext(T),r=ue(),[i,c]=Z(),l=()=>{i.get("tour")==="2"&&(i.set("tour","0"),c(i),n&&$e(n==null?void 0:n.id,!1)),o({componentName:"modal_edit_project",components:t.jsx(L,{children:t.jsx(js,{setProjects:a,project:e,prompts:s})})})},d=async(m,f)=>{if(!f)return o({componentName:"modal_failed_updated_status_chat",components:t.jsx(C,{message:"Falha ao atualizar o status do chat, reinicie a página e tente novamente",componentName:"modal_failed_updated_status_chat",type:"WARNING"})}),!1;const x=await zt(m,f);return(x==null?void 0:x.status)===200?(a(_=>(_.find(v=>v.id===x.data.id).is_online=x.data.is_online,_)),!0):(o({componentName:"modal_failed_updated_status_chat_02",components:t.jsx(C,{message:"Falha ao atualizar o status do chat, reinicie a página e tente novamente",componentName:"modal_failed_updated_status_chat_02",type:"WARNING"})}),!1)},u=()=>{if(i.set("tour","2"),c(i),!e.slug){o({componentName:"modal_failed_display_link",components:t.jsx(C,{message:"Falha ao exibir seus links",type:"ERROR",componentName:"modal_failed_display_link"})});return}o({componentName:"modal_display_share_project",components:t.jsx(L,{children:t.jsx(hs,{slug:e.slug})})})},p=({target:m})=>{m.dataset.metric&&r("/panel?tab=1")};return e&&t.jsxs("div",{className:"w-1/4 min-w-[200px] bg-primary-100 dark:bg-gray text-light relative flex flex-col items-center gap-2 cursor-pointer rounded-xl",onClick:p,"data-metric":!0,children:[t.jsxs("div",{className:"w-full flex justify-between items-center gap-2 p-2",children:[t.jsxs("div",{className:"flex justify-center gap-2",children:[t.jsx(se,{title:"Vamos acessar seu chat",text:"Clique aqui em cima para obter seu link ou para pegar o código do widget",hidden:i.get("tour")==="2"||i.get("tour")==="0",children:t.jsx(P,{tip:"Veja todos os seus links",children:t.jsx(Ft,{className:" text-xl",onClick:u})})}),t.jsx(se,{title:"Vamos personalizar seu chat",text:"Agora que já viu como funciona, vamos conhecer como podemos deixar ele de acordo com a sua marca!",hidden:i.get("tour")!=="2",children:t.jsx(P,{tip:"Edite seu chat",children:t.jsx(Ot,{className:"text-xl",onClick:l})})})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(P,{tip:"Ative ou desative seu chat",children:t.jsx(Ut,{isActive:e.is_online,template:"onOff",cb:m=>d(m,e.slug)})})})]}),t.jsx("div",{className:"w-[150px] h-[110px] rounded-xl overflow-hidden","data-metric":!0,children:t.jsx("img",{src:e.logo||"https://via.placeholder.com/100",alt:"imagem do projeto",className:"w-full h-full object-cover"})}),t.jsx("h2",{className:"text-center py-4 font-bold text-lg","data-metric":!0,children:e.project_name})]},e.slug)}function ws(){var n;const{client:e}=N.useContext(M),[a,s]=N.useState(e!=null&&e.plan_management?e.plan_management.project:[]);return e&&t.jsx(X,{title:"Meus chats",children:t.jsxs("div",{className:"w-4/5 px-8 pb-6 flex flex-col gap-8 z-50",children:[t.jsx("div",{className:"w-full flex justify-end items-center",children:t.jsx(se,{title:"Vamos criar seu primeiro chat",text:'Clique em <span class="text-3xl font-medium mx-1">+</span> para criar seu primeiro chat de forma simples e fácil',position:"BOTTOM",hidden:a.length!==0,children:t.jsx(Ca,{plan_management_id:(n=e==null?void 0:e.plan_management)==null?void 0:n.id})})}),a.length?t.jsx("div",{className:"w-full flex flex-col gap-4",children:t.jsx("div",{className:"w-full flex items-center gap-4",children:a.map(o=>{var r;return t.jsx(ys,{project:o,setNewProject:s,prompts:(r=e.plan_management)==null?void 0:r.prompt},o.id)})})}):t.jsx("h2",{className:"py-8 font-bold text-primary-100 dark:text-light",children:'Você ainda não possui nenhum chat, clique em "Novo chat" para começar seu primeiro projeto.'})]})})}function bs({setColumns:e,columns:a,modalName:s}){const{clearModal:n}=N.useContext(T),[o,r]=N.useState(a),i=l=>{const d=l.currentTarget.dataset.status=="true",u=l.currentTarget.dataset.name;r(()=>[...a.filter((p,m)=>(m>1&&p.columnName===u&&(p.status=!d),p))])},c=()=>{localStorage.setItem("metricColumnActive",JSON.stringify(a)),e(a),n(s)};return t.jsxs("div",{className:"w-1/2 max-w-[400px] bg-zinc-800 text-light",children:[t.jsx("h2",{className:"w-full text-center text-xl p-4",children:"Organize suas columns"}),t.jsx("div",{className:"w-full flex gap-2 flex-col",children:o.map((l,d)=>t.jsxs("div",{className:"w-full flex justify-between px-4",children:[t.jsx("p",{children:l.columnName}),t.jsx("div",{className:"w-[30px] h-[20px] bg-zinc-100 flex overflow-hidden rounded-full cursor-pointer",style:{justifyContent:`${l.status?"end":"start"}`},onClick:i,"data-status":l.status,"data-name":l.columnName,children:t.jsx("div",{className:"w-2/3 h-full rounded-xl flex justify-center items-center",style:{background:`${l.status?"green":"red"}`},children:d<2&&t.jsx(ae,{className:"w-[8px]"})})})]},l.columnName))}),t.jsx("div",{className:"w-full flex mt-12 justify-center",children:t.jsx(I,{onClick:c,children:"Salvar"})})]})}function lt({options:e,alternativeTitle:a,title:s,Icon:n,defaultValue:o,handleSelectDatabase:r}){return t.jsxs("div",{className:"w-full px-2 h-full bg-light dark:bg-gray border border-primary-100 font-bold rounded-lg flex gap-2 justify-center items-center",children:[n&&t.jsx(n,{className:"text-2xl fill-primary-100 dark:fill-light"}),t.jsxs("select",{className:"h-full bg-light dark:bg-gray text-primary-100 dark:text-light cursor-pointer outline-none ",disabled:!e.length,onChange:r,defaultValue:o||"#",children:[s&&a&&t.jsx("option",{disabled:!0,value:"#",className:"cursor-pointer",children:e.length?s:a}),e.map((i,c)=>t.jsx("option",{value:i.id,className:"cursor-pointer",children:i.name},c))]})]})}function ct({typeFilter:e}){const[a,s]=Z(),n=({target:o})=>{const r=J(new Date).currentHour,i=o,{value:c}=o.options[i.selectedIndex];var l=0;switch(c){case"today":l=r;break;case"yesterday":l=r+24;break;case"last_7_days":l=r+6*24;break;case"last_14_days":l=r+13*24;break;case"last_month":l=r+29*24;break;case"last_3_month":l=r+89*24;break;case"last_6_month":l=r+179*24;break;case"last_year":l=r+364*24;break;default:l=0;break}const d=new URLSearchParams(a);d.set(e,l.toString()),s(d)};return t.jsx(lt,{handleSelectDatabase:n,Icon:$t,options:[{id:"0",name:"Todas as datas"},{id:"today",name:"Hoje"},{id:"yesterday",name:"Ontem"},{id:"last_7_days",name:"Ultimos 7 dias"},{id:"last_14_days",name:"Ultimos 14 dias"},{id:"last_month",name:"Ultimo mês"},{id:"last_3_month",name:"Ultimos 3 meses"},{id:"last_6_month",name:"Ultimos 6 meses"},{id:"last_year",name:"Ultimo ano"}]})}function z(e){const a=Number(new Date),s=Number(new Date(e)),o=(a-s)/(1e3*3600);return Math.floor(o)}function B(e,a=0){function s(){return e.metric.chat_event.reduce((m,f)=>{const x=f.open_chat.filter(_=>{const v=z(_.created_at);return a>0?v<=a:!0});return m+x.length},0)}function n(){return(e.metric.chat_event.filter(f=>{const x=z(f.created_at);return a>0?x<=a:!0})||[]).filter((f,x,_)=>x===_.findIndex(v=>v.guest_id===f.guest_id)).length}function o(){return e.plan_message_manager.filter(m=>{const f=z(m.created_at);return a>0?f<=a:!0},0).reduce((m,f)=>m+f.input,0)}function r(){return e.plan_message_manager.filter(m=>{const f=z(m.created_at);return a>0?f<=a:!0},0).reduce((m,f)=>m+f.output,0)}function i(){const p=o()+r(),m=n()>0?p/n():0;return m%1===0?m:Number(m.toFixed(1))}function c(){const p=e.metric.chat_event.reduce((v,j)=>{const b=j.chat_time.filter(y=>{const h=z(y.created_at);return a>0?h<=a:!0});return v+b.reduce((y,h)=>{if(!h.closed_at&&!h.created_at)return 0;const w=Number(new Date(h.closed_at))-Number(new Date(h.created_at));return y+w},0)},0),m=Math.floor(p/1e3),f=Math.floor(m/60);return`${Math.floor(f/60).toString().padStart(2,"0")}:${(f%60).toString().padStart(2,"0")}:${(m%60).toString().padStart(2,"0")}`}function l(){const p=e.metric.chat_event.reduce((j,b)=>{const y=b.chat_time.filter(h=>{const w=z(h.created_at);return a>0?w<=a:!0});return j+y.reduce((h,w)=>{if(!w.closed_at&&!w.created_at)return 0;const E=Number(new Date(w.closed_at))-Number(new Date(w.created_at));return h+E},0)},0),m=p>0?p/n():0,f=Math.floor(m/1e3),x=Math.floor(f/60),_=Math.floor(x/60),v=`${_.toString().padStart(2,"0")}:${(x%60).toString().padStart(2,"0")}:${(f%60).toString().padStart(2,"0")}`;return _!==1/0?v:"00:00:00"}function d(){return e.metric.button_event.filter(m=>{const f=z(m);return a>0?f<=a:!0},0).reduce((m,f)=>m+f.clicked_button.length,0)}function u(){return J(e.created_at).dateFormat_A}return{IS_ONLINE:e.is_online||!1,NAME:e.project_name,CAT:s(),CAU:n(),MESSAGE_INPUT:o(),MESSAGE_OUTPUT:r(),MESSAGES_TOTAL:o()+r(),MEDIA_MESSAGES_CHAT:i(),USAGE_TIME:c(),MEDIA_USAGE_TIME:l(),CREATED_AT:u(),LINK_CLICKS:d(),LEADS_COLLECTED:0,SERVICE_NOTE:0,RESOLUTION_RATE:0,TOKEN_INPUT:"0",TOKEN_OUTPUT:"0",TOKEN_TOTAL:"0",USED_REAL:"0"}}async function Cs(e){return await H.post(`${G}/analyze_metric`,{prompt:e}).catch(s=>console.log(s))}function vs(e){const a=e.split("");let s="";return a.forEach(n=>{n.includes(`
`)&&s.length||n.includes(":")?s+=n+"<br />":s+=n}),s}async function Es(e,a){const s=await H.post(`${G}/metric_analysis/create`,{plan_management_id:e,result:a});if(s.data.error)throw new Error("Unable to create the Metric Analysis.");return s}async function Ss({feedback:e,metrics_analysis_rating:a,metric_analysis_id:s}){const n=await H.post(`${G}/metric_analysis/create_feedback`,{feedback:e,metrics_analysis_rating:a,metric_analysis_id:s});if(n.data.error)throw new Error("Unable to create the Feedback Metric Analysis.");return n}async function As(e){const a=await H.get(`${G}/metric_analysis/${e}`);if(a.status===400)throw new Error("Unable to create the Feedback Metric Analysis.");return a}function Ts({index:e,spanReview:a,metric_analysis_id:s}){const n=N.useRef(null),{setModalContent:o,clearModal:r}=N.useContext(T),i=async()=>{var l;const c=(l=n.current)==null?void 0:l.value;c&&s?(await Ss({feedback:c,metrics_analysis_rating:e,metric_analysis_id:s})).data.response&&o({componentName:"modal_send_success",components:t.jsx(C,{componentName:"modal_send_success",message:"Feedback enviado com sucesso. Obrigado!",functionAfterComplete:()=>r(null,{clearLast:!0})})}):o({componentName:"modal_error_send_feedback",components:t.jsx(C,{componentName:"modal_error_send_feedback",message:"Você precisa deixar um feedback antes de enviar sua avaliação ou houve um erro no envio do feedback!",type:"ERROR"})})};return t.jsxs("div",{className:"w-[300px] flex flex-col items-center gap-2",children:[t.jsxs("h2",{className:"text-center font-bold text-lg",children:['Sua avaliação foi "',a,'".']}),t.jsx("p",{className:"text-center opacity-80",children:"Gostaria de deixar um feedback em algo poderia melhorar?"}),t.jsx("textarea",{ref:n}),t.jsx(I,{customClass:"my-4",onClick:i,children:"Enviar"})]})}var Ue=`
 A wipzee é uma empresa que fornece um chatbot com inteligencia artificial, promovendo uma experiência completa ao usuário.
 Desda personalização do chat até o consumo de dados (Métricas), abaixo será informado as minhas métricas, quero que você faça uma analise
 completa e sugira melhorias ou me de feedbacks positivos sobre as métricas.

 exemplo 1: se tiver muitos chats abertos e nenhum clique no link, significa que o cliente não está sendo influenciado a clicar no link. Sugestão: "Mudar o texto do link e deixar mais atrativo ou melhorar sua fonte de dados."
 exemplo 2: se tiver muitos chats abertos e nenhuma ou poucas mensagens, significa que o cliente não está sentindo avontade de conversar com a IA ou não está conseguindo conversar com ela. SOLUÇÃO: Melhorar a primeira mensagem do chat ou ver se existe algum problema tecnico nas trocas de mengens."
`;function Is(){const{clearModal:e,setModalContent:a}=N.useContext(T),{client:s}=N.useContext(M),[n,o]=N.useState(),r=N.useRef(null);N.useEffect(()=>{(async()=>{if(s){const d=(await As(s.plan_management.id)).data.response,u=s.plan_management.plan.max_analyze_metric.default,p=s.plan_management.plan.max_analyze_metric.bonus,m=Number(u+p);d.length?o({status:"APRROVED",analysis:d}):d.length==m?i():a({componentName:"modal_limit_analysis",components:t.jsx(C,{componentName:"modal_limit_analysis",message:"O limite de analises no seu plano foi atingido. Aguarde até amanhã ou mude de plano para fazer uma nova análise.",functionAfterComplete:()=>e(null,{clearAll:!0})})})}})()},[]);const i=()=>{if(n&&s&&(n==null?void 0:n.analysis.length)>=Number(s.plan_management.plan.max_analyze_metric.default)){a({componentName:"modal_max_limit_analysis",components:t.jsx(C,{componentName:"modal_max_limit_analysis",message:"O limite de análises no seu plano foi atingido. Aguarde até amanhã ou mude de plano para fazer uma nova análise.",type:"WARNING"})});return}if(o(null),!s)throw new Error("Client is missing!");const l=s.plan_management.project,d=J(new Date).currentHour;l&&l.forEach(u=>{Ue+=`
                    NOME DO CHAT: ${u.project_name}
                    
                    MÉTRICAS:

                    Chats abertos total:
                    (Essa métrica pode tanto ser tanto varios usuários abrindo um chat ou como pode ser o mesmo usuário abrindo ele varias vezes)
                    [1000]

                    Chats abertos:
                    (Essa métrica conta quantas vezes o usuário abriu o chat, caso o usuário abra o mesmo chat 2 vezes ou mais, será contabilizado apenas uma vez)
                    [1]

                    Quando o chat foi criado:  
                    (Essa métrica registra quando o chat foi criado)
                    [${B(u,d).CREATED_AT}]

                    chat está ativado ou desativado:  
                    (Informa se o chat está ativado ou não: true = ativado e false = desativado)
                    [${B(u,d).IS_ONLINE}]

                    Leads coletados:  
                    (Informa quantos usuários deixaram um contato salvo no sistema)
                    [${B(u,d).LEADS_COLLECTED}]

                    Cliques no link:  
                    (Informa quantos cliques no link(call to action) foi dado no chat)
                    [100]

                    Média de mensagens:  
                    (Informa qual a média de mensagens por chat)
                    [${B(u,d).MEDIA_MESSAGES_CHAT}]

                    Média de tempo de uso:  
                    (Informa qual a média que o usuário ficou interagindo no chat)
                    [${B(u,d).MEDIA_USAGE_TIME}]

                    Total de Mensagens:  
                    (Informa qual o total de mensagens que esse chat tem)
                    [${B(u,d).MESSAGES_TOTAL}]

                    Entrada de Mensagens:  
                    (Informa quantas mensagens os usuários já mandaram para esse chat)
                    [${B(u,d).MESSAGE_INPUT}]

                    Entrada de Mensagens:  
                    (Informa quantas mensagens os usuários já mandaram para esse chat)
                    [${B(u,d).MESSAGE_OUTPUT}]

                    Saída de Mensagens:  
                    (Informa quantas mensagens nossa inteligencia artificial já mandou para esse chat)
                    [${B(u,d).MESSAGE_OUTPUT}]

                    tempo de uso:  
                    (Informa quanto tempo esse chat já ficou aberto)
                    [${B(u,d).USAGE_TIME}]`}),(async()=>{const u=await Cs(Ue);if((u==null?void 0:u.status)===200&&u.data){const{text:p}=u.data.choices[0],m=await Es(s==null?void 0:s.plan_management.id,p);o({status:"APRROVED",analysis:m.data.response})}else a({componentName:"modal_error_analyze_metric",components:t.jsx(C,{componentName:"modal_error_analyze_metric",message:"Não foi possível analisar suas métricas, por favor tente mais tarde.",type:"ERROR"})})})()},c=l=>{var d,u;if(n!=null&&n.analysis[0].feedback)a({componentName:"modal_error_analysis_metric",components:t.jsx(C,{componentName:"modal_error_analysis_metric",message:"Essa análise já foi avaliada!",type:"WARNING"})});else{const p=l.currentTarget.tabIndex,m=((d=l.currentTarget.querySelector("span"))==null?void 0:d.textContent)||"Regular",f=(u=r.current)==null?void 0:u.querySelectorAll("div > svg");f==null||f.forEach(x=>x.classList.remove("fill-primary-100")),f==null||f.forEach((x,_)=>_+1<=p&&x.classList.add("fill-primary-100")),a({componentName:"modal_show_feedback_analyze",components:t.jsx(L,{children:t.jsx(Ts,{index:p,spanReview:m,metric_analysis_id:n==null?void 0:n.analysis[0].id})})})}};return n?t.jsxs("div",{className:"max-w-[500px] flex flex-col items-center gap-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Relatório da análise"}),t.jsxs("span",{className:"opacity-70",children:[n.analysis.length,"/",Number(s==null?void 0:s.plan_management.plan.max_analyze_metric.default)," Análises restantes de hoje"]})]}),t.jsx("div",{className:"max-h-[300px] overflow-auto border border-primary-100 p-2",children:t.jsx("p",{dangerouslySetInnerHTML:{__html:vs(n.analysis[0].result)},className:"text-center"})}),t.jsxs("div",{className:"flex flex-col w-full items-center my-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Avalie essa análise:"}),t.jsx("div",{className:"flex gap-2",ref:r,children:Array.from({length:5}).map((l,d)=>t.jsxs("div",{tabIndex:d+1,onClick:c,className:"group flex flex-col justify-center items-center",children:[t.jsx(Vt,{"data-isselected":d+1<=n.analysis[0].metrics_analysis_rating,className:"cursor-pointer text-3xl hover:fill-primary-100 data-[isselected=true]:fill-primary-100"}),t.jsx("span",{className:"group-hover:opacity-100 opacity-0",children:d===0?"horrível":d===1?"ruim":d===2?"regular":d===3?"boa":"excelente"})]},d))})]}),t.jsxs("div",{className:"flex gap-8 justify-center items-center",children:[t.jsx("span",{onClick:()=>e(null,{clearLast:!0}),className:"underline opacity-80 my-4 cursor-pointer",children:"Fechar análise"}),t.jsx(I,{onClick:i,children:"Nova análise"})]})]}):t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[t.jsx(qt,{}),t.jsx("h2",{children:"Analisando métricas"})]})}function Ms({client:e,handleRequestDataProject:a,setColumns:s,columns:n}){const{setModalContent:o}=N.useContext(T),r=async({currentTarget:l})=>{if(e!=null&&e.plan_management){const d=l.querySelector("svg");d.classList.add("rotate-[-360deg]","transition-transform","duration-1000"),a(e==null?void 0:e.id);const u=setTimeout(()=>{d.classList.remove("rotate-[-360deg]","transition-transform","duration-1000"),clearTimeout(u)},1e3)}},i=()=>{o({componentName:"modal_organization_column",components:t.jsx(bs,{modalName:"modal_organization_column",setColumns:s,columns:n})})},c=()=>{o({componentName:"modal_show_analyze_metric",components:t.jsx(L,{children:t.jsx(Is,{})})})};return t.jsxs("div",{className:"w-[70vw] flex gap-8 justify-end items-center",children:[t.jsx("div",{className:"p-2 bg-light dark:bg-dark border border-primary-100 rounded-md cursor-pointer",onClick:r,children:t.jsx(qe,{className:"text-xl fill-primary-100 dark:fill-light"})}),t.jsx("div",{className:"h-[40px]",children:t.jsx(ct,{typeFilter:"filter_time_metric"})}),t.jsxs(I,{onClick:i,customClass:"bg-light dark:bg-dark text-primary-100 dark:text-light border border-primary-100 px-4",children:[" ",t.jsx(Ht,{className:"text-xl fill-primary-100 dark:fill-light"})," Organize as colunas"]}),t.jsxs(I,{customClass:"bg-primary-100 border border-primary-100 px-4",onClick:c,children:[" ",t.jsx(Gt,{className:"text-xl"})," Analisar métricas com IA"]})]})}const be=[{key:"IS_ONLINE",columnName:"Status",status:!0,dataType:"boolean"},{key:"NAME",columnName:"Nome do chat",status:!0,dataType:"string"},{key:"CAT",columnName:"Chats abertos (total)",status:!0,dataType:"number"},{key:"CAU",columnName:"Chats abertos (unico)",status:!1,dataType:"number"},{key:"MESSAGE_INPUT",columnName:"Mensagens de entrada",status:!1,dataType:"number"},{key:"MESSAGE_OUTPUT",columnName:"Mensagens de saída",status:!1,dataType:"number"},{key:"MESSAGES_TOTAL",columnName:"Mensagens total",status:!0,dataType:"number"},{key:"MEDIA_MESSAGES_CHAT",columnName:"Mensagens por chat",status:!1,dataType:"number"},{key:"USAGE_TIME",columnName:"Tempo de uso",status:!1,dataType:"string"},{key:"MEDIA_USAGE_TIME",columnName:"Tempo de uso por chat",status:!0,dataType:"string"},{key:"LINK_CLICKS",columnName:"Cliques no link",status:!0,dataType:"number"},{key:"LEADS_COLLECTED",columnName:"Leads coletados",status:!0,dataType:"number"},{key:"SERVICE_NOTE",columnName:"Nota de atendimento",status:!0,dataType:"number"},{key:"RESOLUTION_RATE",columnName:"Taxa de resolução",status:!0,dataType:"number"},{key:"CREATED_AT",columnName:"Criado em",status:!0,dataType:"string"}];function ks({setColumns:e,columns:a}){return N.useEffect(()=>{const s=JSON.parse(localStorage.getItem("metricColumnActive")||"[]");s.length>0?s.length!==be.length?localStorage.setItem("metricColumnActive",JSON.stringify(be)):e(s):localStorage.setItem("metricColumnActive",JSON.stringify(be))},[]),a&&t.jsx("div",{className:"w-1/2 flex",children:a.map(s=>s.status&&t.jsx("span",{className:"flex-none p-3 text-sm font-bold uppercase text-center bg-primary-100 dark:bg-primary-300 text-light dark:text-primary-100 border-r border-r-light dark:border-r-primary-100",children:s.columnName},s.columnName))})}function Ds({columns:e,setColumns:a,planManagement:s}){const[n]=Z(),o=n.get("filter_time_metric");return t.jsxs("div",{className:"w-[70vw] h-[40vh] self-center rounded-xl overflow-x-auto",children:[t.jsx(ks,{setColumns:a,columns:e}),t.jsx("div",{className:"flex flex-col",children:s!=null&&s.project?s.project.map(r=>t.jsx("div",{className:"flex-none flex",children:e.map((i,c)=>i.status&&t.jsx("span",{className:"w-48 flex-none text-ellipsis overflow-hidden whitespace-nowrap text-center border border-primary-100/30 p-2",children:c===0?t.jsxs("div",{className:"w-full flex justify-center items-center gap-2",children:[t.jsx("div",{className:`w-[8px] h-[8px] ${r.is_online?"bg-green-700":"bg-red-700"} rounded-full`}),t.jsx("span",{children:r.is_online?"Ativo":"Desativado"})]}):c===1?r.project_name:B(r,o)[i.key]},i.columnName))},r.id)):t.jsx("h2",{className:"text-center p-4",children:'Você ainda não criou nenhum chat, clique em "Meus chats" , depois criar "Novo chat".'})}),t.jsx("div",{className:"flex-none flex ",children:e.map((r,i)=>r.status&&t.jsx("div",{className:"w-48 flex-none p-2 flex justify-center items-center gap-2",children:i===1?t.jsx("span",{className:"w-full font-bold text-primary-100 text-xl text-center",children:"TOTAL"}):r.dataType==="number"?t.jsx("span",{className:"w-full font-bold text-primary-100 text-xl text-center",children:s==null?void 0:s.project.reduce((c,l)=>c+Number(B(l,o)[r.key]),0)}):t.jsx("span",{className:"w-full text-primary-100 text-xl text-center",children:"-"})},r.key))})]})}function Ps(){const e=JSON.parse(localStorage.getItem("metricColumnActive")||"[]"),{setModalContent:a}=N.useContext(T),{client:s}=N.useContext(M),[n,o]=N.useState(e),[r,i]=N.useState(s==null?void 0:s.plan_management);N.useEffect(()=>{s!=null&&s.plan_management&&c(s==null?void 0:s.id)},[]);const c=async l=>{const d=await Jt(l);(d==null?void 0:d.status)===200?i(d.data.plan_management):a({componentName:"modal_failed_load_metric",components:t.jsx(C,{message:"Falha ao recarregar as métricas, tente reiniciar a página.",type:"ERROR",componentName:"modal_failed_load_metric"})})};return t.jsx("div",{className:"w-full h-full overflow-y-auto flex flex-col gap-8",children:t.jsxs(X,{title:"Métricas",className:"flex-col items-center gap-8",children:[t.jsx(Ms,{client:s,columns:n,handleRequestDataProject:c,setColumns:o}),t.jsx(Ds,{columns:n,planManagement:r,setColumns:o})]})})}function Rs({plan_management_id:e}){const{client:a}=N.useContext(M),{setModalContent:s}=N.useContext(T),n=ue(),o=()=>{if(a!=null&&a.plan_management){const r=Number(a.plan_management.plan.max_databases.default),i=a.plan_management.prompt.length;a.plan_management.status!=="DISABLED"?r>i?n(`/create-database/${e}`):s({componentName:"modal_max_database",components:t.jsx(C,{message:"Você atingiu o número maximo de base de dados no seu plano.",componentName:"modal_max_database"})}):s({componentName:"modal_desactive_account",components:t.jsx(C,{message:"O plano da sua conta está desabilitado.",componentName:"modal_desactive_account"})})}else s({componentName:"modal_without_plan",components:t.jsx(C,{message:"Nenhum plano foi vinculado a sua conta",componentName:"modal_without_plan"})})};return t.jsx(Kt,{className:"w-[300px] text-5xl py-3 fill-primary-100",onClick:o})}function Bs({prompt:e,setPrompts:a}){const{setModalContent:s,clearModal:n}=N.useContext(T),{client:o,setClient:r}=N.useContext(M),i=JSON.parse(e.prompt_query||"{}"),c=!!Object.keys(i).length,l=fe({resolver:it(ta),defaultValues:c?{step_0:{products:i.step_0.products||""},step_1:{payment_methods:i.step_1.payment_methods||"",order_tracking:i.step_1.order_tracking||"",tracking_link:i.step_1.tracking_link||""},step_2:{days_of_warranty:i.step_2.days_of_warranty||0,how_exchanges_work_and_returns:i.step_2.how_exchanges_work_and_returns||"",how_guarantee_work:i.step_2.how_guarantee_work||""},step_3:{address:i.step_3.address||"",company_name:i.step_3.company_name||"",contact_email:i.step_3.contact_email||"",contact_phone_number:i.step_3.contact_phone_number||"",support_hours:i.step_3.support_hours||""},step_4:{client_describe:i.step_4.client_describe||"",ia_name:i.step_4.ia_name||"",restrictions:i.step_4.restrictions}}:void 0}),d=async p=>{const m=JSON.stringify(p),f=aa(p),x={prompt_name:e.prompt_name,prompt:f,prompt_query:m,client_describe:p.step_4.client_describe};if(x){const _=await sa(x,e.id);_&&_.status===200&&(a(v=>[...v.filter(j=>j.id!==_.data.id),_.data]),s({componentName:"modal_updated_database",components:t.jsx(C,{message:"Database atualizado com sucesso",componentName:"modal_updated_database",functionAfterComplete:()=>n(null,{clearAll:!0})})}))}};async function u(){if(e.id){const p=await na(e.id);if((p==null?void 0:p.status)===200){a(f=>f.filter(x=>x.id!==p.data.id));const m=o==null?void 0:o.plan_management.prompt.findIndex(f=>f.id===e.id);o&&m&&(o.plan_management.prompt.splice(m,1),r(o)),s({componentName:"modal_delete_success",components:t.jsx(C,{message:"Fonte de dados excluido com sucesso!",componentName:"modal_delete_success",functionAfterComplete:()=>n(null,{clearAll:!0})})})}else(p==null?void 0:p.status)===500?s({componentName:"modal_failed_delete_database",components:t.jsx(C,{message:"Você não pode excluir uma fonte de dados que possui um chat vinculado a ela, tente excluir todos os chats primeiro, antes de excluir essa fonte de dados.",type:"ERROR",componentName:"modal_failed_delete_database"})}):s({componentName:"modal_failed_delete",components:t.jsx(C,{message:"Falha ao tentar excluir essa fonte de dados. Tente reiniciar a página e tentar de novo.",type:"ERROR",componentName:"modal_failed_delete"})})}}return t.jsx("div",{className:"w-[80vw] h-[70vh] flex overflow-auto hidden-scrollbar ",children:t.jsxs(g.EditForm,{form:l,onDelete:u,onSubmit:d,children:[t.jsx(g.EditStep,{index:0,titleStep:"Informações do produto",icon:t.jsx(Qt,{}),children:t.jsx(Yt,{})}),t.jsxs(g.EditStep,{index:1,titleStep:"Métodos de pagamento",icon:t.jsx(Wt,{}),children:[t.jsx(g.Container,{className:"flex gap-4",title:"Quais são os métodos de pagamentos aceitos?",children:t.jsx(g.Select,{title:"Escolha seus métodos de pagamentos",isMultiple:!0,name:"step_1.payment_methods",options:[{value:"Pix",text:"Pix"},{value:"Boleto",text:"Boleto"},{value:"Cartão de débito",text:"Cartão de débito"},{value:"Cartão de crédito",text:"Cartão de crédito"},{value:"Pagamentos em aplicativo",text:"Pagamentos em aplicativo"}]})}),t.jsx(g.TextArea,{name:"step_1.how_to_buy",title:"como comprar seu produto?"}),t.jsxs(g.Optional,{defaultField:"",name:"step_1.order_tracking",text:"Você está entregando um produto físico?",children:[t.jsx(g.TextArea,{name:"step_1.order_tracking",title:"Como os clientes podem rastrear seu pedido?"}),t.jsx(g.Optional,{defaultField:"",name:"step_1.tracking_link",text:"Você possui link para rastrear pedido?",children:t.jsx(g.Input,{title:"Digite a url do site:",name:"step_1.tracking_link",onChange:({target:p})=>{p.value.toLowerCase().includes("http")||(p.value=`https://${p.value.replace("http","")}`)}})})]})]}),t.jsxs(g.EditStep,{index:2,titleStep:"Politicas e condições",icon:t.jsx(Zt,{}),children:[t.jsx(g.Input,{type:"number",name:"step_2.days_of_warranty",title:"Quantos dias o cliente tem de garantia?"}),t.jsx(g.TextArea,{name:"step_2.how_guarantee_work",title:"Como funciona a garantia?"}),t.jsx(g.Optional,{defaultField:"",name:"step_2.how_exchanges_work_and_returns",text:"Esse produto/serviço possui troca ou devolução?",children:t.jsx(g.TextArea,{name:"step_2.how_exchanges_work_and_returns",title:"Como funciona as trocas e devoluções?"})})]}),t.jsxs(g.EditStep,{index:3,titleStep:"Sobre a empresa",icon:t.jsx(Xt,{}),children:[t.jsx(g.Container,{className:"flex gap-4",children:t.jsx(g.Input,{name:"step_3.company_name",title:"Qual o nome da empresa?"})}),t.jsx(g.Input,{name:"step_3.address",title:"Qual o endereço da sua empresa?"}),t.jsxs(g.Container,{className:"flex gap-4",children:[t.jsx(g.Input,{name:"step_3.contact_email",title:"Digite um e-mail para contato"}),t.jsx(g.Input,{title:"Digite um telefone para contato",name:"step_3.contact_phone_number",onChange:({target:p})=>{const m=p.value.replace(/[^\d]/g,"");if(m.length<11){let f;m.length===11?f=m.replace(/^(\d{2})(\d{1})(\d{4})(\d{4})$/,"($1) $2 $3-$4"):f=m.replace(/^(\d{2})(\d{4})(\d{4})$/,"($1) $2-$3"),p.value=f}else p.value=p.value.substring(0,15)}})]}),t.jsx(g.Input,{name:"step_3.support_hours",title:"Qual seu horário para suporte humano?"})]}),t.jsxs(g.EditStep,{index:4,titleStep:"Personalidade da IA ",icon:t.jsx(ea,{}),children:[t.jsx(g.Optional,{defaultField:"",name:"step_4.ia_name",text:"Deseja dar um nome a sua inteligência artificial?",children:t.jsx(g.Input,{name:"step_4.ia_name",title:"Qual o nome da sua inteligência artificial?"})}),t.jsx(g.Optional,{defaultField:"",text:"Deseja adicionar restrições de palavras ou frase?",name:"step_4.restrictions",children:t.jsx(g.Input,{name:"step_4.restrictions",title:"Faça uma lista de restrições para que a IA evite utiliza-la em uma conversa"})}),t.jsx(g.TextArea,{title:"Faça uma breve descrição de quem é seu público (cliente)",name:"step_4.client_describe"})]})]})})}function Ls(){var l;const{client:e}=N.useContext(M),{setModalContent:a,clearModal:s}=N.useContext(T),n=Array(oa).fill(0),[o,r]=N.useState(((l=e==null?void 0:e.plan_management)==null?void 0:l.prompt)||[]),i=d=>{o!=null&&o.length&&a({componentName:"modal_create_database",components:t.jsx(L,{children:t.jsx(Bs,{prompt:o[d],setPrompts:r})})})},c=d=>{async function u(p){p.preventDefault();const m=p.target.querySelector("input").value,f=o[d].id;if(m){const x=await la(m,f);(x==null?void 0:x.status)===200&&(r([...o,o[d].prompt_name=m]),a({componentName:"modal_saved",components:t.jsx(C,{message:"Nome da sua base de dados foi atualizado com sucesso!",componentName:"modal_saved",functionAfterComplete:()=>s(null,{clearAll:!0})})}))}}a({componentName:"modal_edit_name",components:t.jsx(L,{children:t.jsxs("div",{className:"flex flex-col justify-center items-center gap-4",children:[t.jsx("h2",{children:"Digite o novo nome da sua fonte de dados:"}),t.jsxs("form",{onSubmit:u,className:"flex flex-col justify-center items-center gap-4",children:[t.jsx("input",{placeholder:"Ex: Minha nova base de dados",name:"database_name",defaultValue:o[d].prompt_name}),t.jsx(I,{type:"button",children:"Salvar"})]})]})})})};return e&&t.jsx(X,{title:"Fonte de dados",children:t.jsx("div",{className:"w-full flex-wrap flex justify-center p-4 my-12 gap-8",children:n.map((d,u)=>{var p,m,f,x,_;return(p=e.plan_management)!=null&&p.plan&&u<Number(e.plan_management.plan.max_databases.default)?t.jsx("div",{"data-prompt":!!((m=o[u])!=null&&m.prompt_name),className:"flex justify-center items-center rounded-xl cursor-pointer border border-primary-100 bg-primary-100 dark:bg-primary-300 hover:bg-primary-200 text-light dark:text-primary-100 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20 z-50",children:(f=o[u])!=null&&f.prompt_name?t.jsxs("div",{className:"w-[300px] flex gap-2 items-center justify-center",children:[t.jsxs("h2",{className:"w-[200px] text-center py-4 flex justify-center items-center gap-2",onClick:()=>i(u),children:[t.jsx(ra,{}),t.jsx("span",{className:"w-full whitespace-nowrap text-ellipsis overflow-x-hidden",children:(x=o[u])==null?void 0:x.prompt_name})]}),t.jsx(ia,{className:"cursor-text ",onClick:()=>c(u)})]}):t.jsx(se,{title:"Vamos criar sua primeira fonte de dados",text:"Clique em <span class='font-medium text-2xl mx-1'>+</span> para criar sua primeira fonte de dados.",position:"BOTTOM",hidden:u!==1,children:t.jsx(P,{tip:"Criar fonte de dados",children:t.jsx(Rs,{plan_management_id:e.plan_management.id})})})},u):t.jsx("div",{"data-prompt":!!((_=o[u])!=null&&_.prompt_name),className:"flex opacity-30 cursor-not-allowed justify-center items-center rounded-xl border border-primary-100 bg-primary-300 hover:bg-primary-200 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20",children:t.jsx(ae,{className:"w-[300px] py-3 text-5xl"})},u)})})})}function Fs({chats:e,setIndex:a}){const s=n=>{a(n)};return t.jsx("div",{className:"w-[300px] h-full overflow-auto flex flex-col border-r border-light/40",children:e==null?void 0:e.map((n,o)=>!!n.messages.length&&t.jsxs("div",{className:"w-full cursor-pointer hover:bg-primary-200 transition-colors p-4 border border-primary-100/20",onClick:()=>s(o),children:[t.jsx("h2",{className:"whitespace-nowrap text-ellipsis overflow-hidden py-1 text-xl font-bold",children:n.messages.length>1?n.messages[1].message.replace("<br/>",""):`Chat ${o.toString().padStart(2,"0")}`},n.messages.join()),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"italic text-xs",children:[n.messages.length," messagens"]}),t.jsx("span",{className:"italic text-xs",children:J(n.messages[n.messages.length-1].time).dateFormat_A})]})]},n.id))})}function Os({chats:e,index:a}){var r;const{client:s}=N.useContext(M),[n,o]=N.useState();return N.useEffect(()=>{var i,c;if(e.length){const l=(i=s==null?void 0:s.plan_management.project.find(u=>e&&u.id===e[a].project_id))==null?void 0:i.logo,d=(c=s==null?void 0:s.plan_management.project.find(u=>e&&u.id===e[a].project_id))==null?void 0:c.project_name;l&&d&&o({logoChat:l,projectName:d})}},[]),n&&t.jsx("div",{className:"w-full h-full flex flex-col",children:t.jsxs("div",{className:"w-full h-full flex flex-col gap-4",children:[t.jsxs("div",{className:"w-full h-[60px] flex items-center px-4 bg-primary-100",children:[t.jsx("div",{className:"w-[50px] h-[50px] overflow-hidden rounded-full",children:t.jsx("img",{src:n==null?void 0:n.logoChat,alt:"logo do cliente",className:"w-full h-full object-cover"})}),t.jsx("p",{className:"px-4 text-xl text-light dark:text-primary-100",children:n==null?void 0:n.projectName})]}),t.jsx("div",{className:"w-full h-full p-4 flex flex-col gap-4 overflow-auto",children:(r=e[a])!=null&&r.messages?e[a].messages.map((i,c)=>t.jsx("div",{"data-player":i.player,className:"w-full flex data-[player='1']:justify-end justify-start",children:t.jsxs("div",{"data-player":i.player,className:"bg-primary-100/50 dark:bg-light text-black/80 data-[player='1']:bg-primary-100 dark:data-[player='1']:bg-primary-200 data-[player='1']:text-light p-2 rounded-xl max-w-md",children:[t.jsx("h2",{className:"",dangerouslySetInnerHTML:{__html:i.message}}),t.jsx("span",{className:"w-full flex justify-end text-xs italic",children:J(i.time).shortHour})]})},c)):t.jsx("h2",{className:"w-full h-[200px] flex justify-center items-center",children:"Ainda não existe nenhuma conversa para esse chat"})})]})})}function Us(){var u;const{client:e}=N.useContext(M),[a,s]=Z(),[n,o]=N.useState(0),[r,i]=N.useState([]),c=(u=e==null?void 0:e.plan_management)==null?void 0:u.project.map(p=>Object({id:p.project_name.replace(" ","_"),name:p.project_name}));N.useEffect(()=>{const p=a.get("filter_time_chats"),m=a.get("project");if(e&&c!=null&&c.length){let f;m?f=e.plan_management.project.filter(_=>_.project_name.replace(" ","_")===m&&_):f=e.plan_management.project;const x=f.map(_=>_.chat.filter(j=>Number(p)?z(j.created_at)<=Number(p):!0)).flat();i(x)}},[a]);const l=({target:p})=>{const m=p.selectedIndex,f=p.options[m].value,x=new URLSearchParams(a);x.set("project",f),s(x)},d=async({currentTarget:p})=>{if(e!=null&&e.plan_management){const m=p.querySelector("svg");m.classList.add("rotate-[-360deg]","transition-transform","duration-1000");const f=setTimeout(()=>{m.classList.remove("rotate-[-360deg]","transition-transform","duration-1000"),clearTimeout(f)},1e3)}};return t.jsxs(X,{title:"Registros",className:"px-8",children:[t.jsxs("div",{className:"w-full flex gap-8 h-[40px]",children:[t.jsx(P,{tip:"Selecione uma data  como filtro",children:t.jsx(ct,{typeFilter:"filter_time_chats"})}),t.jsx(P,{tip:"Selecione um chat",children:t.jsx(lt,{options:c||[],Icon:ca,handleSelectDatabase:l})}),t.jsx(P,{tip:"Atualize seus chats",children:t.jsx("div",{className:"p-2 bg-light dark:bg-gray border border-primary-100 rounded-md cursor-pointer",onClick:d,children:t.jsx(qe,{className:"text-xl"})})})]}),t.jsxs("div",{className:"w-full h-3/4 flex bg-light dark:bg-gray my-4 overflow-hidden",children:[t.jsx(Fs,{chats:r,setIndex:o}),!!r.length&&t.jsx(Os,{chats:r,index:n})]})]})}function zs({plan_management:e}){return t.jsxs("div",{className:"w-full flex flex-col items-center",children:[t.jsx("h2",{className:"text-xl p-2",children:"Historico de transações"}),t.jsx("div",{className:"w-full max-w-[1000px] p-4",children:e?t.jsxs("div",{className:"w-full flex flex-col rounded-md",children:[t.jsxs("div",{className:"w-full flex p-4 justify-between bg-primary-100/20 border border-primary-100 rounded-md",children:[t.jsx("span",{className:"text-center",children:"Plano"}),t.jsx("span",{className:"text-center",children:"Transação"}),t.jsx("span",{className:"text-center",children:"Data e hora"}),t.jsx("span",{className:"text-center",children:"Valor do plano"}),t.jsx("span",{className:"text-center",children:"Método de pagamento"}),t.jsx("span",{className:"text-center",children:"Status"})]}),e.trasaction.map((a,s)=>t.jsxs("div",{className:"w-full flex px-4 justify-between border border-zinc-500/20",children:[t.jsx("span",{className:"text-center",children:e.plan.plan_name}),t.jsx("span",{className:"text-center",children:a.transaction_describe==="PAYMENT"?"Pagamento":a.transaction_describe==="REFUND_REQUEST"?"Reembolso solicitado":a.transaction_describe==="SUBSCRIPTION_CANCELLATION"?"Plano cancelado":"Reembolso cancelado"}),t.jsx("span",{className:"text-center",children:J(a.created_at).dateFormat_A}),t.jsxs("span",{className:"text-center",children:["R$",Number(a.amount_paid).toFixed(2).replace(".",",")]}),t.jsx("span",{className:"text-center",children:a.payment_method}),t.jsx("span",{className:"text-center",children:a.status==="APPROVED"?"Aprovado":a.status==="REJECT"?"Recusado":"Pendente"})]},s))]}):t.jsx("h2",{className:"text-zinc-500",children:"Você ainda não efetuou nenhum pagamento"})})]})}function $s({plan_management:e}){return e&&e.status!=="DISABLED"?t.jsx("span",{className:"font-bold text-yellow-600 uppercase",children:e.plan.plan_name}):t.jsx("span",{className:"text-zinc-400/60",children:"Sem plano"})}function dt(e){const o=(new Date(e)-new Date)/(1e3*60*60*24);return Number(o.toFixed(0))}function qs({plan_management:e}){const a=()=>e?dt(e.free_trial):0;return e&&e.status!=="DISABLED"&&t.jsxs("div",{className:"w-full flex flex-col items-center",children:[t.jsxs("span",{children:["Status:",t.jsx("span",{"data-status":e.status,className:"px-1 rounded-md mx-2 bg-red-200 text-red-700 data-[status='ACTIVE']:bg-green-200 data-[status='ACTIVE']:text-green-700",children:e.status==="ACTIVE"?"Ativo":"Desativado"})]}),t.jsxs("span",{children:["Chats: ",e.project.length," / ",Number(e.plan.max_projects.default)]}),t.jsxs("span",{children:["Fonte de dados: ",e.prompt.length," / ",Number(e.plan.max_databases.default)]}),t.jsxs("span",{children:["Análise de métrica diária:  ",Number(e.plan.max_analyze_metric.default)," "]}),t.jsxs("span",{children:["Limite de messages: ",ga(e).totalMessages," / ",Number(e.plan.max_messages.default)," "]}),t.jsxs("span",{"data-free":Number(e.plan.monthly_price)<=0,className:"data-[free=true]:hidden",children:["Reembolso garantido: ",a()>0?a()+" dias restantes":"expirado"]})]})}function Vs({client:e}){const a=ue(),s=()=>{a("/plans")};return(e!=null&&e.refund_requested.length&&e.refund_requested[0].status!=="PENDING",!0)&&t.jsx("div",{className:"w-full flex flex-col my-4 justify-center items-center",children:t.jsx(I,{onClick:s,children:((e==null?void 0:e.plan_management)&&e.plan_management.status)!=="DISABLED"?Number(e==null?void 0:e.plan_management.plan.monthly_price)>0?"Mudar de plano":"Contratar plano":"Adicionar plano"})})}async function Hs(e){return await H.post(`${G}/refund_requested`,e).catch(s=>console.log(s))}async function Gs(e){return await H.post(`${G}/refund_requested/reactive`,{client_id:e}).catch(s=>console.log(s))}function Js({client:e}){const{setModalContent:a}=N.useContext(T),s=()=>e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0?dt(e==null?void 0:e.plan_management.free_trial):0,n=async()=>{if(e){const c=prompt("Digite o motivo do seu cancelamento:"),l=prompt("Digite de 0 a 5, o quanto você gostou do nosso sistema"),d={client_id:e.id,reason:c||"",product_review:Number(l||0)};await Hs(d)?(a({componentName:"modal_request_success",components:t.jsx(C,{message:"Solicitação de reembolso foi enviada com sucesso!",componentName:"modal_request_success"})}),setTimeout(()=>window.location.reload(),1e3)):a({componentName:"modal_error_request",components:t.jsx(C,{message:"Ocorreu um erro ao enviar sua solicitação de reembolso, por favor entre em contato com nosso suporte.",componentName:"modal_error_request"})})}else a({componentName:"modal_error_client",components:t.jsx(C,{message:"Erro ao processar o cliente, por favor recarregue a página.",componentName:"modal_error_client"})})},o=()=>{if(e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0)return e!=null&&e.refund_requested.length&&e.plan_management.status==="ACTIVE"&&s()>0?e.refund_requested[0].status!=="PENDING":s()>0&&e.plan_management.status!=="DISABLED"},r=()=>{e?window.open(`https://dash.ticto.com.br/subscription-verification?code=${e==null?void 0:e.ticto_order_code}&email=${e==null?void 0:e.purchase_email}`):a({componentName:"modal_failed_cancel",components:t.jsx(C,{message:"Falha ao preencher os dados de cancelamento, por favor entre em contato com o suporte.",componentName:"modal_failed_cancel"})})},i=()=>{if(e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0&&e.plan_management.status==="ACTIVE"&&s()<=0)return!!(e.refund_requested.length&&e.refund_requested[0].status!=="PENDING")};return o()?t.jsx("div",{className:"w-full flex justify-center",children:t.jsx("a",{onClick:n,className:"text-center underline cursor-pointer",children:"Pedir reembolso"})}):i()&&t.jsx("div",{className:"w-full flex justify-center",children:t.jsx("a",{onClick:r,className:"text-center underline cursor-pointer",children:"Gerenciar assinatura"})})}function Ks({client:e}){return t.jsxs("div",{className:"w-1/2 min-w-[300px] max-w-[400px] border border-zinc-600 p-2 rounded-md z-50",children:[t.jsx("h2",{className:"w-full text-center",children:"Plano atual:"}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx($s,{plan_management:e==null?void 0:e.plan_management})}),t.jsx("div",{className:"w-full flex justify-center my-4",children:t.jsx(qs,{plan_management:e==null?void 0:e.plan_management})}),t.jsx(Vs,{client:e}),t.jsx(Js,{client:e})]})}function Qs({client:e}){const{setModalContent:a}=N.useContext(T),s=async()=>{e&&await Gs(e.id)&&(a({componentName:"modal_reactive_plan",components:t.jsx(C,{message:"Plano reativado com  sucesso!",componentName:"modal_reactive_plan"})}),setTimeout(()=>window.location.reload(),1500))};return!!(e!=null&&e.refund_requested.length)&&e.refund_requested[0].status!=="CANCEL"&&t.jsxs("div",{className:"w-1/2 min-w-[150px] max-w-[400px] border border-zinc-600 p-2 rounded-md",children:[t.jsx("h2",{className:"w-full text-center pb-4 text-xl",children:"Reembolso solicitado:"}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Reembolso solicidado em:",t.jsx("p",{children:e.refund_requested[0].created_at.substring(0,10)})]}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Plano:",t.jsx("p",{children:e.plan_management.plan.plan_name})]}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Status:",e.refund_requested[0].status==="PENDING"?t.jsx("p",{className:"text-red-600",children:"Pendente"}):e.refund_requested[0].status==="APPROVED"?t.jsx("p",{className:"text-green-600",children:"Dinheiro devolvido"}):t.jsx("p",{className:"text-zinc-200",children:"Reembolso cancelado"})]}),t.jsx("div",{className:"w-full flex justify-center mt-6",children:e.refund_requested[0].status==="PENDING"&&t.jsx(I,{onClick:s,children:"Cancelar reembolso"})})]})}function Ys(){const{client:e}=N.useContext(M);return t.jsxs(X,{title:"Assinatura",className:"flex-col",children:[t.jsxs("div",{className:"w-full flex justify-center",children:[t.jsx(Ks,{client:e}),t.jsx(Qs,{client:e})]}),t.jsx(zs,{plan_management:e==null?void 0:e.plan_management})]})}function Ce({name:e}){const{register:a}=me(),[s,n]=N.useState(!1),o=()=>n(r=>!r);return t.jsxs("div",{className:"w-3/5 px-2 rounded-md flex justify-center items-center gap-2 bg-gray_light",children:[t.jsx("input",{className:"",type:s?"text":"password",...a(e)}),t.jsx(da,{"data-isopen":!!s,className:"text-2xl data-[isopen=false]:hidden",onClick:o}),t.jsx(ua,{"data-isopen":!!s,className:"text-2xl data-[isopen=true]:hidden",onClick:o})]})}function Ws(){const{setValue:e}=me(),a=fe(),{handleSubmit:s}=a,{client:n}=N.useContext(M),{setModalContent:o,clearModal:r}=N.useContext(T),i=async c=>{if(!n)throw new Error("Client not founded.");if(c.new_password.length<8||c.current_password.length<8){const u=!c.new_password.length||!c.current_password.length?"Preencha todos os dados":"Informe uma senha com mais de 8 caracteres";o({componentName:"modal_error_fill_data",components:t.jsx(C,{message:u,componentName:"modal_error_fill_data",type:"WARNING"})});return}if(c.new_password!==c.confirm_password){o({componentName:"modal_error_new_password",components:t.jsx(C,{message:"Sua confirmação de senha não é idêntica a sua nova senha!",componentName:"modal_error_new_password",type:"ERROR"})});return}c.client_id=n.id;const l=await ma(c);l||o({componentName:"modal_error_password",components:t.jsx(C,{message:"A sua atual senha está incorreta!",componentName:"modal_error_password",type:"ERROR"})}),(l==null?void 0:l.status)===200&&(e("password",c.new_password),o({componentName:"modal_change_password_success",components:t.jsx(C,{message:"Senha atualizada com sucesso!",componentName:"modal_change_password_success",functionAfterComplete:()=>r(null,{clearLast:!0})})}))};return t.jsx(ve,{...a,children:t.jsxs("form",{className:"flex min-w-[200px] flex-col gap-8",onSubmit:s(i),children:[t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Sua senha atual:"}),t.jsx(Ce,{name:"current_password"})]}),t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Nova senha:"}),t.jsx(Ce,{name:"new_password"})]}),t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Confirme sua senha:"}),t.jsx(Ce,{name:"confirm_password"})]}),t.jsxs(I,{customClass:"flex items-center gap-2",children:[t.jsx(Ve,{})," Salvar"]})]})})}const Zs=ee.object({fullname:ee.string().min(1,"Digite seu nome completo!").refine(e=>{const a=e.split(" ");return!!(a.length>=2&&a[1])},"Vocẽ precisa informar seu nome completo"),user:ee.string().min(1,"Digite um nome de usuário!").max(25,"Nome de usuário muito longe, informe um menor."),email:ee.string().email(),password:ee.string().min(8,"Sua senha precisa ter no minimo 8 caracteres!")});function Xs(){const{setModalContent:e}=N.useContext(T),{client:a,setClient:s}=N.useContext(M),n=fe({resolver:fa(Zs),defaultValues:{fullname:a==null?void 0:a.fullname,user:a==null?void 0:a.user,email:a==null?void 0:a.email,password:"senha-qualquer"}}),{handleSubmit:o,formState:{errors:r}}=n;N.useEffect(()=>{const u=i(r);u&&e({componentName:"modal_error_message",components:t.jsx(C,{message:u,type:"WARNING",componentName:"modal_error_message"})})},[r]);const i=u=>{if(typeof u=="object"&&pa!==null)for(let p in u){if(p==="message")return u[p];{const m=i(u[p]);if(m!==void 0)return m}}},c=async u=>{if((a==null?void 0:a.user)===u.user||await ha(u.user)){u.client_id=a==null?void 0:a.id;const p=await xa(u);(p==null?void 0:p.status)===200&&(s(p.data),e({componentName:"modal_user_success",components:t.jsx(C,{componentName:"modal_user_success",message:"Perfil atualizado com sucesso"})}))}else e({componentName:"modal_error_user",components:t.jsx(C,{componentName:"modal_error_user",message:"Usuário informado não está disponível!",type:"WARNING"})})},l=()=>{e({componentName:"modal_show_password",components:t.jsx(L,{children:t.jsx(ve,{...n,children:t.jsx(Ws,{})})})})},d=()=>{e({componentName:"modal_show_email",components:t.jsx(C,{componentName:"modal_show_email",message:"Ainda não é possível atualizar o e-mail, para mais informações entre em contato com o suporte.",type:"WARNING"})})};return t.jsx(X,{title:"Configurações",children:t.jsx(ve,{...n,children:t.jsxs("form",{onSubmit:o(c),className:"w-2/3 mx-auto p-4 px-8 flex flex-col gap-6",children:[t.jsxs(g.Container,{className:"flex items-center gap-4",children:[t.jsx(g.Input,{name:"fullname",title:"Nome completo"}),t.jsx(g.Input,{name:"user",title:"Usuário"})]}),t.jsxs(g.Container,{className:"flex gap-4 justify-center items-center",children:[t.jsx(g.Container,{children:t.jsx(g.Input,{type:"email",name:"email",title:"Informe seu e-mail",disabled:!0})}),t.jsxs(I,{type:"button",customClass:"min-w-[200px] flex justify-center items-center gap-2",onClick:d,children:["Alterar e-mail",t.jsx(ae,{})]})]}),t.jsxs(g.Container,{className:"flex gap-4 justify-center items-center",children:[t.jsx(g.Container,{children:t.jsx(g.Input,{type:"password",name:"password",title:"Sua senha",disabled:!0})}),t.jsxs(I,{type:"button",customClass:"min-w-[200px] flex justify-center items-center gap-2",onClick:l,children:["Alterar senha",t.jsx(ae,{})]})]}),t.jsxs(I,{customClass:"flex gap-2 mt-8",children:["Salvar ",t.jsx(Ve,{})]})]})})})}function en(){const[e]=Z(),a=Number(e.get("tab"))||0;return t.jsx("div",{className:"w-full px-8",children:a===0?t.jsx(ws,{}):a===1?t.jsx(Ps,{}):a===2?t.jsx(Ls,{}):a===3?t.jsx(Us,{}):a===4?t.jsx(Ys,{}):t.jsx(Xs,{})})}function sn(){return t.jsxs("div",{className:"w-[90%] h-full flex-grow flex flex-col items-center bg-gradient-to-br from-primary-100 from-[10%] to-light to-[20%] dark:to-dark",children:[t.jsx(ba,{}),t.jsx(en,{})]})}export{sn as default};
