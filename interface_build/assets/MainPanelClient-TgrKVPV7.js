import{r as g,M as A,j as t,B as M,e as z,A as O,C as T,F as It,f as et,g as Mt,h as kt,d as D,P as j,T as k,i as Pt,k as Rt,m as Dt,n as Bt,o as tt,b as Q,p as Lt,q as De,t as at,s as Ft,v as We,w as zt,x as Ot,y as Ut,z as qt,I as V,D as xe,E as H,G as Je,R as E,H as $t,J as Gt,K as Ht,N as Vt,O as Z,Q as X,S as Wt,U as Jt,V as Kt,W as Yt,X as Qt,Y as st,Z as Xt,$ as Zt,a0 as ea,a1 as ta,a2 as aa,a3 as sa,a4 as na,a5 as Be,a6 as Le,a7 as oa,a8 as Fe,a9 as ra,aa as ia,ab as la,ac as nt,ad as ca,ae as da,af as ma,ag as ua,ah as fa,ai as pa,aj as ha,ak as xa,al as ga,am as _a,an as ya,ao as Na,ap as wa,aq as ja,ar as ba,as as ze,at as Ca,au as va,av as je,aw as Sa,ax as Ea,ay as Aa,az as Ie,aA as be,aB as ot,aC as Ta,aD as oe,aE as Oe,aF as Ia,aG as Ma,u as ka,aH as G,aI as Y,aJ as Pa,aK as Ra,aL as Da,aM as Ba,aN as La,aO as Fa,aP as rt,aQ as it,aR as lt,aS as za,aT as Oa,aU as Ua,aV as qa,aW as $a,aX as Ga,aY as ct,aZ as Ha}from"./index-jADdpKL0.js";import{c as $}from"./Panel-uKcuLnfB.js";import{G as Va,m as Wa}from"./messagesEventManager-lohKIuMz.js";const Ja=[{short:"Jan",complete:"Janeiro"},{short:"Fev",complete:"Fevereiro"},{short:"Mar",complete:"Março"},{short:"Abr",complete:"Abril"},{short:"Mai",complete:"Maio"},{short:"Jun",complete:"Junho"},{short:"Jul",complete:"Julho"},{short:"Ago",complete:"Agosto"},{short:"Set",complete:"Setembro"},{short:"Out",complete:"Outubro"},{short:"Nov",complete:"Novembro"},{short:"Dez",complete:"Dezembro"}];function B(e=new Date){const a=new Date(e);a.toLocaleTimeString("pt-BR",{hour12:!1});const s=a.getTimezoneOffset(),n=a.getMonth(),r=a.getUTCHours()-s/60,o=a.toLocaleDateString(),i=`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`,l=`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`,c=`${a.getDay()} de ${Ja[n].short} - ${l}`,d=+`${a.getFullYear()}${(n+1).toString().padStart(2,"0")}${a.getDate().toString().padStart(2,"0")}${a.getHours().toString().padStart(2,"0")}${a.getMinutes().toString().padStart(2,"0")}${a.getMilliseconds()}`;return{currentHour:r,fullDate:o,fullHour:i,shortHour:l,dateFormat_A:c,fullDateWithHour:`${o} - ${i}`,dateTransformNumber:d}}function Ka({notification:e,setDisplayNotification:a}){const{clearModal:s}=g.useContext(A),n=()=>{a(!1)};return t.jsxs("div",{className:"w-screen flex flex-col justify-start md:justify-center items-center min-h-screen md:min-h-0 md:min-w-[500px] md:max-w-[80vw] gap-4 relative p-4",children:[t.jsx("h2",{className:"w-full text-2xl text-center font-bold py-6",children:e.notification.title}),t.jsx("p",{dangerouslySetInnerHTML:{__html:e.notification.describe},className:"max-h-[70vh] overflow-auto"}),t.jsxs("div",{className:"flex p-4 gap-8 items-center ",children:[t.jsx("span",{className:"underline opacity-80 cursor-pointer",onClick:()=>s(null,{clearLast:!0}),children:"Fechar"}),!!e.notification.code&&t.jsx(M,{onClick:n,children:e.notification.cta_text})]})]})}async function Ya(e){return await z.post(`${O}/notification/${e}/read`).catch(s=>console.warn(s))}async function Qa(e){return await z.post(`${O}/notification/${e}/all_read`).catch(s=>console.warn(s))}function Xa(){const{client:e}=g.useContext(T),{setModalContent:a}=g.useContext(A),[s,n]=g.useState(),[r,o]=g.useState(),i=r==null?void 0:r.filter(d=>!d.read);g.useEffect(()=>{var m;const d=(m=e==null?void 0:e.notification_client)==null?void 0:m.sort((p,f)=>!p.read&&f.read?-1:p.read&&!f.read?1:0);o(d)},[]);const l=async d=>{const m=await Ya(d.id);(m==null?void 0:m.status)===200&&(o(p=>{if(p){const f=p.filter(h=>h.id!==d.id),u=p.find(h=>h.id===d.id);if(u)return u.read=!0,f.push(u),f}}),a({componentName:"modal_display_notification",components:t.jsx(D,{children:t.jsx(Ka,{notification:d,setDisplayNotification:n})})}))},c=async()=>{if(!e)return;await Qa(e.id)?o(m=>{if(m)return m.map(p=>(p.read=!0,p))}):a({componentName:"modal_failed_marked_read_notification",components:t.jsx(j,{componentName:"modal_failed_marked_read_notification",type:"WARNING",message:"Não foi possível marcar todas as notificações como lida, por favor tente mais tarde!"})})};return t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"bg-primary-100 border border-light/50 rounded-full p-1",onClick:()=>n(d=>!d),children:[t.jsx("span",{"data-isnotification":!!(i!=null&&i.length),className:"w-[20px] h-[20px] data-[isnotification=false]:hidden flex justify-center items-center text-xs bg-red-800 border border-primary-300 rounded-full absolute -top-[10px] -right-[10px]",children:i==null?void 0:i.length}),t.jsx(It,{className:"text-2xl fill-light cursor-pointer"})]}),t.jsxs("div",{"data-display":!!s,className:"w-full h-screen md:h-auto md:min-w-[400px] data-[display=false]:hidden flex flex-col fixed md:absolute z-50 md:rounded-md bg-primary-100 p-4 top-0 md:top-auto right-0 md:translate-x-[122px] md:my-2",children:[t.jsx(et,{className:" text-4xl absolute top-2 right-3  md:hidden",onClick:()=>n(d=>!d)}),t.jsxs("div",{className:"w-full flex justify-between items-center border-b border-white/30 my-8 md:my-0",children:[t.jsx("h2",{className:"text-xl font-bold text-light",children:"Notificações"}),t.jsx(M,{onClick:c,children:"Marcar todas como lida"})]}),t.jsx("div",{className:"w-full flex flex-col  md:max-h-[300px] overflow-auto",children:r!=null&&r.length?r==null?void 0:r.map(d=>t.jsxs("div",{className:"flex gap-4 items-center min-h-[60px] border-b border-white/30 hover:bg-primary-200/50 transition-colors cursor-pointer",onClick:()=>l(d),children:[t.jsx("div",{className:"min-w-1/3",children:d.read?t.jsx(Mt,{className:"text-2xl fill-zinc-300"}):t.jsx(kt,{className:"text-2xl fill-orange-400"})}),t.jsxs("div",{"data-isread":!!d.read,className:"flex flex-col data-[isread=true]:opacity-60 text-light",children:[t.jsx("h2",{className:"font-medium text-lg",children:d.notification.title}),t.jsxs("div",{className:"flex gap-2 items-end px-2",children:[t.jsx("p",{className:"w-2/3 line-clamp-1 opacity-90",dangerouslySetInnerHTML:{__html:d.notification.describe}}),t.jsx("span",{className:"text-xs opacity-70",children:B(d.notification.created_at).dateFormat_A})]})]})]},d.id)):t.jsx("h2",{className:"w-full text-center py-4",children:"Você ainda não recebeu nenhuma notificação!"})})]})]})}function Za(){g.useEffect(()=>{const a=localStorage.theme==="dark";document.documentElement.classList.toggle("dark",a)},[]);const e=()=>{const a=localStorage.theme==="dark";document.documentElement.classList.toggle("dark",!a);const s=a?"light":"dark";localStorage.theme=s};return t.jsxs("div",{className:"flex gap-3 px-8",children:[t.jsx(k,{tip:"Notificações",positionY:"BOTTOM",positionX:"LEFT",children:t.jsx(Xa,{})}),t.jsx(k,{tip:"Escolha entre thema light ou dark",positionY:"BOTTOM",positionX:"LEFT",children:t.jsxs("div",{className:"bg-primary-100 border border-light/50 rounded-full p-1",onClick:e,children:[t.jsx(Pt,{className:"text-2xl fill-light cursor-pointer hidden dark:block"}),t.jsx(Rt,{className:"text-2xl fill-light cursor-pointer block dark:hidden"})]})})]})}function es(){return t.jsxs("header",{className:"w-full h-[8%] px-0 md:px-20 min-h-[70px] col-span-8 row-span-1 flex justify-between md:justify-end items-center md:bg-transparent",children:[t.jsx(Dt,{urlParamName:"menu_mobile",className:"md:hidden"}),t.jsx(Za,{})]})}function ie({children:e,title:a,text:s,positionY:n="BOTTOM",positionX:r="CENTER",hidden:o}){const i=g.useRef(null),{client:l,setClient:c}=g.useContext(T),d=async()=>{if(l){const m=await tt(l.id,!1);c(m)}};return l&&t.jsxs("div",{className:"flex items-center relative group",children:[t.jsx("div",{"data-active":l.tutorial,"data-hidden":o,className:"data-[hidden=true]:hidden data-[active=false]:hidden w-screen h-screen backdrop-blur-sm fixed top-0 left-0 z-40"}),t.jsxs("div",{"data-active":l.tutorial,ref:i,"data-positiony":n,"data-positionx":r,"data-hidden":o,className:`max-w-[70vw] border border-light/40 bg-primary-100 p-1 rounded-xl absolute z-40 
                    data-[positiony=TOP]:-top-full data-[positiony=TOP]:-translate-y-3 data-[positiony=BOTTOM]:-bottom-full data-[positiony=BOTTOM]:translate-y-[90%]
                    data-[positionx=RIGHT]:left-4/5 data-[positionx=CENTER]:left-1/2 data-[positionx=CENTER]:-translate-x-1/2 data-[positionx=LEFT]:right-0
                    text-center transition-opacity data-[hidden=true]:hidden data-[active=false]:hidden`,children:[t.jsxs("div",{className:"bg-primary-100 rounded-md flex flex-col justify-center items-center px-4",children:[t.jsx("h2",{className:"text-center py-2 font-bold text-xl text-light",children:a}),t.jsx("p",{className:"w-[70vw] md:w-[400px] px-4 text-center text-light text-lg",dangerouslySetInnerHTML:{__html:s}}),t.jsx("div",{className:"w-full flex justify-center mt-8 text-light text-base",children:t.jsx("span",{className:"underline opacity-70 cursor-pointer",onClick:d,children:"Pular tutorial"})})]}),t.jsx(Bt,{"data-positiony":n,"data-positionx":r,className:`border-light/40 fill-primary-100 absolute 
                        data-[positiony='BOTTOM']:top-0 data-[positiony='BOTTOM']:-translate-y-[78%] data-[positiony='BOTTOM']:rotate-180
                        data-[positionx='LEFT']:right-2 data-[positionx='CENTER']:left-1/2 data-[positionx=CENTER]:-translate-x-1/2
                        `})]}),t.jsx("div",{"data-hidden":o,className:"z-40 data-[hidden=true]:z-0",children:e})]})}function ts({plan_management_id:e,projects:a,index:s}){const{client:n}=g.useContext(T),{setModalContent:r,clearModal:o}=g.useContext(A),i=Q(),l=()=>{if(n!=null&&n.plan_management)if(n!=null&&n.plan_management.artificial_intelligence.length){const c=Number(n.plan_management.plan.max_projects.default),d=n.plan_management.project.length;n.plan_management.status!=="DISABLED"?c>d?i(`/create-chat/${e}`):r({componentName:"modal_reached_max_plan",components:t.jsx(j,{message:"Você atingiu o número maximo de chats por plano.",componentName:"modal_reached_max_plan"})}):r({componentName:"modal_plan_is_desabled",components:t.jsx(j,{message:"O plano da sua conta está desabilitado.",componentName:"modal_plan_is_desabled",functionAfterComplete:()=>i("/panel?tab=4")})})}else r({componentName:"modal_create_database",components:t.jsx(D,{children:t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 p-4",children:[t.jsxs("h2",{className:"text-xl text-center",children:["Para criar um novo chat, antes é necessário ",t.jsx("br",{}),"  criar uma inteligência artificial."]}),t.jsxs("h2",{className:"text-lg text-center opacity-80",children:["Ela será capaz de aprender sobre seu negócio e ",t.jsx("br",{}),"dar informações precisas ao usuário sem que você precise realizar ",t.jsx("br",{}),"esse atendimento."]}),t.jsxs(M,{customClass:"my-4",onClick:()=>{i("/panel?tab=artificial_intelligence"),o("modal_create_database")},children:[t.jsx(De,{}),"Criar Inteligência artificial"]})]})})});else r({componentName:"modal_without_plan",components:t.jsx(j,{message:"Nenhum plano foi vinculado a sua conta",componentName:"modal_without_plan",functionAfterComplete:()=>i("/panel?tab=4")})})};return t.jsx("div",{onClick:l,className:"w-4/5 xs:w-1/2 md:w-1/4 min-w-[200px] min-h-[200px] cursor-pointer flex justify-center items-center",children:t.jsx(ie,{title:"Vamos criar seu primeiro chat",text:'Clique em <span class="text-3xl font-medium mx-1">+</span> para criar seu primeiro chat de forma simples e fácil',positionX:window.innerWidth>=800?"RIGHT":"CENTER",hidden:s!==0||a.length!==0,children:t.jsx(k,{tip:"Crie um novo chat",children:t.jsx(Lt,{className:"text-6xl text-light dark:text-primary-100"})})})})}function J({children:e,title:a,className:s}){return t.jsxs("div",{className:at("w-full md:min-h-[70vh] flex flex-col gap-4 justify-start items-start bg-light dark:bg-dark rounded-xl border border-primary-100 dark:border-primary-300 relative ",s),children:[t.jsx("h2",{className:"w-full text-primary-100 dark:text-light text-2xl font-semibold uppercase p-4 px-8",children:a}),e]})}var ce={},as=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},dt={},L={};let Ue;const ss=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];L.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17};L.getSymbolTotalCodewords=function(a){return ss[a]};L.getBCHDigit=function(e){let a=0;for(;e!==0;)a++,e>>>=1;return a};L.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');Ue=a};L.isKanjiModeEnabled=function(){return typeof Ue<"u"};L.toSJIS=function(a){return Ue(a)};var ge={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function a(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,r){if(e.isValid(n))return n;try{return a(n)}catch{return r}}})(ge);function mt(){this.buffer=[],this.length=0}mt.prototype={get:function(e){const a=Math.floor(e/8);return(this.buffer[a]>>>7-e%8&1)===1},put:function(e,a){for(let s=0;s<a;s++)this.putBit((e>>>a-s-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),e&&(this.buffer[a]|=128>>>this.length%8),this.length++}};var ns=mt;function de(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}de.prototype.set=function(e,a,s,n){const r=e*this.size+a;this.data[r]=s,n&&(this.reservedBit[r]=!0)};de.prototype.get=function(e,a){return this.data[e*this.size+a]};de.prototype.xor=function(e,a,s){this.data[e*this.size+a]^=s};de.prototype.isReserved=function(e,a){return this.reservedBit[e*this.size+a]};var os=de,ut={};(function(e){const a=L.getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const r=Math.floor(n/7)+2,o=a(n),i=o===145?26:Math.ceil((o-13)/(2*r-2))*2,l=[o-7];for(let c=1;c<r-1;c++)l[c]=l[c-1]-i;return l.push(6),l.reverse()},e.getPositions=function(n){const r=[],o=e.getRowColCoords(n),i=o.length;for(let l=0;l<i;l++)for(let c=0;c<i;c++)l===0&&c===0||l===0&&c===i-1||l===i-1&&c===0||r.push([o[l],o[c]]);return r}})(ut);var ft={};const rs=L.getSymbolSize,Ke=7;ft.getPositions=function(a){const s=rs(a);return[[0,0],[s-Ke,0],[0,s-Ke]]};var pt={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};e.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},e.from=function(r){return e.isValid(r)?parseInt(r,10):void 0},e.getPenaltyN1=function(r){const o=r.size;let i=0,l=0,c=0,d=null,m=null;for(let p=0;p<o;p++){l=c=0,d=m=null;for(let f=0;f<o;f++){let u=r.get(p,f);u===d?l++:(l>=5&&(i+=a.N1+(l-5)),d=u,l=1),u=r.get(f,p),u===m?c++:(c>=5&&(i+=a.N1+(c-5)),m=u,c=1)}l>=5&&(i+=a.N1+(l-5)),c>=5&&(i+=a.N1+(c-5))}return i},e.getPenaltyN2=function(r){const o=r.size;let i=0;for(let l=0;l<o-1;l++)for(let c=0;c<o-1;c++){const d=r.get(l,c)+r.get(l,c+1)+r.get(l+1,c)+r.get(l+1,c+1);(d===4||d===0)&&i++}return i*a.N2},e.getPenaltyN3=function(r){const o=r.size;let i=0,l=0,c=0;for(let d=0;d<o;d++){l=c=0;for(let m=0;m<o;m++)l=l<<1&2047|r.get(d,m),m>=10&&(l===1488||l===93)&&i++,c=c<<1&2047|r.get(m,d),m>=10&&(c===1488||c===93)&&i++}return i*a.N3},e.getPenaltyN4=function(r){let o=0;const i=r.data.length;for(let c=0;c<i;c++)o+=r.data[c];return Math.abs(Math.ceil(o*100/i/5)-10)*a.N4};function s(n,r,o){switch(n){case e.Patterns.PATTERN000:return(r+o)%2===0;case e.Patterns.PATTERN001:return r%2===0;case e.Patterns.PATTERN010:return o%3===0;case e.Patterns.PATTERN011:return(r+o)%3===0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(o/3))%2===0;case e.Patterns.PATTERN101:return r*o%2+r*o%3===0;case e.Patterns.PATTERN110:return(r*o%2+r*o%3)%2===0;case e.Patterns.PATTERN111:return(r*o%3+(r+o)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(r,o){const i=o.size;for(let l=0;l<i;l++)for(let c=0;c<i;c++)o.isReserved(c,l)||o.xor(c,l,s(r,c,l))},e.getBestMask=function(r,o){const i=Object.keys(e.Patterns).length;let l=0,c=1/0;for(let d=0;d<i;d++){o(d),e.applyMask(d,r);const m=e.getPenaltyN1(r)+e.getPenaltyN2(r)+e.getPenaltyN3(r)+e.getPenaltyN4(r);e.applyMask(d,r),m<c&&(c=m,l=d)}return l}})(pt);var _e={};const W=ge,me=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ue=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];_e.getBlocksCount=function(a,s){switch(s){case W.L:return me[(a-1)*4+0];case W.M:return me[(a-1)*4+1];case W.Q:return me[(a-1)*4+2];case W.H:return me[(a-1)*4+3];default:return}};_e.getTotalCodewordsCount=function(a,s){switch(s){case W.L:return ue[(a-1)*4+0];case W.M:return ue[(a-1)*4+1];case W.Q:return ue[(a-1)*4+2];case W.H:return ue[(a-1)*4+3];default:return}};var ht={},ye={};const re=new Uint8Array(512),pe=new Uint8Array(256);(function(){let a=1;for(let s=0;s<255;s++)re[s]=a,pe[a]=s,a<<=1,a&256&&(a^=285);for(let s=255;s<512;s++)re[s]=re[s-255]})();ye.log=function(a){if(a<1)throw new Error("log("+a+")");return pe[a]};ye.exp=function(a){return re[a]};ye.mul=function(a,s){return a===0||s===0?0:re[pe[a]+pe[s]]};(function(e){const a=ye;e.mul=function(n,r){const o=new Uint8Array(n.length+r.length-1);for(let i=0;i<n.length;i++)for(let l=0;l<r.length;l++)o[i+l]^=a.mul(n[i],r[l]);return o},e.mod=function(n,r){let o=new Uint8Array(n);for(;o.length-r.length>=0;){const i=o[0];for(let c=0;c<r.length;c++)o[c]^=a.mul(r[c],i);let l=0;for(;l<o.length&&o[l]===0;)l++;o=o.slice(l)}return o},e.generateECPolynomial=function(n){let r=new Uint8Array([1]);for(let o=0;o<n;o++)r=e.mul(r,new Uint8Array([1,a.exp(o)]));return r}})(ht);const xt=ht;function qe(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}qe.prototype.initialize=function(a){this.degree=a,this.genPoly=xt.generateECPolynomial(this.degree)};qe.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(a.length+this.degree);s.set(a);const n=xt.mod(s,this.genPoly),r=this.degree-n.length;if(r>0){const o=new Uint8Array(this.degree);return o.set(n,r),o}return n};var is=qe,gt={},K={},$e={};$e.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40};var U={};const _t="[0-9]+",ls="[A-Z $%*+\\-./:]+";let le="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";le=le.replace(/u/g,"\\u");const cs="(?:(?![A-Z0-9 $%*+\\-./:]|"+le+`)(?:.|[\r
]))+`;U.KANJI=new RegExp(le,"g");U.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");U.BYTE=new RegExp(cs,"g");U.NUMERIC=new RegExp(_t,"g");U.ALPHANUMERIC=new RegExp(ls,"g");const ds=new RegExp("^"+le+"$"),ms=new RegExp("^"+_t+"$"),us=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");U.testKanji=function(a){return ds.test(a)};U.testNumeric=function(a){return ms.test(a)};U.testAlphanumeric=function(a){return us.test(a)};(function(e){const a=$e,s=U;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(o,i){if(!o.ccBits)throw new Error("Invalid mode: "+o);if(!a.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?o.ccBits[0]:i<27?o.ccBits[1]:o.ccBits[2]},e.getBestModeForData=function(o){return s.testNumeric(o)?e.NUMERIC:s.testAlphanumeric(o)?e.ALPHANUMERIC:s.testKanji(o)?e.KANJI:e.BYTE},e.toString=function(o){if(o&&o.id)return o.id;throw new Error("Invalid mode")},e.isValid=function(o){return o&&o.bit&&o.ccBits};function n(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+r)}}e.from=function(o,i){if(e.isValid(o))return o;try{return n(o)}catch{return i}}})(K);(function(e){const a=L,s=_e,n=ge,r=K,o=$e,i=7973,l=a.getBCHDigit(i);function c(f,u,h){for(let x=1;x<=40;x++)if(u<=e.getCapacity(x,h,f))return x}function d(f,u){return r.getCharCountIndicator(f,u)+4}function m(f,u){let h=0;return f.forEach(function(x){const N=d(x.mode,u);h+=N+x.getBitsLength()}),h}function p(f,u){for(let h=1;h<=40;h++)if(m(f,h)<=e.getCapacity(h,u,r.MIXED))return h}e.from=function(u,h){return o.isValid(u)?parseInt(u,10):h},e.getCapacity=function(u,h,x){if(!o.isValid(u))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=r.BYTE);const N=a.getSymbolTotalCodewords(u),_=s.getTotalCodewordsCount(u,h),b=(N-_)*8;if(x===r.MIXED)return b;const w=b-d(x,u);switch(x){case r.NUMERIC:return Math.floor(w/10*3);case r.ALPHANUMERIC:return Math.floor(w/11*2);case r.KANJI:return Math.floor(w/13);case r.BYTE:default:return Math.floor(w/8)}},e.getBestVersionForData=function(u,h){let x;const N=n.from(h,n.M);if(Array.isArray(u)){if(u.length>1)return p(u,N);if(u.length===0)return 1;x=u[0]}else x=u;return c(x.mode,x.getLength(),N)},e.getEncodedBits=function(u){if(!o.isValid(u)||u<7)throw new Error("Invalid QR Code version");let h=u<<12;for(;a.getBCHDigit(h)-l>=0;)h^=i<<a.getBCHDigit(h)-l;return u<<12|h}})(gt);var yt={};const Me=L,Nt=1335,fs=21522,Ye=Me.getBCHDigit(Nt);yt.getEncodedBits=function(a,s){const n=a.bit<<3|s;let r=n<<10;for(;Me.getBCHDigit(r)-Ye>=0;)r^=Nt<<Me.getBCHDigit(r)-Ye;return(n<<10|r)^fs};var wt={};const ps=K;function ee(e){this.mode=ps.NUMERIC,this.data=e.toString()}ee.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)};ee.prototype.getLength=function(){return this.data.length};ee.prototype.getBitsLength=function(){return ee.getBitsLength(this.data.length)};ee.prototype.write=function(a){let s,n,r;for(s=0;s+3<=this.data.length;s+=3)n=this.data.substr(s,3),r=parseInt(n,10),a.put(r,10);const o=this.data.length-s;o>0&&(n=this.data.substr(s),r=parseInt(n,10),a.put(r,o*3+1))};var hs=ee;const xs=K,Ce=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function te(e){this.mode=xs.ALPHANUMERIC,this.data=e}te.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)};te.prototype.getLength=function(){return this.data.length};te.prototype.getBitsLength=function(){return te.getBitsLength(this.data.length)};te.prototype.write=function(a){let s;for(s=0;s+2<=this.data.length;s+=2){let n=Ce.indexOf(this.data[s])*45;n+=Ce.indexOf(this.data[s+1]),a.put(n,11)}this.data.length%2&&a.put(Ce.indexOf(this.data[s]),6)};var gs=te,_s=function(a){for(var s=[],n=a.length,r=0;r<n;r++){var o=a.charCodeAt(r);if(o>=55296&&o<=56319&&n>r+1){var i=a.charCodeAt(r+1);i>=56320&&i<=57343&&(o=(o-55296)*1024+i-56320+65536,r+=1)}if(o<128){s.push(o);continue}if(o<2048){s.push(o>>6|192),s.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){s.push(o>>12|224),s.push(o>>6&63|128),s.push(o&63|128);continue}if(o>=65536&&o<=1114111){s.push(o>>18|240),s.push(o>>12&63|128),s.push(o>>6&63|128),s.push(o&63|128);continue}s.push(239,191,189)}return new Uint8Array(s).buffer};const ys=_s,Ns=K;function ae(e){this.mode=Ns.BYTE,typeof e=="string"&&(e=ys(e)),this.data=new Uint8Array(e)}ae.getBitsLength=function(a){return a*8};ae.prototype.getLength=function(){return this.data.length};ae.prototype.getBitsLength=function(){return ae.getBitsLength(this.data.length)};ae.prototype.write=function(e){for(let a=0,s=this.data.length;a<s;a++)e.put(this.data[a],8)};var ws=ae;const js=K,bs=L;function se(e){this.mode=js.KANJI,this.data=e}se.getBitsLength=function(a){return a*13};se.prototype.getLength=function(){return this.data.length};se.prototype.getBitsLength=function(){return se.getBitsLength(this.data.length)};se.prototype.write=function(e){let a;for(a=0;a<this.data.length;a++){let s=bs.toSJIS(this.data[a]);if(s>=33088&&s<=40956)s-=33088;else if(s>=57408&&s<=60351)s-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);s=(s>>>8&255)*192+(s&255),e.put(s,13)}};var Cs=se,jt={exports:{}};(function(e){var a={single_source_shortest_paths:function(s,n,r){var o={},i={};i[n]=0;var l=a.PriorityQueue.make();l.push(n,0);for(var c,d,m,p,f,u,h,x,N;!l.empty();){c=l.pop(),d=c.value,p=c.cost,f=s[d]||{};for(m in f)f.hasOwnProperty(m)&&(u=f[m],h=p+u,x=i[m],N=typeof i[m]>"u",(N||x>h)&&(i[m]=h,l.push(m,h),o[m]=d))}if(typeof r<"u"&&typeof i[r]>"u"){var _=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(_)}return o},extract_shortest_path_from_predecessor_list:function(s,n){for(var r=[],o=n;o;)r.push(o),s[o],o=s[o];return r.reverse(),r},find_path:function(s,n,r){var o=a.single_source_shortest_paths(s,n,r);return a.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(s){var n=a.PriorityQueue,r={},o;s=s||{};for(o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);return r.queue=[],r.sorter=s.sorter||n.default_sorter,r},default_sorter:function(s,n){return s.cost-n.cost},push:function(s,n){var r={value:s,cost:n};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=a})(jt);var vs=jt.exports;(function(e){const a=K,s=hs,n=gs,r=ws,o=Cs,i=U,l=L,c=vs;function d(_){return unescape(encodeURIComponent(_)).length}function m(_,b,w){const y=[];let v;for(;(v=_.exec(w))!==null;)y.push({data:v[0],index:v.index,mode:b,length:v[0].length});return y}function p(_){const b=m(i.NUMERIC,a.NUMERIC,_),w=m(i.ALPHANUMERIC,a.ALPHANUMERIC,_);let y,v;return l.isKanjiModeEnabled()?(y=m(i.BYTE,a.BYTE,_),v=m(i.KANJI,a.KANJI,_)):(y=m(i.BYTE_KANJI,a.BYTE,_),v=[]),b.concat(w,y,v).sort(function(S,P){return S.index-P.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function f(_,b){switch(b){case a.NUMERIC:return s.getBitsLength(_);case a.ALPHANUMERIC:return n.getBitsLength(_);case a.KANJI:return o.getBitsLength(_);case a.BYTE:return r.getBitsLength(_)}}function u(_){return _.reduce(function(b,w){const y=b.length-1>=0?b[b.length-1]:null;return y&&y.mode===w.mode?(b[b.length-1].data+=w.data,b):(b.push(w),b)},[])}function h(_){const b=[];for(let w=0;w<_.length;w++){const y=_[w];switch(y.mode){case a.NUMERIC:b.push([y,{data:y.data,mode:a.ALPHANUMERIC,length:y.length},{data:y.data,mode:a.BYTE,length:y.length}]);break;case a.ALPHANUMERIC:b.push([y,{data:y.data,mode:a.BYTE,length:y.length}]);break;case a.KANJI:b.push([y,{data:y.data,mode:a.BYTE,length:d(y.data)}]);break;case a.BYTE:b.push([{data:y.data,mode:a.BYTE,length:d(y.data)}])}}return b}function x(_,b){const w={},y={start:{}};let v=["start"];for(let C=0;C<_.length;C++){const S=_[C],P=[];for(let I=0;I<S.length;I++){const R=S[I],ne=""+C+I;P.push(ne),w[ne]={node:R,lastCount:0},y[ne]={};for(let we=0;we<v.length;we++){const q=v[we];w[q]&&w[q].node.mode===R.mode?(y[q][ne]=f(w[q].lastCount+R.length,R.mode)-f(w[q].lastCount,R.mode),w[q].lastCount+=R.length):(w[q]&&(w[q].lastCount=R.length),y[q][ne]=f(R.length,R.mode)+4+a.getCharCountIndicator(R.mode,b))}}v=P}for(let C=0;C<v.length;C++)y[v[C]].end=0;return{map:y,table:w}}function N(_,b){let w;const y=a.getBestModeForData(_);if(w=a.from(b,y),w!==a.BYTE&&w.bit<y.bit)throw new Error('"'+_+'" cannot be encoded with mode '+a.toString(w)+`.
 Suggested mode is: `+a.toString(y));switch(w===a.KANJI&&!l.isKanjiModeEnabled()&&(w=a.BYTE),w){case a.NUMERIC:return new s(_);case a.ALPHANUMERIC:return new n(_);case a.KANJI:return new o(_);case a.BYTE:return new r(_)}}e.fromArray=function(b){return b.reduce(function(w,y){return typeof y=="string"?w.push(N(y,null)):y.data&&w.push(N(y.data,y.mode)),w},[])},e.fromString=function(b,w){const y=p(b,l.isKanjiModeEnabled()),v=h(y),C=x(v,w),S=c.find_path(C.map,"start","end"),P=[];for(let I=1;I<S.length-1;I++)P.push(C.table[S[I]].node);return e.fromArray(u(P))},e.rawSplit=function(b){return e.fromArray(p(b,l.isKanjiModeEnabled()))}})(wt);const Ne=L,ve=ge,Ss=ns,Es=os,As=ut,Ts=ft,ke=pt,Pe=_e,Is=is,he=gt,Ms=yt,ks=K,Se=wt;function Ps(e,a){const s=e.size,n=Ts.getPositions(a);for(let r=0;r<n.length;r++){const o=n[r][0],i=n[r][1];for(let l=-1;l<=7;l++)if(!(o+l<=-1||s<=o+l))for(let c=-1;c<=7;c++)i+c<=-1||s<=i+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?e.set(o+l,i+c,!0,!0):e.set(o+l,i+c,!1,!0))}}function Rs(e){const a=e.size;for(let s=8;s<a-8;s++){const n=s%2===0;e.set(s,6,n,!0),e.set(6,s,n,!0)}}function Ds(e,a){const s=As.getPositions(a);for(let n=0;n<s.length;n++){const r=s[n][0],o=s[n][1];for(let i=-2;i<=2;i++)for(let l=-2;l<=2;l++)i===-2||i===2||l===-2||l===2||i===0&&l===0?e.set(r+i,o+l,!0,!0):e.set(r+i,o+l,!1,!0)}}function Bs(e,a){const s=e.size,n=he.getEncodedBits(a);let r,o,i;for(let l=0;l<18;l++)r=Math.floor(l/3),o=l%3+s-8-3,i=(n>>l&1)===1,e.set(r,o,i,!0),e.set(o,r,i,!0)}function Ee(e,a,s){const n=e.size,r=Ms.getEncodedBits(a,s);let o,i;for(o=0;o<15;o++)i=(r>>o&1)===1,o<6?e.set(o,8,i,!0):o<8?e.set(o+1,8,i,!0):e.set(n-15+o,8,i,!0),o<8?e.set(8,n-o-1,i,!0):o<9?e.set(8,15-o-1+1,i,!0):e.set(8,15-o-1,i,!0);e.set(n-8,8,1,!0)}function Ls(e,a){const s=e.size;let n=-1,r=s-1,o=7,i=0;for(let l=s-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!e.isReserved(r,l-c)){let d=!1;i<a.length&&(d=(a[i]>>>o&1)===1),e.set(r,l-c,d),o--,o===-1&&(i++,o=7)}if(r+=n,r<0||s<=r){r-=n,n=-n;break}}}function Fs(e,a,s){const n=new Ss;s.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),ks.getCharCountIndicator(c.mode,e)),c.write(n)});const r=Ne.getSymbolTotalCodewords(e),o=Pe.getTotalCodewordsCount(e,a),i=(r-o)*8;for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(i-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return zs(n,e,a)}function zs(e,a,s){const n=Ne.getSymbolTotalCodewords(a),r=Pe.getTotalCodewordsCount(a,s),o=n-r,i=Pe.getBlocksCount(a,s),l=n%i,c=i-l,d=Math.floor(n/i),m=Math.floor(o/i),p=m+1,f=d-m,u=new Is(f);let h=0;const x=new Array(i),N=new Array(i);let _=0;const b=new Uint8Array(e.buffer);for(let S=0;S<i;S++){const P=S<c?m:p;x[S]=b.slice(h,h+P),N[S]=u.encode(x[S]),h+=P,_=Math.max(_,P)}const w=new Uint8Array(n);let y=0,v,C;for(v=0;v<_;v++)for(C=0;C<i;C++)v<x[C].length&&(w[y++]=x[C][v]);for(v=0;v<f;v++)for(C=0;C<i;C++)w[y++]=N[C][v];return w}function Os(e,a,s,n){let r;if(Array.isArray(e))r=Se.fromArray(e);else if(typeof e=="string"){let d=a;if(!d){const m=Se.rawSplit(e);d=he.getBestVersionForData(m,s)}r=Se.fromString(e,d||40)}else throw new Error("Invalid data");const o=he.getBestVersionForData(r,s);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!a)a=o;else if(a<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);const i=Fs(a,s,r),l=Ne.getSymbolSize(a),c=new Es(l);return Ps(c,a),Rs(c),Ds(c,a),Ee(c,s,0),a>=7&&Bs(c,a),Ls(c,i),isNaN(n)&&(n=ke.getBestMask(c,Ee.bind(null,c,s))),ke.applyMask(n,c),Ee(c,s,n),{modules:c,version:a,errorCorrectionLevel:s,maskPattern:n,segments:r}}dt.create=function(a,s){if(typeof a>"u"||a==="")throw new Error("No input text");let n=ve.M,r,o;return typeof s<"u"&&(n=ve.from(s.errorCorrectionLevel,ve.M),r=he.from(s.version),o=ke.from(s.maskPattern),s.toSJISFunc&&Ne.setToSJISFunction(s.toSJISFunc)),Os(a,r,n,o)};var bt={},Ge={};(function(e){function a(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let n=s.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+s);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(o){return[o,o]}))),n.length===6&&n.push("F","F");const r=parseInt(n.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const r=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,o=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:o,scale:o?4:i,margin:r,color:{dark:a(n.color.dark||"#000000ff"),light:a(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,r){return r.width&&r.width>=n+r.margin*2?r.width/(n+r.margin*2):r.scale},e.getImageWidth=function(n,r){const o=e.getScale(n,r);return Math.floor((n+r.margin*2)*o)},e.qrToImageData=function(n,r,o){const i=r.modules.size,l=r.modules.data,c=e.getScale(i,o),d=Math.floor((i+o.margin*2)*c),m=o.margin*c,p=[o.color.light,o.color.dark];for(let f=0;f<d;f++)for(let u=0;u<d;u++){let h=(f*d+u)*4,x=o.color.light;if(f>=m&&u>=m&&f<d-m&&u<d-m){const N=Math.floor((f-m)/c),_=Math.floor((u-m)/c);x=p[l[N*i+_]?1:0]}n[h++]=x.r,n[h++]=x.g,n[h++]=x.b,n[h]=x.a}}})(Ge);(function(e){const a=Ge;function s(r,o,i){r.clearRect(0,0,o.width,o.height),o.style||(o.style={}),o.height=i,o.width=i,o.style.height=i+"px",o.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(o,i,l){let c=l,d=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(d=n()),c=a.getOptions(c);const m=a.getImageWidth(o.modules.size,c),p=d.getContext("2d"),f=p.createImageData(m,m);return a.qrToImageData(f.data,o,c),s(p,d,m),p.putImageData(f,0,0),d},e.renderToDataURL=function(o,i,l){let c=l;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const d=e.render(o,i,c),m=c.type||"image/png",p=c.rendererOpts||{};return d.toDataURL(m,p.quality)}})(bt);var Ct={};const Us=Ge;function Qe(e,a){const s=e.a/255,n=a+'="'+e.hex+'"';return s<1?n+" "+a+'-opacity="'+s.toFixed(2).slice(1)+'"':n}function Ae(e,a,s){let n=e+a;return typeof s<"u"&&(n+=" "+s),n}function qs(e,a,s){let n="",r=0,o=!1,i=0;for(let l=0;l<e.length;l++){const c=Math.floor(l%a),d=Math.floor(l/a);!c&&!o&&(o=!0),e[l]?(i++,l>0&&c>0&&e[l-1]||(n+=o?Ae("M",c+s,.5+d+s):Ae("m",r,0),r=0,o=!1),c+1<a&&e[l+1]||(n+=Ae("h",i),i=0)):r++}return n}Ct.render=function(a,s,n){const r=Us.getOptions(s),o=a.modules.size,i=a.modules.data,l=o+r.margin*2,c=r.color.light.a?"<path "+Qe(r.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+Qe(r.color.dark,"stroke")+' d="'+qs(i,o,r.margin)+'"/>',m='viewBox="0 0 '+l+" "+l+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(r.width?'width="'+r.width+'" height="'+r.width+'" ':"")+m+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,f),f};const $s=as,Re=dt,vt=bt,Gs=Ct;function He(e,a,s,n,r){const o=[].slice.call(arguments,1),i=o.length,l=typeof o[i-1]=="function";if(!l&&!$s())throw new Error("Callback required as last argument");if(l){if(i<2)throw new Error("Too few arguments provided");i===2?(r=s,s=a,a=n=void 0):i===3&&(a.getContext&&typeof r>"u"?(r=n,n=void 0):(r=n,n=s,s=a,a=void 0))}else{if(i<1)throw new Error("Too few arguments provided");return i===1?(s=a,a=n=void 0):i===2&&!a.getContext&&(n=s,s=a,a=void 0),new Promise(function(c,d){try{const m=Re.create(s,n);c(e(m,a,n))}catch(m){d(m)}})}try{const c=Re.create(s,n);r(null,e(c,a,n))}catch(c){r(c)}}ce.create=Re.create;ce.toCanvas=He.bind(null,vt.render);ce.toDataURL=He.bind(null,vt.renderToDataURL);ce.toString=He.bind(null,function(e,a,s){return Gs.render(e,s)});function Hs({text:e,width:a}){const s=g.useRef(null),n=localStorage.theme==="dark"?"#000":"#7672f2",r=localStorage.theme==="dark"?"#7672f2":"#fff";g.useEffect(()=>{s.current&&ce.toCanvas(s.current,e,{width:a,margin:1,color:{dark:n,light:r}},function(i){i&&console.error(i)})},[e,a]);const o=()=>{if(s.current){const i=s.current.toDataURL("image/png").replace("image/png","image/octet-stream"),l=document.createElement("a");l.download="qrcode.png",l.href=i,l.click()}};return t.jsxs("div",{className:"w-full flex justify-center",children:[t.jsx("div",{className:"w-4/5 flex justify-center",children:t.jsx("canvas",{ref:s})}),t.jsx("div",{className:"w-1/5 flex justify-center items-center gap-4",children:t.jsx(k,{tip:"Baixar imagem",children:t.jsx(Ft,{onClick:o,className:" text-2xl cursor-pointer"})})})]})}function Vs({slug:e}){const{setModalContent:a,clearModal:s}=g.useContext(A),n=g.useRef(null),r=g.useRef(null),o=()=>{s(null,{clearAll:!0}),window.open(`https://chat.wipzee.com/${e}`)},i=()=>{try{const d=n.current;if(d){d.classList.toggle("disabled"),d.disabled=!1,d.select();var c=document.execCommand("copy");c&&a({componentName:"modal_copy_link",components:t.jsx(j,{message:"Link Copiado!",type:"INFORMATION",componentName:"modal_copy_link"})}),d.classList.toggle("disabled"),d.disabled=!0}}catch{a({componentName:"modal_failed_copy_link",components:t.jsx(j,{message:"Falha ao copiar o link!",type:"ERROR",componentName:"modal_failed_copy_link"})})}},l=()=>{try{const d=r.current;if(d){d.classList.toggle("disabled"),d.disabled=!1,d.select();var c=document.execCommand("copy");c&&a({componentName:"modal_copy_widget",components:t.jsx(j,{message:"Widget Copiado!",type:"INFORMATION",componentName:"modal_copy_widget"})}),d.classList.toggle("disabled"),d.disabled=!0}}catch{a({componentName:"modal_failed_copy_widget",components:t.jsx(j,{message:"Falha ao copiar o link!",type:"ERROR",componentName:"modal_failed_copy_widget"})})}};return t.jsxs("div",{className:"w-full h-screen md:h-auto flex flex-col gap-8 relative md:static p-4",children:[t.jsx(et,{className:"text-4xl rotate-180 md:hidden absolute",onClick:()=>s(null,{clearLast:!0})}),t.jsxs("div",{className:"w-full flex flex-col gap-2 mt-12 md:mt-0",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"Link do seu chat"}),t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx("input",{ref:n,className:"w-4/5 border border-light/20 p-2 rounded-xl disabled",disabled:!0,defaultValue:`https://chat.wipzee.com/${e}`}),t.jsxs("div",{className:"flex justify-center items-center gap-4",children:[t.jsx(k,{tip:"Copie seu link",children:t.jsx(We,{onClick:i,className:" text-2xl cursor-pointer"})}),t.jsx(ie,{title:"Vamos abrir seu chat",text:"Clique no icone acima para abrir seu chat em uma nova guia para testa-lo",positionX:"LEFT",children:t.jsx(k,{tip:"Abra seu chat",children:t.jsx(zt,{onClick:o,className:" text-xl cursor-pointer"})})})]})]}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Esse será o link que você enviará aos usuários que irão acessar seu chat."})]}),t.jsxs("div",{className:"w-full flex flex-col gap-2",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"Código do Widget"}),t.jsxs("div",{className:"w-full flex justify-between",children:[t.jsx("input",{ref:r,className:"w-4/5 border border-light/20 p-2 rounded-xl disabled",disabled:!0,defaultValue:`<script src="https://widget.wipzee.com/${e}" defer><\/script>`}),t.jsx("div",{className:"w-1/5 flex justify-center items-center gap-4",children:t.jsx(We,{onClick:l,className:" text-2xl cursor-pointer"})})]}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Copie e cole esse código no head do html do seu site."})]}),t.jsxs("div",{className:"w-full flex flex-col gap-2",children:[t.jsx("h2",{className:"w-4/5 text-center uppercase",children:"QR CODE"}),t.jsx(Hs,{width:200,text:`https://chat.wipzee.com/${e}`}),t.jsx("span",{className:"w-4/5 text-center opacity-60",children:"Use esse QR CODE para acessar seu site facilmente"})]})]})}const Ws=e=>e.errors!=null,Js=(e,a)=>{const s={};for(;e.length;){const n=e[0],{code:r,message:o,path:i}=n,l=i.join(".");if(!s[l])if("unionErrors"in n){const c=n.unionErrors[0].errors[0];s[l]={message:c.message,type:c.code}}else s[l]={message:o,type:r};if("unionErrors"in n&&n.unionErrors.forEach(c=>c.errors.forEach(d=>e.push(d))),a){const c=s[l].types,d=c&&c[n.code];s[l]=qt(l,a,s,r,d?[].concat(d,n.message):n.message)}e.shift()}return s},St=(e,a,s={})=>async(n,r,o)=>{try{const i=await e[s.mode==="sync"?"parse":"parseAsync"](n,a);return o.shouldUseNativeValidation&&Ot({},o),{errors:{},values:s.raw?n:i}}catch(i){if(Ws(i))return{values:{},errors:Ut(Js(i.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw i}};function Ks({}){return t.jsx(V,{name:"facebook_pixel",title:"Adicione o pixel do seu facebook"})}function Te({title:e,joinAtInput:a,containerWidth:s,...n}){const{register:r,watch:o}=xe(),i=g.useRef(null);g.useEffect(()=>{if(i.current){const d=i.current.querySelector("label"),m=i.current.querySelector("input");m&&d&&m.value.length>0&&(d.classList.remove("top-0","opacity-50","cursor-text","py-2"),d.classList.add("top-0","-translate-y-1/2","bg-primary-100","text-sm"))}},[]);const l=({currentTarget:d})=>{const m=d.querySelector("label"),p=d.querySelector("input");m.classList.remove("top-0","opacity-50","cursor-text","py-2"),m.classList.add("top-0","-translate-y-1/2","bg-primary-100","text-sm"),p.focus()},c=({currentTarget:d})=>{const m=d.querySelector("label");d.querySelector("input").value.length<=0&&(m.classList.add("top-0","opacity-50","cursor-text","py-2"),m.classList.remove("top-0","-translate-y-1/2","bg-primary-100","text-sm"))};return t.jsxs("div",{className:at("w-full flex items-center gap-2 mt-8 relative",s),ref:i,onClick:l,onBlur:c,children:[t.jsx("label",{htmlFor:n.name,className:"w-[50px] h-[50px] rounded-full mx-2 border-2 border-white cursor-pointer",style:{background:o(n.name)}}),t.jsx("input",{type:"color",id:n.name,className:"cursor-pointer w-0 h-0 p-0 absolute left-1/3 -top-full",...r(n.name,{onChange:n.onChange}),...n})]})}function Ys({}){const[e,a]=H(),s=xe(),n=Number(e.get(Je))||0,r=o=>{e.set(Je,o.toString()),a(e),s.unregister("chat_appearance.chat_icon"),s.register("chat_appearance.chat_icon",{value:o})};return t.jsxs(E.Container,{className:"w-full flex flex-col items-center gap-8",children:[t.jsxs("div",{className:"flex flex-col justify-center gap-4",children:[t.jsx("h2",{className:"text-center text-xl",children:"Escolha um icone para seu chat"}),t.jsx("div",{className:"flex justify-center gap-2 md:gap-4 text-5xl",children:$t.map(({Icon:o,id:i},l)=>t.jsx(o,{"data-iscurrent":n-1===l,className:"hover:bg-primary-100 data-[iscurrent=true]:bg-primary-100 cursor-pointer rounded-full p-2",onClick:()=>r(i)},i))})]}),t.jsx(V,{name:"chat_appearance.icon_text",title:"Digite o texto que será exibido ao lado do icon"}),t.jsxs(E.Container,{className:"w-full flex",title:"Defina as cores do seu chat",children:[t.jsx(Te,{name:"chat_appearance.primary_color",title:"Escolha a cor primária do seu chat"}),t.jsx(Te,{name:"chat_appearance.second_color",title:"Escolha a cor secundária do seu chat"}),t.jsx(Te,{name:"chat_appearance.background",title:"Escolha a cor do background do seu chat"})]})]})}function Qs(){const{watch:e}=xe(),[a,s]=g.useState();return g.useEffect(()=>{const n=e("slug");s(n==null?void 0:n.replaceAll(" ","-"))},[e()]),t.jsxs("div",{className:"w-full md:w-full flex gap-2 items-center bg-white p-2 my-4 rounded-md",children:[t.jsx(Gt,{className:"fill-zinc-600"}),t.jsx(Ht,{className:"fill-zinc-600"}),t.jsx(Vt,{className:"fill-zinc-600"}),t.jsxs("div",{className:"w-4/5 md:w-full bg-zinc-600 rounded-xl p-3 flex gap-2 items-center",children:[t.jsx(Z,{className:"fill-green-600"}),t.jsxs("h2",{className:"w-[90%] md:w-full overflow-hidden whitespace-nowrap text-ellipsis text-sm xl:text-base opacity-80",children:["https://chat.wipzee.com/",a]})]})]})}function Xs({}){return t.jsxs(E.Container,{className:"flex flex-col items-center p-2",children:[t.jsx(V,{name:"slug",title:"Altere a slug do seu chat"}),t.jsx(Qs,{}),t.jsxs("div",{className:"w-4/5 md:w-auto flex flex-col items-center md:items-start",children:[t.jsx("span",{className:"font-medium uppercase",children:"Lembre-se"}),t.jsx("span",{className:"opacity-70 text-center md:text-left",children:"Ao trocar a slug do seu chat, todos seus clientes que possuirem a URL antiga, podem perder acesso ao seu chat utilizando a antiga URL."})]})]})}function Zs({project:e,setProjects:a,ai:s}){var m,p,f,u,h,x;const{setModalContent:n,clearModal:r}=g.useContext(A),{setClient:o,client:i}=g.useContext(T),l=X({resolver:St(Wt),defaultValues:{project_name:e.project_name,chat_input_message:e.chat_input_message,logo_id:((m=e==null?void 0:e.logo)==null?void 0:m.id)||"",artificial_intelligence_id:(e==null?void 0:e.artificial_intelligence_id)||"",bio:e.bio,links:e.links,facebook_pixel:e.pixel_facebook,chat_appearance:{chat_icon:(p=e.chat_appearance)==null?void 0:p.chat_icon,icon_text:(f=e.chat_appearance)==null?void 0:f.icon_text,primary_color:(u=e.chat_appearance)==null?void 0:u.primary_color,second_color:(h=e.chat_appearance)==null?void 0:h.second_color,background:(x=e.chat_appearance)==null?void 0:x.background},slug:e.slug}}),c=async N=>{var b;if(!N&&!e.slug)return;if(N.slug&&N.slug!==e.slug&&!await Yt(N.slug)){n({componentName:"modal_error_slug",components:t.jsx(j,{componentName:"modal_error_slug",message:"A slug escolhida não está disponível!",type:"WARNING"})});return}N.plan_management_id=e.plan_management_id,N.chat_appearance&&e.chat_appearance&&(N.chat_appearance.id=(b=e==null?void 0:e.chat_appearance)==null?void 0:b.id);const _=await Qt(N,e.slug);if(!_){n({componentName:"modal_failed_chat_updated",components:t.jsx(j,{message:"Falha ao tentar atualizar o chat, tente entrar em contato com o suporte.",componentName:"modal_failed_chat_updated",type:"WARNING"})});return}n({componentName:"modal_chat_updated",components:t.jsx(j,{message:"Chat atualizado com sucesso",componentName:"modal_chat_updated",functionAfterComplete:()=>{r("modal_edit_project"),a(w=>{const y=N,v=w.findIndex(S=>S.id===e.id),C=w.filter(S=>S.id!==e.id);return y.is_online=_.is_online,y.plan_management_id=_.plan_management_id,y.artificial_intelligence_id=_.artificial_intelligence_id,y.id=_.id,y.chat_appearance=_.chat_appearance,y.logo=_.logo,C.splice(v,0,y),C})}})})};async function d(){const N=async()=>{if(e.id){const _=await Xt(e.id);if(_&&_.status===200){a(w=>w.filter(y=>y.id!==e.id));const b=i==null?void 0:i.plan_management.project.findIndex(w=>w.id===e.id);i&&b&&(i.plan_management.project.splice(b,1),o(i)),n({componentName:"modal_delete_success",components:t.jsx(j,{message:"Chat excluido com sucesso!",componentName:"modal_delete_success",functionAfterComplete:()=>r(null,{clearAll:!0})})})}}};n({componentName:"modal_confirm_delete_chat",components:t.jsx(D,{children:t.jsx(st,{title:"Tem certeza que deseja deletar esse chat?",subTitle:"Uma vez removido, não pode ser revertido.",confirmFunction:N,cancelFuntion:()=>r("modal_confirm_delete_chat")})})})}return!!(s!=null&&s.length)&&!!i&&t.jsx("div",{className:"w-screen h-screen px-4 md:px-0 flex",children:t.jsxs(E.EditForm,{form:l,onDelete:d,onSubmit:c,activeSimulator:!0,children:[t.jsx(E.EditStep,{index:0,titleStep:"Informações do chat",children:t.jsx(Jt,{client_id:i.id,imageDefault:e.logo&&[e.logo]})}),t.jsx(E.EditStep,{index:1,titleStep:"Configurações do chat",children:t.jsx(Kt,{artificialInteligence:s,createChatForm:l})}),t.jsx(E.EditStep,{index:2,titleStep:"Eventos e rastreamentos",children:t.jsx(Ks,{})}),t.jsx(E.EditStep,{index:3,titleStep:"Aparência do chat",children:t.jsx(Ys,{})}),t.jsx(E.EditStep,{index:4,titleStep:"Configuração avançadas",children:t.jsx(Xs,{})})]})})}function en({project:e,setNewProject:a,ai:s}){var f;const{client:n,setClient:r}=g.useContext(T),{setModalContent:o}=g.useContext(A),i=Q(),[l,c]=H(),d=async()=>{if(l.get("tour")==="2"&&(l.set("tour","0"),c(l),n)){const u=await tt(n.id,!1);r(u)}o({componentName:"modal_edit_project",components:t.jsx(D,{positionModal:"START",children:t.jsx(Zs,{setProjects:a,project:e,ai:s})})})},m=async(u,h)=>{if(!h)return o({componentName:"modal_failed_updated_status_chat",components:t.jsx(j,{message:"Falha ao atualizar o status do chat, reinicie a página e tente novamente",componentName:"modal_failed_updated_status_chat",type:"WARNING"})}),!1;const x=await sa(u,h);return(x==null?void 0:x.status)===200?(a(N=>(N.find(_=>_.id===x.data.id).is_online=x.data.is_online,N)),!0):(o({componentName:"modal_failed_updated_status_chat_02",components:t.jsx(j,{message:"Falha ao atualizar o status do chat, reinicie a página e tente novamente",componentName:"modal_failed_updated_status_chat_02",type:"WARNING"})}),!1)},p=()=>{if(l.set("tour","2"),c(l),!e.slug){o({componentName:"modal_failed_display_link",components:t.jsx(j,{message:"Falha ao exibir seus links",type:"ERROR",componentName:"modal_failed_display_link"})});return}o({componentName:"modal_display_share_project",components:t.jsx(D,{positionModal:"START",children:t.jsx(Vs,{slug:e.slug})})})};return e&&t.jsxs("div",{className:"w-full text-light relative flex flex-col items-center gap-2 cursor-pointer rounded-xl",children:[t.jsxs("div",{className:"w-full flex justify-between items-center gap-2 p-2",children:[t.jsxs("div",{className:"flex justify-center gap-2",children:[t.jsx(ie,{title:"Vamos acessar seu chat",text:"Clique aqui em cima para obter seu link ou para pegar o código do widget",positionX:"RIGHT",hidden:l.get("tour")==="2"||l.get("tour")==="0",children:t.jsx(k,{tip:"Veja todos os seus links",children:t.jsx(Zt,{className:"text-xl",onClick:p})})}),t.jsx(ie,{title:"Vamos personalizar seu chat",text:"Agora que já viu como funciona, vamos conhecer como podemos deixar ele de acordo com a sua marca!",positionX:window.innerWidth>=768||window.innerWidth<=480?"RIGHT":"CENTER",hidden:l.get("tour")!=="2",children:t.jsx(k,{tip:"Edite seu chat",children:t.jsx(ea,{className:"text-xl",onClick:d})})})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(k,{tip:"Ative ou desative seu chat",children:t.jsx(ta,{isActive:e.is_online,template:"onOff",cb:u=>m(u,e.slug)})})})]}),t.jsx("div",{className:"w-[150px] h-[110px] rounded-xl overflow-hidden",children:t.jsx("img",{src:((f=e.logo)==null?void 0:f.url)||"https://via.placeholder.com/100",alt:"imagem do projeto",className:"w-full h-full object-cover",onClick:()=>window.open(`https://chat.wipzee.com/${e.slug}`)})}),t.jsxs("h2",{className:"text-center py-4 font-bold text-xl flex gap-2 items-center ",onClick:()=>i("/panel?tab=metrics"),children:[t.jsx(aa,{}),e.project_name]})]},e.slug)}function tn(){const{client:e}=g.useContext(T),{setModalContent:a}=g.useContext(A),[s,n]=g.useState(e!=null&&e.plan_management?e.plan_management.project:[]),r=Array(na).fill(0),o=()=>[a({componentName:"modal_locked_chat",components:t.jsx(j,{componentName:"modal_locked_chat",message:"Esse slot não está disponível, crie seu chat em um slot disponível ou contrate um plano com mais slot disponível.",type:"WARNING"})})];return e&&t.jsx(J,{title:"Meus chats",children:t.jsx("div",{className:"w-full flex-wrap flex justify-center p-4 gap-8",children:r.map((i,l)=>{var c,d,m,p;return(c=e.plan_management)!=null&&c.plan&&l<Number(e.plan_management.plan.max_projects.default)?t.jsx("div",{className:"w-[90%] xs:w-1/2 md:w-1/3 lg:w-1/4 md:max-w-[300px] flex justify-center items-center rounded-xl cursor-pointer border border-primary-100 bg-primary-50 dark:bg-primary-300 hover:bg-primary-200 text-light dark:text-primary-100 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20",children:(d=s[l])!=null&&d.id?t.jsx(en,{project:s[l],setNewProject:n,ai:(m=e.plan_management)==null?void 0:m.artificial_intelligence},s[l].id):t.jsx(ts,{plan_management_id:(p=e==null?void 0:e.plan_management)==null?void 0:p.id,projects:s,index:l})},l):t.jsx("div",{className:"w-[90%] xs:w-1/2 md:w-1/3 lg:w-1/4 min-h-[200px] md:max-w-[300px]  flex opacity-30 cursor-not-allowed justify-center items-center rounded-xl border border-primary-100 bg-primary-300 hover:bg-primary-200 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20",onClick:o,children:t.jsx(Z,{className:"py-3 text-5xl"})},l)})})})}function an({setColumns:e,columns:a,modalName:s}){const{clearModal:n}=g.useContext(A),[r,o]=g.useState(a),i=c=>{const d=c.currentTarget.dataset.status=="true",m=c.currentTarget.dataset.name;o(()=>[...a.filter((p,f)=>(f>1&&p.columnName===m&&(p.status=!d),p))])},l=()=>{localStorage.setItem("metricColumnActive",JSON.stringify(a)),e(a),n(s)};return t.jsxs("div",{className:"w-full md:w-1/2 bg-light dark:bg-zinc-800 text-dark dark:text-light",children:[t.jsx("h2",{className:"w-full text-center text-xl p-4",children:"Organize suas columns"}),t.jsx("div",{className:"w-full flex gap-2 flex-col",children:r.map((c,d)=>t.jsxs("div",{className:"w-full flex justify-between px-4",children:[t.jsx("p",{children:c.columnName}),t.jsx("div",{className:"flex gap-4",children:t.jsx("div",{className:"w-[30px] h-[20px] bg-zinc-400 dark:bg-zinc-100 flex overflow-hidden rounded-full cursor-pointer",style:{justifyContent:`${c.status?"end":"start"}`},onClick:i,"data-status":c.status,"data-name":c.columnName,children:t.jsx("div",{className:"w-2/3 h-full rounded-xl flex justify-center items-center",style:{background:`${c.status?"green":"red"}`},children:d<2&&t.jsx(Z,{className:"w-[8px]"})})})})]},c.columnName))}),t.jsxs("div",{className:"w-full flex mt-12 justify-evenly items-center",children:[t.jsx("span",{className:"underline opacity-80 cursor-pointer",onClick:()=>n(s),children:"Fechar"}),t.jsx(M,{onClick:l,children:"Salvar"})]})]})}function Ve({}){const[e,a]=H(),s=r=>{const o=B(new Date).currentHour;var i=0;switch(r){case"today":i=o;break;case"yesterday":i=o+24;break;case"last_7_days":i=o+6*24;break;case"last_14_days":i=o+13*24;break;case"last_month":i=o+29*24;break;case"last_3_month":i=o+89*24;break;case"last_6_month":i=o+179*24;break;case"last_year":i=o+364*24;break;default:i=0;break}e.set("filter_time",i.toString()),a(e)},n=()=>{e.delete("filter_time"),a(e)};return t.jsx(Be,{onSelected:s,onDelete:n,title:"Selecione uma data",name:"datetime",options:[{value:"today",text:"Hoje"},{value:"yesterday",text:"Ontem"},{value:"last_7_days",text:"Ultimos 7 dias"},{value:"last_14_days",text:"Ultimos 14 dias"},{value:"last_month",text:"Ultimo mês"},{value:"last_3_month",text:"Ultimos 3 meses"},{value:"last_6_month",text:"Ultimos 6 meses"},{value:"last_year",text:"Ultimo ano"}]})}function F(e,a=0){function s(){var u;return((u=e.metric)==null?void 0:u.chat_event.reduce((h,x)=>{const N=x.open_chat.filter(_=>{const b=$(_.created_at);return a>0?b<=a:!0});return h+N.length},0))||0}function n(){var h;return(((h=e.metric)==null?void 0:h.chat_event.filter(x=>{const N=$(x.created_at);return a>0?N<=a:!0}))||[]).filter((x,N,_)=>N===_.findIndex(b=>b.guest_id===x.guest_id)).length}function r(){return e.message_manager.map(u=>u.messages.filter(x=>{const N=$(x.time);return a>0?N<=a:!0})).flat().filter(u=>u.player==="user").length}function o(){return e.message_manager.map(u=>u.messages.filter(x=>{const N=$(x.time);return a>0?N<=a:!0})).flat().filter(u=>u.player==="assistant").length}function i(){const f=r()+o(),u=n()>0?f/n():0;return u%1===0?u:Number(u.toFixed(1))}function l(){var _;const f=(_=e.metric)==null?void 0:_.chat_event.reduce((b,w)=>{const y=w.chat_time.filter(v=>{const C=$(v.created_at);return a>0?C<=a:!0});return b+y.reduce((v,C)=>{if(!C.closed_at&&!C.created_at)return 0;const S=Number(new Date(C.closed_at))-Number(new Date(C.created_at));return v+S},0)},0),u=Math.floor(f/1e3),h=Math.floor(u/60);return`${Math.floor(h/60).toString().padStart(2,"0")}:${(h%60).toString().padStart(2,"0")}:${(u%60).toString().padStart(2,"0")}`}function c(){var b;const f=(b=e.metric)==null?void 0:b.chat_event.reduce((w,y)=>{const v=y.chat_time.filter(C=>{const S=$(C.created_at);return a>0?S<=a:!0});return w+v.reduce((C,S)=>{if(!S.closed_at&&!S.created_at)return 0;const P=Number(new Date(S.closed_at))-Number(new Date(S.created_at));return C+P},0)},0),u=f>0?f/n():0,h=Math.floor(u/1e3),x=Math.floor(h/60),N=Math.floor(x/60),_=`${N.toString().padStart(2,"0")}:${(x%60).toString().padStart(2,"0")}:${(h%60).toString().padStart(2,"0")}`;return N!==1/0?_:"00:00:00"}function d(){var u;const f=(u=e.metric)==null?void 0:u.button_event.filter(h=>{const x=$(h);return a>0?x<=a:!0},0);return(f==null?void 0:f.reduce((h,x)=>h+x.clicked_button.length,0))||0}function m(){return e.message_manager.map(u=>u.lead_collected).flat().length}function p(){return B(e.created_at).dateFormat_A}return{IS_ONLINE:e.is_online||!1,NAME:e.project_name,CAT:s(),CAU:n(),MESSAGE_INPUT:r(),MESSAGE_OUTPUT:o(),MESSAGES_TOTAL:r()+o(),MEDIA_MESSAGES_CHAT:i(),USAGE_TIME:l(),MEDIA_USAGE_TIME:c(),CREATED_AT:p(),LINK_CLICKS:d(),LEADS_COLLECTED:m(),SERVICE_NOTE:0,RESOLUTION_RATE:0}}async function sn(e){return await z.post(`${O}/analyze_metric`,{prompt:e}).catch(s=>console.warn(s))}function nn(e){const a=e.split("");let s="";return a.forEach(n=>{n.includes(`
`)&&s.length||n.includes(":")?s+=n+"<br />":s+=n}),s}async function on(e,a){const s=await z.post(`${O}/metric_analysis/create`,{plan_management_id:e,result:a});if(s.data.error)throw await Le({level:"warning",path:"src/api/metricAnalysis.ts Ln: 21",log:"Falha ao tentar criar a analise de métrica",sector:"Plataforma"}),new Error("Unable to create the Metric Analysis.");return s}async function rn({feedback:e,metrics_analysis_rating:a,metric_analysis_id:s}){const n=await z.post(`${O}/metric_analysis/create_feedback`,{feedback:e,metrics_analysis_rating:a,metric_analysis_id:s});if(n.data.error)throw await Le({level:"warning",path:"src/api/metricAnalysis.ts Ln: 42",log:"Falha ao tentar enviar o feedback sobre a análise de métrica",sector:"Plataforma"}),new Error("Unable to create the Feedback Metric Analysis.");return n}async function ln(e){const a=await z.get(`${O}/metric_analysis/${e}`);if(a.status===400)throw await Le({level:"warning",path:"src/api/metricAnalysis.ts Ln: 59",log:"Falha ao tentar buscar todas as análises de métricas",sector:"Plataforma"}),new Error("Unable to create the Feedback Metric Analysis.");return a}function cn({index:e,spanReview:a,metric_analysis_id:s}){const n=g.useRef(null),{setModalContent:r,clearModal:o}=g.useContext(A),i=async()=>{var c;const l=(c=n.current)==null?void 0:c.value;l&&s?(await rn({feedback:l,metrics_analysis_rating:e,metric_analysis_id:s})).data.response&&r({componentName:"modal_send_success",components:t.jsx(j,{componentName:"modal_send_success",message:"Feedback enviado com sucesso. Obrigado!",functionAfterComplete:()=>o(null,{clearLast:!0})})}):r({componentName:"modal_error_send_feedback",components:t.jsx(j,{componentName:"modal_error_send_feedback",message:"Você precisa deixar um feedback antes de enviar sua avaliação ou houve um erro no envio do feedback!",type:"ERROR"})})};return t.jsxs("div",{className:"w-[300px] flex flex-col items-center gap-2 p-4",children:[t.jsxs("h2",{className:"text-center font-bold text-lg",children:['Sua avaliação foi "',a,'".']}),t.jsx("p",{className:"text-center opacity-80",children:"Gostaria de deixar um feedback em algo poderia melhorar?"}),t.jsx("textarea",{ref:n}),t.jsx(M,{customClass:"my-4",onClick:i,children:"Enviar"})]})}var Xe=`
 A wipzee é uma empresa que fornece um chatbot com inteligencia artificial, promovendo uma experiência completa ao usuário.
 Desda personalização do chat até o consumo de dados (Métricas), abaixo será informado as métricas do usuário, quero que você faça uma analise
 completa e sugira melhorias ou de feedbacks positivos sobre as métricas.

 exemplo 1: 
    se tiver muitos chats abertos e nenhum clique no link, significa que o cliente não está sendo influenciado a clicar no link. 
    Sugestão: "Mudar o texto do link e deixar mais atrativo ou melhorar sua fonte de dados."
 exemplo 2: 
    se tiver muitos chats abertos e nenhuma ou poucas mensagens, significa que o cliente não está sentindo avontade de conversar com a IA ou não está conseguindo conversar com ela. 
    Sugestão: Melhorar a primeira mensagem do chat ou ver se existe algum problema tecnico nas trocas de mensagens."
`;function dn(){const{clearModal:e,setModalContent:a}=g.useContext(A),{client:s}=g.useContext(T),[n,r]=g.useState(),o=g.useRef(null);g.useEffect(()=>{(async()=>{var c;if(s){const m=(await ln((c=s.plan_management)==null?void 0:c.id)).data.response,p=s.plan_management.plan.max_analyze_metric.default,f=s.plan_management.plan.max_analyze_metric.bonus,u=Number(p+f);m.length?r({status:"APRROVED",analysis:m}):u>0&&m.length<=u?i():a({componentName:"modal_limit_analysis",components:t.jsx(j,{componentName:"modal_limit_analysis",message:Number(s.plan_management.plan.monthly_price)>0?"O limite de analises no seu plano foi atingido. Aguarde até amanhã ou mude de plano para fazer uma nova análise.":"Não é possivel analisar métricas no plano gratuito, mude de plano ou entre em contato com o suporte.",functionAfterComplete:()=>e(null,{clearAll:!0})})})}})()},[]);const i=()=>{if(n&&s&&(n==null?void 0:n.analysis.length)>=Number(s.plan_management.plan.max_analyze_metric.default)){a({componentName:"modal_max_limit_analysis",components:t.jsx(j,{componentName:"modal_max_limit_analysis",message:"O limite de análises no seu plano foi atingido. Aguarde até amanhã ou mude de plano para fazer uma nova análise.",type:"WARNING"})});return}if(r(null),!s)return;const c=s.plan_management.project,d=B(new Date).currentHour;c&&c.forEach(m=>{Xe+=`
                    NOME DO CHAT: ${m.project_name}
                    
                    MÉTRICAS:

                    Chats abertos total:
                    (Essa métrica pode tanto ser tanto varios usuários abrindo um chat ou como pode ser o mesmo usuário abrindo ele varias vezes)
                    [1000]

                    Chats abertos:
                    (Essa métrica conta quantas vezes o usuário abriu o chat, caso o usuário abra o mesmo chat 2 vezes ou mais, será contabilizado apenas uma vez)
                    [1]

                    Quando o chat foi criado:  
                    (Essa métrica registra quando o chat foi criado)
                    [${F(m,d).CREATED_AT}]

                    chat está ativado ou desativado:  
                    (Informa se o chat está ativado ou não: true = ativado e false = desativado)
                    [${F(m,d).IS_ONLINE}]

                    Leads coletados:  
                    (Informa quantos usuários deixaram um contato salvo no sistema)
                    [${F(m,d).LEADS_COLLECTED}]

                    Cliques no link:  
                    (Informa quantos cliques no link(call to action) foi dado no chat)
                    [100]

                    Média de mensagens:  
                    (Informa qual a média de mensagens por chat)
                    [${F(m,d).MEDIA_MESSAGES_CHAT}]

                    Média de tempo de uso:  
                    (Informa qual a média que o usuário ficou interagindo no chat)
                    [${F(m,d).MEDIA_USAGE_TIME}]

                    Total de Mensagens:  
                    (Informa qual o total de mensagens que esse chat tem)
                    [${F(m,d).MESSAGES_TOTAL}]

                    Entrada de Mensagens:  
                    (Informa quantas mensagens os usuários já mandaram para esse chat)
                    [${F(m,d).MESSAGE_INPUT}]

                    Entrada de Mensagens:  
                    (Informa quantas mensagens os usuários já mandaram para esse chat)
                    [${F(m,d).MESSAGE_OUTPUT}]

                    Saída de Mensagens:  
                    (Informa quantas mensagens nossa inteligencia artificial já mandou para esse chat)
                    [${F(m,d).MESSAGE_OUTPUT}]

                    tempo de uso:  
                    (Informa quanto tempo esse chat já ficou aberto)
                    [${F(m,d).USAGE_TIME}]`}),(async()=>{const m=await sn(Xe);if((m==null?void 0:m.status)===200&&m.data){const{text:p}=m.data.choices[0],f=await on(s==null?void 0:s.plan_management.id,p);r({status:"APRROVED",analysis:f.data.response})}else a({componentName:"modal_error_analyze_metric",components:t.jsx(j,{componentName:"modal_error_analyze_metric",message:"Não foi possível analisar suas métricas, por favor tente mais tarde.",type:"ERROR"})})})()},l=c=>{var d,m;if(n!=null&&n.analysis[0].feedback)a({componentName:"modal_error_analysis_metric",components:t.jsx(j,{componentName:"modal_error_analysis_metric",message:"Essa análise já foi avaliada!",type:"WARNING"})});else{const p=c.currentTarget.tabIndex,f=((d=c.currentTarget.querySelector("span"))==null?void 0:d.textContent)||"Regular",u=(m=o.current)==null?void 0:m.querySelectorAll("div > svg");u==null||u.forEach(h=>h.classList.remove("fill-primary-100")),u==null||u.forEach((h,x)=>x+1<=p&&h.classList.add("fill-primary-100")),a({componentName:"modal_show_feedback_analyze",components:t.jsx(D,{children:t.jsx(cn,{index:p,spanReview:f,metric_analysis_id:n==null?void 0:n.analysis[0].id})})})}};return n?t.jsxs("div",{className:"w-full md:max-w-[600px] min-w-[400px] flex flex-col items-center gap-4 p-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Relatório da análise"}),t.jsxs("span",{className:"opacity-70",children:[n.analysis.length,"/",Number(s==null?void 0:s.plan_management.plan.max_analyze_metric.default)," Análises restantes de hoje"]})]}),t.jsx("div",{className:"max-h-[300px] overflow-auto border border-primary-100 p-2",children:t.jsx("p",{dangerouslySetInnerHTML:{__html:nn(n.analysis[0].result)},className:"text-center"})}),t.jsxs("div",{className:"flex flex-col w-full items-center my-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"Avalie essa análise:"}),t.jsx("div",{className:"flex gap-2",ref:o,children:Array.from({length:5}).map((c,d)=>t.jsxs("div",{tabIndex:d+1,onClick:l,className:"group flex flex-col justify-center items-center",children:[t.jsx(oa,{"data-isselected":d+1<=n.analysis[0].metrics_analysis_rating,className:"cursor-pointer text-3xl hover:fill-primary-100 data-[isselected=true]:fill-primary-100"}),t.jsx("span",{className:"group-hover:opacity-100 opacity-0",children:d===0?"horrível":d===1?"ruim":d===2?"regular":d===3?"boa":"excelente"})]},d))})]}),t.jsxs("div",{className:"flex gap-8 justify-center items-center",children:[t.jsx("span",{onClick:()=>e(null,{clearLast:!0}),className:"underline opacity-80 my-4 cursor-pointer",children:"Fechar análise"}),t.jsx(M,{onClick:i,children:"Nova análise"})]})]}):t.jsxs("div",{className:"flex flex-col items-center gap-4 p-4","data-loading":!0,children:[t.jsx("h2",{children:"Analisando métricas"}),t.jsx("span",{children:"Carregando..."})]})}function mn({client:e,handleRequestDataProject:a,setColumns:s,columns:n}){const{setModalContent:r}=g.useContext(A),o=async({currentTarget:c})=>{if(e!=null&&e.plan_management){const d=c.querySelector("svg");d.classList.add("rotate-[-360deg]","transition-transform","duration-1000"),a(e==null?void 0:e.id);const m=setTimeout(()=>{d.classList.remove("rotate-[-360deg]","transition-transform","duration-1000"),clearTimeout(m)},1e3)}},i=()=>{r({componentName:"modal_organization_column",components:t.jsx(an,{modalName:"modal_organization_column",setColumns:s,columns:n})})},l=()=>{r({componentName:"modal_show_analyze_metric",components:t.jsx(D,{children:t.jsx(dn,{})})})};return t.jsxs("div",{className:"w-full md:w-[70vw] px-4 flex flex-row-reverse md:flex-row flex-wrap lg:flex-nowrap gap-4 lg:gap-8 justify-center lg:justify-end items-center",children:[t.jsx("div",{className:"w-1/5 md:w-auto p-2 flex justify-center bg-light dark:bg-dark border border-primary-100 rounded-md cursor-pointer",onClick:o,children:t.jsx(Fe,{className:"text-xl fill-primary-100 dark:fill-light"})}),t.jsx("div",{className:"w-[74%] md:w-auto h-[40px]",children:t.jsx(Ve,{})}),t.jsxs(M,{onClick:i,customClass:"w-full md:w-auto bg-light dark:bg-dark text-primary-100 dark:text-light border border-primary-100 px-4",children:[" ",t.jsx(ra,{className:"text-xl fill-primary-100 dark:fill-light"})," Colunas"]}),t.jsxs(M,{customClass:"w-full md:w-auto px-2 bg-primary-100 border border-primary-100",onClick:l,children:[" ",t.jsx(ia,{className:"text-xl"})," Análise de métrica com IA"]})]})}const fe=[{key:"IS_ONLINE",columnName:"Status",status:!0,dataType:"boolean",size:80},{key:"NAME",columnName:"Nome do chat",status:!0,dataType:"string",size:170},{key:"CAT",columnName:"Chats abertos (total)",status:!0,dataType:"number",size:200},{key:"CAU",columnName:"Chats abertos (unico)",status:!1,dataType:"number",size:200},{key:"MESSAGE_INPUT",columnName:"Mensagens de entrada",status:!1,dataType:"number",size:180},{key:"MESSAGE_OUTPUT",columnName:"Mensagens de saída",status:!1,dataType:"number",size:170},{key:"MESSAGES_TOTAL",columnName:"Mensagens total",status:!0,dataType:"number",size:170},{key:"MEDIA_MESSAGES_CHAT",columnName:"Mensagens por chat",status:!1,dataType:"number",size:220},{key:"USAGE_TIME",columnName:"Tempo de uso",status:!1,dataType:"string",size:170},{key:"MEDIA_USAGE_TIME",columnName:"Tempo de uso por chat",status:!0,dataType:"string",size:230},{key:"LINK_CLICKS",columnName:"Cliques no link",status:!0,dataType:"number",size:150},{key:"LEADS_COLLECTED",columnName:"Leads coletados",status:!0,dataType:"number",size:170},{key:"CREATED_AT",columnName:"Criado em",status:!0,dataType:"string",size:150}];function un({setColumns:e,columns:a}){return g.useEffect(()=>{const s=JSON.parse(localStorage.getItem("metricColumnActive")||"[]");s.length>0?(s.length!==fe.length&&localStorage.setItem("metricColumnActive",JSON.stringify(fe)),s.status?e(s):localStorage.setItem("metricColumnActive",JSON.stringify(fe))):localStorage.setItem("metricColumnActive",JSON.stringify(fe))},[]),a&&t.jsx("div",{className:"w-1/2 flex",children:a.map(s=>s.status&&t.jsx("span",{style:{width:`${s.size}px`},className:"flex-none p-3 overflow-hidden whitespace-nowrap text-ellipsis text-sm font-bold uppercase text-center bg-primary-100 dark:bg-primary-300 text-light dark:text-primary-100 border-r border-r-light dark:border-r-primary-100",children:s.columnName},s.columnName))})}function fn({columns:e,setColumns:a,planManagement:s}){const[n]=H(),r=n.get("filter_time_metric");return t.jsxs("div",{className:"w-[95%] md:w-[70vw] md:h-[40vh] self-center rounded-xl overflow-x-auto",children:[t.jsx(un,{setColumns:a,columns:e}),t.jsx("div",{className:"flex flex-col",children:s!=null&&s.project.length?s.project.map(o=>t.jsx("div",{className:"flex-none flex",children:e.map((i,l)=>i.status&&t.jsx("span",{style:{width:`${i.size}px`},className:"flex-none text-ellipsis overflow-hidden whitespace-nowrap text-center border border-primary-100/30 p-2",children:l===0?t.jsxs("div",{className:"w-full flex justify-center items-center gap-2",children:[t.jsx("div",{className:`w-[8px] h-[8px] ${o.is_online?"bg-green-700":"bg-red-700"} rounded-full`}),t.jsx("span",{children:o.is_online?"Ativo":"Desativado"})]}):l===1?o.project_name:F(o,r)[i.key]},i.columnName))},o.id)):t.jsx("h2",{className:"text-center p-4 text-xs",children:'Você não tem nenhuma chat criado, clique em "Meus chats" , depois criar "Novo chat".'})}),t.jsx("div",{"data-hasproject":!!(s!=null&&s.project.length),className:"flex-none flex data-[hasproject]:hidden",children:e.map((o,i)=>o.status&&t.jsx("div",{style:{width:`${o.size}px`},className:"flex-none p-2 flex justify-center items-center gap-2",children:i===1?t.jsx("span",{className:"w-full font-bold text-primary-100 text-xl text-center",children:"TOTAL"}):o.dataType==="number"?t.jsx("span",{className:"w-full font-bold text-primary-100 text-xl text-center",children:s==null?void 0:s.project.reduce((l,c)=>l+Number(F(c,r)[o.key]),0)}):t.jsx("span",{className:"w-full text-primary-100 text-xl text-center",children:"-"})},o.key))})]})}function pn(){const e=JSON.parse(localStorage.getItem("metricColumnActive")||"[]"),{setModalContent:a}=g.useContext(A),{client:s}=g.useContext(T),[n,r]=g.useState(e),[o,i]=g.useState(s==null?void 0:s.plan_management);g.useEffect(()=>{s!=null&&s.plan_management&&l(s==null?void 0:s.id)},[]);const l=async c=>{const d=await la(c);(d==null?void 0:d.status)===200?i(d.data.plan_management):a({componentName:"modal_failed_load_metric",components:t.jsx(j,{message:"Falha ao recarregar as métricas, tente reiniciar a página.",type:"ERROR",componentName:"modal_failed_load_metric"})})};return t.jsxs(J,{title:"Métricas",className:"flex-col items-center gap-2 md:gap-8",children:[t.jsx(mn,{client:s,columns:n,handleRequestDataProject:l,setColumns:r}),t.jsx(fn,{columns:n,planManagement:o,setColumns:r})]})}function hn({plan_management_id:e,index:a}){const{client:s}=g.useContext(T),{setModalContent:n}=g.useContext(A),r=Q(),o=()=>{if(s!=null&&s.plan_management){const i=Number(s.plan_management.plan.max_databases.default),l=s.plan_management.artificial_intelligence.length;s.plan_management.status!=="DISABLED"?i>l?r(`/create-ai/${e}`):n({componentName:"modal_max_artificial_inteligencia",components:t.jsx(j,{message:"Você atingiu o número maximo de base de dados no seu plano.",componentName:"modal_max_artificial_inteligencia"})}):n({componentName:"modal_desactive_account",components:t.jsx(j,{message:"O plano da sua conta está desabilitado.",componentName:"modal_desactive_account"})})}else n({componentName:"modal_without_plan",components:t.jsx(j,{message:"Nenhum plano foi vinculado a sua conta",componentName:"modal_without_plan"})})};return t.jsx("div",{className:"w-full rounded-md border border-primary-100 bg-primary-100 dark:bg-primary-300 hover:bg-primary-200 text-white dark:text-primary-100 data-[prompt=false]:bg-primary-200/20 flex justify-center",onClick:o,children:t.jsx(ie,{title:"Vamos criar sua primeira inteligência artificial",text:"Clique em <span class='font-medium text-2xl mx-1'>+</span> para criar sua primeira inteligência artificial.",positionX:window.innerWidth>680?"RIGHT":"CENTER",hidden:a!==0,children:t.jsx(k,{tip:"Criar inteligência artificial",children:t.jsx(nt,{className:"size-10 py-2 fill-light dark:fill-primary-100"})})})})}function xn({plan_management_id:e,intelligence:a,setIntelligence:s}){var m;const{setModalContent:n,clearModal:r}=g.useContext(A),{client:o,setClient:i}=g.useContext(T),l=X({resolver:St(ha),defaultValues:{products_id:a.ai_products_Services.map(p=>p.product_id),services_id:a.ai_products_Services.map(p=>p.service_id),client_describe:a.client_describe||"",artificial_name:a.artificial_name||"",restrictions:a.restrictions||""}}),c=async p=>{const f={products_id:p.products_id,services_id:p.services_id,identification:p.identification,artificial_name:p.artificial_name,restrictions:p.restrictions,client_describe:p.client_describe,plan_management_id:a.plan_management_id,client_company_id:p.client_company_id},u=await xa(f,a.id);u&&o&&u.status===200&&(s(h=>[...h.filter(x=>x.id!==u.data.id),u.data]),n({componentName:"modal_updated_ai",components:t.jsx(j,{message:"Inteligência artificial atualizada com sucesso",componentName:"modal_updated_ai",functionAfterComplete:()=>r(null,{clearAll:!0})})}))};async function d(){var p,f;if(a.id){const u=await ga(a.id);if((u==null?void 0:u.status)===200){s(x=>x.filter(N=>N.id!==u.data.id));const h=(p=o==null?void 0:o.plan_management)==null?void 0:p.artificial_intelligence.findIndex(x=>x.id===a.id);o&&typeof h=="number"&&((f=o.plan_management)==null||f.artificial_intelligence.splice(h,1),i(o)),n({componentName:"modal_delete_success",components:t.jsx(j,{message:"Inteligência artificial excluida com sucesso!",componentName:"modal_delete_success",functionAfterComplete:()=>r(null,{clearAll:!0})})})}else(u==null?void 0:u.status)===401?n({componentName:"modal_failed_delete_ai",components:t.jsx(j,{message:"Você não pode excluir uma inteligência artificial que possui um chat vinculado a ela, tente excluir todos os chats primeiro, antes de excluir essa fonte de dados.",type:"ERROR",componentName:"modal_failed_delete_ai"})}):n({componentName:"modal_failed_delete",components:t.jsx(j,{message:"Falha ao tentar excluir essa inteligência artificial. Tente reiniciar a página e tentar de novo.",type:"ERROR",componentName:"modal_failed_delete"})})}}return t.jsx("div",{className:"w-screen h-screen px-4 md:px-0 md:min-h-[450px] md:min-w-[700px] flex items-start overflow-hidden",children:t.jsxs(E.EditForm,{form:l,onSubmit:c,onDelete:d,children:[t.jsx(E.EditStep,{index:0,titleStep:"Vincule seus produtos",icon:t.jsx(ca,{}),children:t.jsx(da,{plan_management_id:e,ai_products_services:a.ai_products_Services})}),t.jsx(E.EditStep,{index:1,titleStep:"Sobre sua empresa",icon:t.jsx(ma,{}),children:t.jsx(ua,{companies:(m=o==null?void 0:o.plan_management)==null?void 0:m.client_company})}),t.jsx(E.EditStep,{index:2,titleStep:"Personalidade da AI",icon:t.jsx(fa,{}),children:t.jsx(pa,{})})]})})}function gn(){var c;const{client:e}=g.useContext(T),{setModalContent:a,clearModal:s}=g.useContext(A),n=Array(_a).fill(0),[r,o]=g.useState(((c=e==null?void 0:e.plan_management)==null?void 0:c.artificial_intelligence)||[]),i=d=>{r!=null&&r.length&&(e!=null&&e.plan_management)&&a({componentName:"modal_create_database",components:t.jsx(D,{children:t.jsx(xn,{plan_management_id:e==null?void 0:e.plan_management.id,intelligence:r[d],setIntelligence:o})})})},l=d=>{async function m(p){p.preventDefault();const f=p.target.querySelector("input").value,u=r[d].id;if(f){const h=await wa(f,u);(h==null?void 0:h.status)===200&&(o([...r,r[d].artificial_name=f]),a({componentName:"modal_saved",components:t.jsx(j,{message:"Nome da sua base de dados foi atualizado com sucesso!",componentName:"modal_saved",functionAfterComplete:()=>s(null,{clearAll:!0})})}))}}a({componentName:"modal_edit_name",components:t.jsx(D,{children:t.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 p-4",children:[t.jsx("h2",{children:"Digite o novo nome da sua fonte de dados:"}),t.jsxs("form",{onSubmit:m,className:"flex flex-col justify-center items-center gap-4",children:[t.jsx("input",{placeholder:"Ex: Minha nova base de dados",name:"database_name",defaultValue:r[d].artificial_name}),t.jsx(M,{children:"Salvar"})]})]})})})};return e&&t.jsx(J,{title:"Inteligência artificial",children:t.jsx("div",{className:"w-full flex-wrap flex justify-center p-4 my-8 gap-6",children:n.map((d,m)=>{var p,f,u,h;return(p=e.plan_management)!=null&&p.plan&&m<Number(e.plan_management.plan.max_databases.default)?t.jsx("div",{className:"w-full max-w-[250px] flex justify-center items-center cursor-pointer",children:(f=r[m])!=null&&f.identification?t.jsxs("div",{className:"w-full relative flex gap-2 items-center justify-between rounded-md border border-primary-100 bg-primary-100 dark:bg-primary-300 hover:bg-primary-200 text-white dark:text-primary-100 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20",children:[t.jsx(Va,{className:"size-10"}),t.jsx("h2",{className:"text-center flex justify-center items-center gap-2 whitespace-nowrap text-ellipsis overflow-x-hidden",onClick:()=>i(m),children:(u=r[m])==null?void 0:u.identification}),t.jsx(ya,{className:"cursor-text size-6 mx-2",onClick:()=>l(m)}),t.jsx("div",{"data-hasproduct":!!e.plan_management.artificial_intelligence[m].ai_products_Services.length,className:"data-[hasproduct=true]:hidden absolute top-0 right-1",children:t.jsx(k,{tip:"Inteligência artificial não tem conhecimento sobre seus produtos!",positionX:"LEFT",children:t.jsx(Na,{className:"fill-orange-500"})})})]}):t.jsx(hn,{plan_management_id:e.plan_management.id,index:m})},m):t.jsx("div",{"data-prompt":!!((h=r[m])!=null&&h.artificial_name),className:"w-full max-w-[250px] flex opacity-30 cursor-not-allowed justify-center items-center rounded-md border border-primary-100 bg-primary-300 hover:bg-primary-200 text-xl data-[prompt=false]:text-2xl data-[prompt=false]:bg-primary-200/20",children:t.jsx(Z,{className:"size-10 py-3"})},m)})})})}function _n({chats:e,selectedChatById:a}){const[s,n]=H(),r=s.get("mobile_modal_select_chat")==="open",o=i=>{s.delete("mobile_modal_select_chat"),n(s),a(i)};return!!e.length&&t.jsx("div",{"data-isopen":window.innerWidth<768?!!r:!0,className:"w-full md:w-[400px] md:max-h-[400px] fixed md:static top-0 md:bg-transparent left-0 h-full overflow-auto flex flex-col border-r border-light/40 data-[isopen=false]:hidden",children:e.map((i,l)=>i.messages.length>1&&t.jsxs("div",{className:"w-full cursor-pointer hover:bg-primary-200 transition-colors p-4 border border-primary-100/20",onClick:()=>o(i.id),children:[t.jsx("h2",{className:"whitespace-nowrap text-ellipsis overflow-hidden py-1 text-xl font-bold",children:i.messages.length>1?i.messages[1].message.replace("<br/>",""):`Chat ${l.toString().padStart(2,"0")}`},i.messages.join()),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"italic text-xs",children:[i.messages.length," messagens"]}),t.jsx("span",{className:"italic text-xs",children:B(i.messages[i.messages.length-1].time).dateFormat_A})]})]},i.id))})}function yn({chats:e,selectedChatById:a}){const{client:s}=g.useContext(T),[n,r]=H(),{historic_messages:o,messages:i,project_id:l,lead_collected:c}=e.find(f=>f.id===a)||e[0],d=[...o,...i],m=s==null?void 0:s.plan_management.project.find(f=>f.id===l),p=()=>{const f=m==null?void 0:m.project_name.replaceAll(" ","_");f&&n.set(ze,f),n.set(Ca,"leads"),r(n)};return t.jsx("div",{className:"w-full h-full md:max-h-[400px] overflow-hidden flex flex-col mb-8 md:mb-0",children:t.jsxs("div",{className:"w-full h-full flex flex-col gap-4",children:[t.jsxs("div",{className:"w-full h-[60px] flex justify-between items-center px-4 bg-primary-100",children:[t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx("div",{className:"w-[50px] h-[50px] overflow-hidden rounded-full",children:t.jsx("img",{src:"https://via.placeholder.com/100",alt:"logo do cliente",className:"w-full h-full object-cover"})}),t.jsx("p",{className:"px-4 text-xl text-light",children:m==null?void 0:m.project_name})]}),t.jsx("div",{className:"flex gap-2 items-center cursor-pointer",onClick:p,children:c.find(f=>f.email||f.cell_phone)?t.jsx(k,{tip:"informações foram coletadas nesse chat",positionX:"LEFT",positionY:"BOTTOM",children:t.jsx(ja,{className:"fill-green-200"})}):t.jsx(k,{tip:"Nenhuma informação foi coletada",positionX:"LEFT",positionY:"BOTTOM",children:t.jsx(ba,{className:"fill-red-200"})})})]}),t.jsx("div",{className:"w-full h-full max-h-[320px] p-4 flex flex-col gap-4 overflow-auto",children:(d==null?void 0:d.map((f,u)=>t.jsx("div",{"data-player":f.player,className:"w-full flex data-[player='user']:justify-end justify-start",children:t.jsxs("div",{"data-player":f.player,className:"max-w-[80%] bg-primary-100/50 dark:bg-light text-black/80 data-[player='user']:bg-primary-100 dark:data-[player='user']:bg-primary-200 data-[player='user']:text-light p-2 rounded-xl",children:[t.jsx("h2",{dangerouslySetInnerHTML:{__html:f.message}}),t.jsx("span",{className:"w-full flex justify-end text-xs italic",children:B(f.time).shortHour})]})},u)))||t.jsx("h2",{className:"w-full h-[200px] flex justify-center items-center",children:"Ainda não existe nenhuma conversa para esse chat"})})]})})}function Ze(){var u;const{client:e}=g.useContext(T),[a,s]=H(),[n,r]=g.useState(),[o,i]=g.useState([]),l=a.get(ze),c=(u=e==null?void 0:e.plan_management)==null?void 0:u.project.map(h=>({id:h.project_name.replace(" ","_"),value:h.project_name,text:h.project_name}));g.useEffect(()=>{const h=a.get(va);if(e&&c!=null&&c.length){let x;l?x=e.plan_management.project.filter(_=>_.project_name.replaceAll(" ","_")===l&&_):x=e.plan_management.project;const N=x.map(_=>_.message_manager.filter(w=>Number(h)?$(w.created_at)<=Number(h):!0)).flat();i(N)}},[a]);const d=h=>{a.set("project",h.replaceAll(" ","_")),s(a)},m=async({currentTarget:h})=>{if(e!=null&&e.plan_management){const x=h.querySelector("svg");x.classList.add("rotate-[-360deg]","transition-transform","duration-1000");const N=setTimeout(()=>{x.classList.remove("rotate-[-360deg]","transition-transform","duration-1000"),clearTimeout(N)},1e3)}},p=()=>{a.append("mobile_modal_select_chat","open"),s(a)},f=()=>{a.delete("project"),s(a)};return t.jsxs(J,{title:"Conversas",className:"flex items-center",children:[t.jsxs("div",{className:"w-[90%] flex flex-col-reverse md:flex-row md:justify-end gap-2 md:gap-8 md:h-[40px] px-4 md:px-0",children:[t.jsx(k,{tip:"Selecione um chat",children:t.jsx(Be,{name:"select_chat",title:"Selecione um chat",options:c||[],optionsDefault:l?Array.of(l):null,onSelected:d,onDelete:f})}),t.jsxs("div",{className:"flex gap-8 justify-between",children:[t.jsx(k,{tip:"Selecione uma data  como filtro",children:t.jsx(Ve,{})}),t.jsx(k,{tip:"Atualize seus chats",positionX:"LEFT",children:t.jsx("div",{className:"p-2 bg-light dark:bg-gray border border-primary-100 rounded-md cursor-pointer",onClick:m,children:t.jsx(Fe,{className:"text-nxl"})})})]})]}),t.jsxs("div",{className:"w-[90%] h-3/4 flex gap-4 flex-col md:flex-row md:bg-light md:dark:bg-gray my-4 border border-primary-200 rounded-md",children:[t.jsx(M,{customClass:"bg-primary-100 dark:bg-primary-200 md:hidden",onClick:p,children:"Selecione um chat "}),t.jsx(_n,{chats:o,selectedChatById:r}),o.length?t.jsx(yn,{chats:o,selectedChatById:n}):t.jsx("h2",{className:"p-4 text-center w-full",children:"Você ainda não teve acessos no seu chat"})]})]})}function Et({titleColumn:e,rows:a,maxPerPage:s=10}){const[n,r]=g.useState(0),[o,i]=g.useState([]);g.useEffect(()=>{if(!a)return;const c=Math.floor(a.length/s),d=a.length%s,m=[];if(Array.from({length:c}).forEach((p,f)=>{const u=a.slice(s*f,s*(f+1));m.push(u)}),d){const p=a.slice(a.length-d,a.length);m.push(p)}i(m)},[a]);const l=c=>{const d=c.currentTarget.dataset.tab;r(d==="previous"?m=>m>0?m-1:o.length-1:m=>m<o.length-1?m+1:0)};return t.jsx("div",{className:"w-full mx-auto flex flex-col items-center",children:o[n]?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-full overflow-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{className:"w-full bg-primary-100/30 border-2 border-primary-100/60",children:t.jsx("tr",{className:"w-full",children:e.map(c=>t.jsx("th",{className:"min-w-20 whitespace-nowrap overflow-hidden text-ellipsis uppercase p-2 px-3 border-r border-primary-100/40",children:c},je()))})}),t.jsx("tbody",{className:"w-full divide-y divide-gray_light",children:o[n].map((c,d)=>t.jsx("tr",{"data-color":d%2===0,className:"data-[color=true]:bg-primary-50/10 h-[30px]",children:c.map(m=>t.jsx("td",{className:"text-center lowercase",children:m},je()))},je()))})]})}),t.jsxs("div",{"data-pagination":o.length>1,className:"w-full flex gap-4 items-center justify-center p-4 data-[pagination=false]:hidden",children:[t.jsx(Sa,{className:"cursor-pointer","data-tab":"previous",onClick:l}),t.jsxs("span",{children:[n+1," - ",o.length]}),t.jsx(Ea,{className:"cursor-pointer","data-tab":"next",onClick:l})]})]}):t.jsx("h2",{children:"Você ainda não recebeu nenhum dado para ser exibido na tabela"})})}function Nn({plan_management:e}){const[a,s]=g.useState();return g.useEffect(()=>{const n=e==null?void 0:e.trasaction.map(r=>[e.plan.plan_name,B(r.updated_at).dateFormat_A,`${r.amount_paid} reais`,r.payment_method,r.status==="APPROVED"?"Aprovado":"Pendente"]);s(n)},[]),a&&t.jsxs("div",{className:"w-full flex flex-col items-center",children:[t.jsx("h2",{className:"text-xl p-2",children:"Historico de transações"}),t.jsx("div",{className:"w-[95%]",children:t.jsx(Et,{titleColumn:["Plano","Data e hora","Valor do plano","Método de pagamento","Status"],rows:a,maxPerPage:5})})]})}function wn({plan_management:e}){return e&&e.status!=="DISABLED"?t.jsx("span",{className:"font-bold text-yellow-600 uppercase",children:e.plan.plan_name}):t.jsx("span",{className:"text-zinc-400/60",children:"Sem plano"})}function At(e){const r=(new Date(e)-new Date)/(1e3*60*60*24);return Number(r.toFixed(0))}function jn({plan_management:e}){const a=()=>e?At(e.free_trial):0;return e&&e.status!=="DISABLED"&&t.jsxs("div",{className:"w-full flex flex-col items-center",children:[t.jsxs("span",{children:["Status:",t.jsx("span",{"data-status":e.status,className:"px-1 rounded-md mx-2 bg-red-200 text-red-700 data-[status='ACTIVE']:bg-green-200 data-[status='ACTIVE']:text-green-700",children:e.status==="ACTIVE"?"Ativo":"Desativado"})]}),t.jsxs("span",{children:["Chats: ",e.project.length," / ",Number(e.plan.max_projects.default)]}),t.jsxs("span",{children:["Fonte de dados: ",e.artificial_intelligence.length," / ",Number(e.plan.max_databases.default)]}),t.jsxs("span",{children:["Análise de métrica diária:  ",Number(e.plan.max_analyze_metric.default)," "]}),t.jsxs("span",{children:["Limite de messages: ",Wa(e).totalMessages," / ",Number(e.plan.max_messages.default)," "]}),t.jsxs("span",{"data-free":Number(e.plan.monthly_price)<=0,className:"data-[free=true]:hidden",children:["Reembolso garantido: ",a()>0?a()+" dias restantes":"expirado"]})]})}function bn({client:e}){const a=Q(),s=()=>{a("/plans")};return(e!=null&&e.refund_requested.length&&e.refund_requested[0].status!=="PENDING",!0)&&t.jsx("div",{className:"w-full flex flex-col my-4 justify-center items-center",children:t.jsx(M,{onClick:s,children:((e==null?void 0:e.plan_management)&&e.plan_management.status)!=="DISABLED"?Number(e==null?void 0:e.plan_management.plan.monthly_price)>0?"Mudar de plano":"Contratar plano":"Adicionar plano"})})}async function Cn(e){return await z.post(`${O}/refund_requested`,e).catch(s=>console.warn(s))}async function vn(e){return await z.post(`${O}/refund_requested/reactive`,{client_id:e}).catch(s=>console.warn(s))}function Sn({client:e}){const{setModalContent:a}=g.useContext(A),s=()=>e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0?At(e==null?void 0:e.plan_management.free_trial):0,n=async()=>{const l=d=>{var f,u;d.preventDefault();const m=(f=d.currentTarget.querySelector("textarea"))==null?void 0:f.value,p=(u=d.currentTarget.querySelector("div > span[data-active='true']"))==null?void 0:u.textContent;if(!m||!p){a({componentName:"modal_error_refund",components:t.jsx(j,{componentName:"modal_error_refund",message:"Informe o motivo da solicitação do seu reembolso e de uma nota para sua expêriencia na Wipzee.",type:"WARNING"})});return}(async()=>{if(e){const h={client_id:e.id,reason:m||"",product_review:Number(p||0)};await Cn(h)?(a({componentName:"modal_request_success",components:t.jsx(j,{message:"Solicitação de reembolso foi enviada com sucesso!",componentName:"modal_request_success"})}),setTimeout(()=>window.location.reload(),1e3)):a({componentName:"modal_error_request",components:t.jsx(j,{message:"Ocorreu um erro ao enviar sua solicitação de reembolso, por favor entre em contato com nosso suporte.",componentName:"modal_error_request"})})}else a({componentName:"modal_error_client",components:t.jsx(j,{message:"Erro ao processar o cliente, por favor recarregue a página.",componentName:"modal_error_client"})})})()},c=({currentTarget:d})=>{const m=d.closest("div[data-review='review']");m==null||m.querySelectorAll("span").forEach(p=>p.dataset.active="false"),d.dataset.active="true"};a({componentName:"modal_reason_client",components:t.jsxs(D,{children:[t.jsx("h2",{className:"p-4 text-xl font-medium text-center",children:"Solicitação de reembolso"}),t.jsxs("form",{className:"w-auto md:w-[500px] p-4 space-y-3",onSubmit:l,children:[t.jsx(Aa,{name:"reason",title:"Por qual motivo você deseja pedir seu reembolso?"}),t.jsx("h2",{className:"text-center p-4",children:"De uma nota para a sua experiência com a Wipzee. "}),t.jsx("div",{"data-review":"review",className:"w-4/5 flex mx-auto justify-between mt-12",children:Array.from({length:6}).map((d,m)=>t.jsx("span",{className:"w-12 h-12 text-light bg-primary-100/30 hover:bg-primary-100 data-[active=true]:bg-primary-100 transition-colors p-3 rounded-full flex items-center justify-center font-bold cursor-pointer",onClick:c,children:m},m))}),t.jsx("div",{className:"w-full flex justify-center mt-8",children:t.jsx(M,{children:"Enviar"})})]})]})})},r=()=>{if(e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0)return e!=null&&e.refund_requested.length&&e.plan_management.status==="ACTIVE"&&s()>0?e.refund_requested[0].status!=="PENDING":s()>0&&e.plan_management.status!=="DISABLED"},o=()=>{e?window.open(`https://dash.ticto.com.br/subscription-verification?code=${e==null?void 0:e.ticto_order_code}&email=${e==null?void 0:e.purchase_email}`):a({componentName:"modal_failed_cancel",components:t.jsx(j,{message:"Falha ao preencher os dados de cancelamento, por favor entre em contato com o suporte.",componentName:"modal_failed_cancel"})})},i=()=>{if(e!=null&&e.plan_management&&Number(e.plan_management.plan.monthly_price)>0&&e.plan_management.status==="ACTIVE"&&s()<=0)return!!(e.refund_requested.length&&e.refund_requested[0].status!=="PENDING")};return r()?t.jsx("div",{className:"w-full flex justify-center",children:t.jsx("a",{onClick:n,className:"text-center underline cursor-pointer",children:"Pedir reembolso"})}):i()&&t.jsx("div",{className:"w-full flex justify-center",children:t.jsx("a",{onClick:o,className:"text-center underline cursor-pointer",children:"Gerenciar assinatura"})})}function En({client:e}){return t.jsxs("div",{className:"w-4/5 md:w-1/2 min-w-[150px] max-w-[400px] min-h-[200px] flex flex-col justify-between border border-zinc-600 p-2 rounded-md z-0",children:[t.jsxs("div",{className:"w-full flex justify-center gap-2",children:[t.jsx("h2",{className:"text-center",children:"Plano atual:"}),t.jsx(wn,{plan_management:e==null?void 0:e.plan_management})]}),t.jsx("div",{className:"w-full flex justify-center my-4",children:t.jsx(jn,{plan_management:e==null?void 0:e.plan_management})}),t.jsx(bn,{client:e}),t.jsx(Sn,{client:e})]})}function An({client:e}){const{setModalContent:a}=g.useContext(A),s=async()=>{e&&await vn(e.id)&&(a({componentName:"modal_reactive_plan",components:t.jsx(j,{message:"Plano reativado com  sucesso!",componentName:"modal_reactive_plan"})}),setTimeout(()=>window.location.reload(),1500))};return!!(e!=null&&e.refund_requested.length)&&e.refund_requested[0].status!=="CANCEL"&&t.jsxs("div",{className:"w-4/5 md:w-1/2 min-w-[150px] max-w-[400px] min-h-[200px] border border-zinc-600 p-2 rounded-md",children:[t.jsx("h2",{className:"w-full text-center pb-4 text-xl",children:"Reembolso solicitado:"}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Reembolso solicidado em:",t.jsx("p",{children:e.refund_requested[0].created_at.substring(0,10)})]}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Plano:",t.jsx("p",{children:e.plan_management.plan.plan_name})]}),t.jsxs("span",{className:"flex gap-2 text-zinc-400",children:["Status:",e.refund_requested[0].status==="PENDING"?t.jsx("p",{className:"text-red-600",children:"Pendente"}):e.refund_requested[0].status==="APPROVED"?t.jsx("p",{className:"text-green-600",children:"Dinheiro devolvido"}):t.jsx("p",{className:"text-zinc-200",children:"Reembolso cancelado"})]}),t.jsx("div",{className:"w-full flex justify-center mt-6",children:e.refund_requested[0].status==="PENDING"&&t.jsx(M,{onClick:s,children:"Cancelar reembolso"})})]})}function Tn(){const{client:e}=g.useContext(T);return t.jsxs(J,{title:"Assinatura",className:"flex-col items-center",children:[t.jsxs("div",{className:"w-[95%] flex flex-col md:flex-row gap-2 justify-center items-center",children:[t.jsx(En,{client:e}),t.jsx(An,{client:e})]}),t.jsx(Nn,{plan_management:e==null?void 0:e.plan_management})]})}function In(){const{setValue:e}=xe(),a=X(),{handleSubmit:s}=a,{client:n}=g.useContext(T),{setModalContent:r,clearModal:o}=g.useContext(A),i=async l=>{if(!n)return;if(l.new_password.length<8||l.current_password.length<8){const m=!l.new_password.length||!l.current_password.length?"Preencha todos os dados":"Informe uma senha com mais de 8 caracteres";r({componentName:"modal_error_fill_data",components:t.jsx(j,{message:m,componentName:"modal_error_fill_data",type:"WARNING"})});return}if(l.new_password!==l.confirm_password){r({componentName:"modal_error_new_password",components:t.jsx(j,{message:"Sua confirmação de senha não é idêntica a sua nova senha!",componentName:"modal_error_new_password",type:"ERROR"})});return}l.client_id=n.id;const c=await Ta(l);c||r({componentName:"modal_error_password",components:t.jsx(j,{message:"A sua atual senha está incorreta!",componentName:"modal_error_password",type:"ERROR"})}),(c==null?void 0:c.status)===200&&(e("password",l.new_password),r({componentName:"modal_change_password_success",components:t.jsx(j,{message:"Senha atualizada com sucesso!",componentName:"modal_change_password_success",functionAfterComplete:()=>o(null,{clearLast:!0})})}))};return t.jsx(Ie,{...a,children:t.jsxs("form",{className:"flex min-w-[200px] flex-col gap-8 p-4",onSubmit:s(i),children:[t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Sua senha atual:"}),t.jsx(be,{name:"current_password"})]}),t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Nova senha:"}),t.jsx(be,{name:"new_password"})]}),t.jsxs("div",{className:"w-full flex gap-4 justify-between items-center",children:[t.jsx("h2",{className:"whitespace-nowrap font-medium ",children:"Confirme sua senha:"}),t.jsx(be,{name:"confirm_password"})]}),t.jsxs(M,{customClass:"flex items-center gap-2",children:[t.jsx(ot,{})," Salvar"]})]})})}const Mn=oe.object({fullname:oe.string().min(1,"Digite seu nome completo!").refine(e=>{const a=e.split(" ");return!!(a.length>=2&&a[1])},"Vocẽ precisa informar seu nome completo"),user:oe.string().min(1,"Digite um nome de usuário!").max(25,"Nome de usuário muito longe, informe um menor."),email:oe.string().email(),password:oe.string().min(8,"Sua senha precisa ter no minimo 8 caracteres!")});function kn(){const{setModalContent:e}=g.useContext(A),{client:a,setClient:s}=g.useContext(T),n=X({resolver:Oe(Mn),defaultValues:{fullname:a==null?void 0:a.fullname,user:a==null?void 0:a.user,email:a==null?void 0:a.email,password:"senha-qualquer"}}),{handleSubmit:r,formState:{errors:o}}=n;g.useEffect(()=>{const m=i(o);m&&e({componentName:"modal_error_message",components:t.jsx(j,{message:m,type:"WARNING",componentName:"modal_error_message"})})},[o]);const i=m=>{if(typeof m=="object"&&Ia!==null)for(let p in m){if(p==="message")return m[p];{const f=i(m[p]);if(f!==void 0)return f}}},l=async m=>{if(a)if((a==null?void 0:a.user)===m.user||await Ma(m.user)){const p=await ka(a==null?void 0:a.id,m);(p==null?void 0:p.status)===200&&(s(p.data),e({componentName:"modal_user_success",components:t.jsx(j,{componentName:"modal_user_success",message:"Perfil atualizado com sucesso"})}))}else e({componentName:"modal_error_user",components:t.jsx(j,{componentName:"modal_error_user",message:"Usuário informado não está disponível!",type:"WARNING"})})},c=()=>{e({componentName:"modal_show_password",components:t.jsx(D,{children:t.jsx(Ie,{...n,children:t.jsx(In,{})})})})},d=()=>{e({componentName:"modal_show_email",components:t.jsx(j,{componentName:"modal_show_email",message:"Ainda não é possível atualizar o e-mail, para mais informações entre em contato com o suporte.",type:"WARNING"})})};return t.jsx(J,{title:"Configurações",children:t.jsx(Ie,{...n,children:t.jsxs("form",{onSubmit:r(l),className:"w-full md:w-2/3 mx-auto p-4 px-8 flex flex-col gap-6",children:[t.jsxs(E.Container,{className:"w-full flex flex-col md:flex-row items-center gap-4",children:[t.jsx(V,{name:"fullname",title:"Nome completo"}),t.jsx(V,{name:"user",title:"Usuário"})]}),t.jsxs(E.Container,{className:"flex flex-col md:flex-row gap-4 justify-center items-center",children:[t.jsx(E.Container,{children:t.jsx(V,{type:"email",name:"email",title:"Informe seu e-mail",disabled:!0})}),t.jsxs(M,{type:"button",customClass:"min-w-[200px] flex justify-center items-center gap-2",onClick:d,children:["Alterar e-mail",t.jsx(Z,{})]})]}),t.jsxs(E.Container,{className:"flex flex-col md:flex-row gap-4 justify-center items-center",children:[t.jsx(E.Container,{children:t.jsx(V,{type:"password",name:"password",title:"Sua senha",disabled:!0})}),t.jsxs(M,{type:"button",customClass:"min-w-[200px] flex justify-center items-center gap-2",onClick:c,children:["Alterar senha",t.jsx(Z,{})]})]}),t.jsxs(M,{customClass:"flex gap-2 mt-8",children:["Salvar ",t.jsx(ot,{})]})]})})})}function Pn({}){var m;const{client:e}=g.useContext(T),[a,s]=H(),n=["nome","e-mail","Telefone"],[r,o]=g.useState([[]]),i=a.get(ze),l=(m=e==null?void 0:e.plan_management.project)==null?void 0:m.map(p=>({id:p.project_name.replaceAll(" ","_"),value:p.project_name,text:p.project_name}));g.useEffect(()=>{const p=a.get("filter_time");var f=(e==null?void 0:e.plan_management.project)||[];i&&(f=f.filter(x=>x.project_name.replaceAll(" ","_")===i&&x));const h=f.flatMap(x=>x.message_manager.map(N=>{var v,C,S,P;let _=(v=N.lead_collected[N.lead_collected.length-1])==null?void 0:v.time,b=(C=N.lead_collected.sort((I,R)=>B(R.time).dateTransformNumber-B(I.time).dateTransformNumber).find(I=>!!I.name))==null?void 0:C.name,w=(S=N.lead_collected.sort((I,R)=>B(R.time).dateTransformNumber-B(I.time).dateTransformNumber).find(I=>!!I.email))==null?void 0:S.email,y=(P=N.lead_collected.sort((I,R)=>B(R.time).dateTransformNumber-B(I.time).dateTransformNumber).find(I=>!!I.cell_phone))==null?void 0:P.cell_phone;return w||y?!p||$(_)<=Number(p)?[b||"-",w||"-",y||"-"]:[]:[]})).filter(x=>x.length>0);o(h)},[a]);const c=p=>{a.set("project",p.replaceAll(" ","_")),s(a)},d=()=>{a.delete("project"),s(a)};return t.jsxs(J,{title:"Leads coletados",className:"flex items-center",children:[t.jsxs("div",{className:"w-[90%] flex flex-col-reverse md:flex-row md:justify-end gap-2 md:gap-8 md:h-[40px] px-4 md:px-0",children:[t.jsx(k,{tip:"Selecione um chat",children:t.jsx(Be,{name:"select_chat",title:"Selecione um chat",options:l||[],optionsDefault:i?Array.of(i):null,onSelected:c,onDelete:d})}),t.jsx(k,{tip:"Selecione uma data  como filtro",children:t.jsx(Ve,{})}),t.jsx(k,{tip:"Atualize seus chats",positionX:"LEFT",children:t.jsx("div",{className:"p-2 bg-light dark:bg-gray border border-primary-100 rounded-md cursor-pointer",children:t.jsx(Fe,{className:"text-nxl"})})})]}),t.jsx("div",{className:"w-[90%]",children:t.jsx(Et,{titleColumn:n,rows:r})})]})}function Rn({category_name:e}){const{client:a}=g.useContext(T),{clearModal:s}=g.useContext(A),n=Q(),r=({currentTarget:o})=>{if(!a){console.error("Unable to select offer because the client is missing");return}s(null,{clearAll:!0}),n(`/${o.dataset.source}/${a.plan_management.id}/${e||null}`)};return t.jsxs("div",{className:"flex flex-col items-center p-4",children:[t.jsx(G,{children:"Escolha o tipo de oferta"}),t.jsx(Y,{className:"opacity-70",children:"Aqui você deve escolher qual o tipo de oferta você está cadastrando"}),t.jsxs("div",{className:"flex w-4/5 justify-between gap-4 my-6",children:[t.jsxs("div",{"data-source":"create-product",className:"flex flex-col justify-center items-center gap-2 max-w-[250px] border border-primary-100 rounded-md cursor-pointer hover:scale-105 transition-transform",onClick:r,children:[t.jsx("img",{src:"https://i.ibb.co/0GHgsZV/Screenshot-from-2024-08-01-17-30-39-removebg-preview-1.png",alt:"Imagem representando um porduto fisico",className:"w-20 h-20 object-contain"}),t.jsx(G,{className:"md:text-base font-bold",children:"Físico"}),t.jsx(Y,{className:"md:text-sm opacity-50",children:"Um produto físico é um objeto tangível que é fabricado e posteriormente entregue ao cliente final para que o possua fisicamente."})]}),t.jsxs("div",{"data-source":"create-service",className:"flex flex-col justify-center items-center gap-2 max-w-[250px] border border-primary-100 rounded-md cursor-pointer hover:scale-105 transition-transform",onClick:r,children:[t.jsx("img",{src:"https://i.ibb.co/TLv6Pzx/Screenshot-from-2024-08-01-17-31-33-removebg-preview-1.png",alt:"Imagem representando um serviço online ou presencial",className:"w-20 h-20 object-contain"}),t.jsx(G,{className:"md:text-base font-bold",children:"Serviço"}),t.jsx(Y,{className:"md:text-sm opacity-50",children:"Um serviço é uma atividade realizada para atender a uma necessidade específica do cliente, sendo consumido no momento da sua prestação."})]})]})]})}function Dn({}){const{setModalContent:e}=g.useContext(A),a=X(),s=({category_name:n})=>{e({componentName:"modal_display_select_offer",components:t.jsx(D,{children:t.jsx(Rn,{category_name:n})})})};return t.jsxs("form",{onSubmit:a.handleSubmit(s),className:"flex flex-col justify-center items-center gap-2 p-4",children:[t.jsx(G,{children:"Crie sua categoria"}),t.jsx(Y,{className:"max-w-[400px] opacity-70 md:text-base",children:"Cadastre a categoria do seu produto, antes de adicionar produtos nela"}),t.jsx("div",{className:"my-4 w-full",children:t.jsx(V,{name:"category_name",title:"De um nome para sua categoria",formContext:a})}),t.jsx(M,{children:"Criar categoria"}),t.jsx(M,{customClass:"bg-transparent underline cursor-pointer opacity-70 mt-4",children:"Meu produto não tem categoria"})]})}function Tt({}){const{setModalContent:e}=g.useContext(A),a=()=>{e({componentName:"modal_show_form",components:t.jsx(D,{children:t.jsx(Dn,{})})})};return t.jsxs(M,{effectNeon:!0,onClick:a,children:[t.jsx(nt,{})," Adicionar categoria"]})}function Bn({}){return t.jsxs("div",{className:"w-3/4 flex flex-col items-center gap-4",children:[t.jsx(G,{children:"Cadastre seus produtos aqui"}),t.jsx(Y,{children:"É muito simples e fácil, basta criar um categoria e logo em seguida adicionar seus produtos"}),t.jsx(Tt,{})]})}function Ln({product:e,setProducts:a}){var c;const{client:s}=g.useContext(T),{setModalContent:n,clearModal:r}=g.useContext(A);if(!s){console.error("client is missing!");return}const o=X({resolver:Oe(Pa),defaultValues:{...e,images:(c=e.images)==null?void 0:c.map(d=>d.id)}}),i=async d=>{if(!e.id){window.location.reload();return}const m=await Fa(e.id,d);if(!m){n({componentName:"modal_failed_update_product",components:t.jsx(j,{componentName:"modal_failed_update_product",message:"Falha ao tentar atualizar o produto, tente entrar em contato com suporte.",type:"WARNING",functionAfterComplete:()=>r(null,{clearAll:!0})})});return}a(p=>p&&[...p.filter(u=>u.id!==e.id),m]),n({componentName:"modal_success_update_product",components:t.jsx(j,{componentName:"modal_success_update_product",message:"Produto atualizado com sucesso!",functionAfterComplete:()=>r(null,{clearAll:!0})})})},l=async()=>{if(!e.id){window.location.reload();return}if(!await rt(e.id)){n({componentName:"modal_failed_delete_product",components:t.jsx(j,{componentName:"modal_failed_delete_product",message:"Falha ao tentar deletar o produto, tente entrar em contato com suporte",type:"WARNING"})});return}a(m=>m.filter(p=>p.id!==e.id)),n({componentName:"modal_success_delete_product",components:t.jsx(j,{componentName:"modal_success_delete_product",message:"Produto deletado com sucesso!",functionAfterComplete:()=>r(null,{clearAll:!0})})})};return t.jsxs(E.EditForm,{form:o,onSubmit:i,onDelete:l,children:[t.jsx(E.EditStep,{titleStep:"Informações basicas",index:0,children:t.jsx(Ra,{client_id:s.id,product:e})}),t.jsx(E.EditStep,{index:1,titleStep:"Métodos de pagamentos e condições",children:t.jsx(Da,{})}),t.jsx(E.EditStep,{index:2,titleStep:"Garantia do produto",children:t.jsx(Ba,{})}),t.jsx(E.EditStep,{index:3,titleStep:"Informações avançadas",children:t.jsx(La,{})})]})}function Fn({items:e}){var f;const{setModalContent:a,clearModal:s}=g.useContext(A),{client:n}=g.useContext(T),r=g.useRef(null),[o,i]=g.useState(e),l=Q(),c=()=>{if(!n){console.error("Unable to select offer because the client is missing");return}l(`/create-product/${n.plan_management.id}/${e[0].category.name}`)},d=async u=>{if(!n){console.error("Client id is missing!");return}const h=await za({...u,product_name:`Copiá (${o.filter(x=>x.product_name.includes("Copiá")).length+1})`,plan_management_id:n==null?void 0:n.plan_management.id,category:{name:u.category.name},images:u.images.map(x=>x.id)});h&&i(x=>x?[...x,h]:[h])},m=async u=>{a({componentName:"modal_confirm_delete_product",components:t.jsx(D,{children:t.jsx(st,{title:"Deseja realmente excluir esse produto?",confirmFunction:()=>h(),cancelFuntion:()=>s("modal_confirm_delete_product")})})});async function h(){const{id:x}=u;if(!x){window.location.reload();return}if(!await rt(x)){a({componentName:"modal_failed_delete_product",components:t.jsx(j,{componentName:"modal_failed_delete_product",message:"Falha ao tentar deletar o produto, tente entrar em contato com suporte",type:"WARNING"})});return}i(_=>_.filter(b=>b.id!==x)),a({componentName:"modal_success_delete_product",components:t.jsx(j,{componentName:"modal_success_delete_product",message:"Produto deletado com sucesso!"})}),s("modal_confirm_delete_product")}},p=u=>{a({componentName:"modal_edit_product",components:t.jsx(D,{children:t.jsx(Ln,{product:u,setProducts:i})})})};return t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{"data-display":!!((f=e[0].category)!=null&&f.name),className:"w-full flex justify-between items-center bg-primary-100 dark:bg-primary-200 px-4",children:t.jsx(G,{className:"font-bold text-light",children:e[0].category.name==="null"?"Sem categoria":e[0].category.name})}),t.jsxs("div",{ref:r,className:"w-full flex gap-4 justify-start flex-wrap items-center bg-primary-50 dark:bg-primary-300 p-4",children:[o.map(u=>{var h;return t.jsxs("div",{className:"group w-20 h-20 flex items-center gap-4 relative hover:scale-105 cursor-pointer transition-transform",children:[t.jsxs("div",{className:"hidden group-hover:flex gap-1 absolute right-0 top-0 bg-dark/80 p-1 ",children:[t.jsx(it,{className:"hover:scale-110 transition-transform fill-white",onClick:()=>d(u)}),t.jsx(lt,{className:"hover:scale-110 transition-transform fill-red-400",onClick:()=>m(u)})]}),t.jsx("img",{src:((h=u==null?void 0:u.image_main)==null?void 0:h.url)||"https://via.placeholder.com/100",className:"w-full h-full object-cover",onClick:()=>p(u)}),t.jsx("div",{className:"w-full absolute bottom-0",children:t.jsx(Y,{className:"w-full bg-dark/80 text-light text-sm overflow-hidden whitespace-nowrap text-ellipsis px-1",children:u.product_name})})]},u.id)}),t.jsx("div",{className:"w-20 h-20 cursor-pointer border border-white rounded-md grid place-content-center opacity-70 hover:opacity-100 bg-primary-100 dark:bg-primary-200",onClick:c,children:t.jsx(De,{className:"size-8 fill-light"})})]})]})}function zn({service:e,setServices:a}){var c;const{client:s}=g.useContext(T),{setModalContent:n,clearModal:r}=g.useContext(A);if(!s){console.error("client is missing!");return}const o=X({resolver:Oe(Oa),defaultValues:{...e,images:(c=e.images)==null?void 0:c.map(d=>d.id)}}),i=async d=>{if(!e.id){window.location.reload();return}const m=await Ga(e.id,d);if(!m){n({componentName:"modal_failed_update_service",components:t.jsx(j,{componentName:"modal_failed_update_service",message:"Falha ao tentar atualizar o serviço, tente entrar em contato com suporte.",type:"WARNING",functionAfterComplete:()=>r(null,{clearAll:!0})})});return}a(p=>p&&[...p.filter(u=>u.id!==e.id),m]),n({componentName:"modal_success_update_service",components:t.jsx(j,{componentName:"modal_success_update_service",message:"Serviço atualizado com sucesso!",functionAfterComplete:()=>r(null,{clearAll:!0})})})},l=async()=>{if(!e.id){window.location.reload();return}if(!await ct(e.id)){n({componentName:"modal_failed_delete_product",components:t.jsx(j,{componentName:"modal_failed_delete_product",message:"Falha ao tentar deletar o produto, tente entrar em contato com suporte",type:"WARNING"})});return}a(m=>m.filter(p=>p.id!==e.id)),n({componentName:"modal_success_delete_product",components:t.jsx(j,{componentName:"modal_success_delete_product",message:"Produto deletado com sucesso!",functionAfterComplete:()=>r(null,{clearAll:!0})})})};return t.jsxs(E.EditForm,{form:o,onSubmit:i,onDelete:l,children:[t.jsx(E.EditStep,{titleStep:"Informações basicas",index:0,children:t.jsx(Ua,{client_id:s.id,service:e})}),t.jsx(E.EditStep,{index:1,titleStep:"Métodos de pagamentos e condições",children:t.jsx(qa,{})}),t.jsx(E.EditStep,{index:2,titleStep:"Informações avançadas",children:t.jsx($a,{})})]})}function On({items:e}){var p;const{setModalContent:a}=g.useContext(A),{client:s}=g.useContext(T),n=g.useRef(null),[r,o]=g.useState(e),i=Q(),l=()=>{if(!s){console.error("Unable to select offer because the client is missing");return}i(`/create-service/${s.plan_management.id}/${e[0].category.name}`)},c=async f=>{if(!s){console.error("Client id is missing!");return}const u=await Ha({...f,service_name:`Copiá (${r.filter(h=>h.service_name.includes("Copiá")).length+1})`,plan_management_id:s==null?void 0:s.plan_management.id,category:{name:f.category.name},images:f.images.map(h=>h.id)});u&&o(h=>h?[...h,u]:[u])},d=async f=>{const{id:u}=f;if(!u){window.location.reload();return}if(!await ct(u)){a({componentName:"modal_failed_delete_product",components:t.jsx(j,{componentName:"modal_failed_delete_product",message:"Falha ao tentar deletar o serviço, tente entrar em contato com suporte",type:"WARNING"})});return}o(x=>x.filter(N=>N.id!==u)),a({componentName:"modal_success_delete_product",components:t.jsx(j,{componentName:"modal_success_delete_product",message:"Serviço deletado com sucesso!"})})},m=f=>{a({componentName:"modal_edit_product",components:t.jsx(D,{children:t.jsx(zn,{service:f,setServices:o})})})};return t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{"data-display":!!((p=e[0].category)!=null&&p.name),className:"w-full flex justify-between items-center bg-primary-100 dark:bg-primary-200 px-4",children:t.jsx(G,{className:"font-bold text-light",children:e[0].category.name==="null"?"Sem categoria":e[0].category.name})}),t.jsxs("div",{ref:n,className:"w-full flex gap-4 justify-start flex-wrap items-center bg-primary-50 dark:bg-primary-300 p-4",children:[r.map(f=>{var u;return t.jsxs("div",{className:"group w-20 h-20 flex items-center gap-4 relative hover:scale-105 cursor-pointer transition-transform",children:[t.jsxs("div",{className:"hidden group-hover:flex gap-1 absolute right-0 top-0 bg-dark/80 p-1 ",children:[t.jsx(it,{className:"hover:scale-110 transition-transform fill-white",onClick:()=>c(f)}),t.jsx(lt,{className:"hover:scale-110 transition-transform fill-red-400",onClick:()=>d(f)})]}),t.jsx("img",{src:((u=f==null?void 0:f.image_main)==null?void 0:u.url)||"https://via.placeholder.com/100",className:"w-full h-full object-cover",onClick:()=>m(f)}),t.jsx("div",{className:"w-full absolute bottom-0",children:t.jsx(k,{tip:f.service_name.substring(0,39),positionY:"BOTTOM",children:t.jsx(Y,{className:"w-full bg-dark/80 text-light text-sm overflow-hidden whitespace-nowrap text-ellipsis px-1",children:f.service_name})})})]},f.id)}),t.jsx("div",{className:"w-20 h-20 cursor-pointer border border-white rounded-md grid place-content-center opacity-70 hover:opacity-100 bg-primary-100 dark:bg-primary-200",onClick:l,children:t.jsx(De,{className:"size-8 fill-light"})})]})]})}function Un({offers:e}){const[a,s]=g.useState(!!e.products.length),n=e.products.reduce((i,l)=>{const c=i.find(d=>{var m;return((m=d[0])==null?void 0:m.category.name)===l.category.name});return c?c.push(l):i.push([l]),i},[]),r=e.services.reduce((i,l)=>{const c=i.find(d=>{var m;return((m=d[0])==null?void 0:m.category.name)===l.category.name});return c?c.push(l):i.push([l]),i},[]),o=({currentTarget:i})=>{i.id==="product"?s(!0):s(!1)};return t.jsxs("div",{className:"w-full space-y-4",children:[t.jsx("div",{className:"w-full flex justify-end",children:t.jsx(Tt,{})}),t.jsxs("div",{children:[t.jsxs("div",{"data-display":!!(n.length&&r.length),className:"w-full flex justify-start data-[display=false]:hidden",children:[t.jsx(G,{id:"product","data-active":a,className:"w-1/2 text-left data-[active=true]:bg-primary-100 dark:data-[active=true]:bg-primary-200 bg-primary-50 dark:bg-primary-300 text-light border border-primary-100 dark:border-primary-200 cursor-pointer p-2",onClick:o,children:"Produto(s)"}),t.jsx(G,{id:"service","data-active":!a,className:"w-1/2 text-left data-[active=true]:bg-primary-100 dark:data-[active=true]:bg-primary-200 bg-primary-50 dark:bg-primary-300 text-light border border-primary-100 dark:border-primary-200 cursor-pointer p-2",onClick:o,children:"Serviço(s)"})]}),t.jsx("div",{"data-display":a,className:"w-full data-[display=false]:hidden",children:n.map(i=>t.jsx(Fn,{items:i},i[0].id))}),t.jsx("div",{"data-display":!a,className:"w-full data-[display=false]:hidden",children:r.map(i=>t.jsx(On,{items:i},i[0].id))})]})]})}async function qn(e){const a=await z.get(`${O}/products/${e}`).catch(n=>console.log(n)),s=await z.get(`${O}/services/${e}`).catch(n=>console.log(n));if(!(a!=null&&a.data)||!(s!=null&&s.data)){console.error("Unable to find the products and services.");return}return{services:s.data,products:a.data}}function $n({}){const{client:e}=g.useContext(T),[a,s]=g.useState({products:[],services:[]});return g.useEffect(()=>{(async()=>{if(!(e!=null&&e.plan_management))return;const n=await qn(e==null?void 0:e.plan_management.id);n&&s(n)})()},[]),t.jsx(J,{title:"Produtos",children:t.jsx("div",{className:"p-4 w-full flex flex-col justify-center items-center gap-4",children:a.products.length||a.services.length?t.jsx(Un,{offers:a}):t.jsx(Bn,{})})})}const Gn=[{tab:"my_chats",element:t.jsx(tn,{})},{tab:"metrics",element:t.jsx(pn,{})},{tab:"artificial_intelligence",element:t.jsx(gn,{})},{tab:"products",element:t.jsx($n,{})},{tab:"records",element:t.jsx(Ze,{})},{tab:"conversations",element:t.jsx(Ze,{})},{tab:"leads",element:t.jsx(Pn,{})},{tab:"payment",element:t.jsx(Tn,{})},{tab:"config",element:t.jsx(kn,{})}];function Hn(){const[e]=H(),a=e.get("tab")||"my_chats",s=()=>{const n=Gn.find(r=>r.tab===a);return n==null?void 0:n.element};return t.jsx("div",{className:"w-full px-2 md:px-8",children:s()})}function Kn(){return t.jsxs("div",{className:"w-full min-h-screen md:w-[90%] flex-grow flex flex-col items-center bg-gradient-to-br from-primary-100 from-[10%] to-light to-[20%] dark:to-dark",children:[t.jsx(es,{}),t.jsx(Hn,{})]})}export{Kn as default};
